let BODY_ID="sys_main",GUIDE_CLASS="guideline",MIN_BIAS=1e-10;const styleSheet=document.createElement("style");styleSheet.setAttribute("type","text/css");let page,projectURL,scriptURL;function isScriptLoaded(t){let e=document.getElementsByTagName("script");for(let i=0;i<e.length;i++)if(e[i].src===t)return!0;return null}function docReady(t){"complete"===document.readyState||"interactive"===document.readyState?t():document.addEventListener("DOMContentLoaded",t)}getUrls(),console.log("projectURL: ",projectURL," , scriptURL: ",scriptURL),Number.isNaN||(Number.isNaN=Number.isNaN||function t(e){return"number"==typeof e&&e!=e}),Number.isInteger||(Number.isInteger=function(t){return+t==+t-+t%1}),Object.constructor.prototype.hasOwnProperty("name")||Object.defineProperty(Object.constructor.prototype,"name",{get:function(){return this.toString().trim().replace(/^\S+\s+(\w+)[\S\s]+$/,"$1")}}),function(t){t.forEach(function(t){!t.hasOwnProperty("remove")&&Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function t(){this.parentNode&&this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype].filter(Boolean));let onLayoutComplete=function(){},onSourcesLoaded=function(){},layoutCode=function(){return null};function RemoteLayoutData(t){this.path=t,this.rect=[],this.consumed=!1}function Page(t){if(this.rootElement=t,this.viewMap=new Map,this.hideRoot(),this.layoutObj=layoutCode(),this.sourcesLoaded=!0,this.subPages=new Map,this.sources=new Map,this.srcPaths=[],this.popups=new Map,this.sidemenus=new Map,this.leftMenus=[],this.rightMenus=[],this.includes=new Map,!t){let e=new Style("html,body",[]);e.addFromOptions({width:"100%",height:"100%",padding:"0",margin:"0"});let i=new Style("*",[]);i.addFromOptions({margin:"0",padding:"0","box-sizing":"border-box","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","overscroll-behavior":"none"});let n=new Style(".abs",[]);n.addStyleElement("position","absolute"),n.addStyleElement("padding","0"),n.addStyleElement("margin","0"),updateOrCreateSelectorInStyleSheet(styleSheet,e),updateOrCreateSelectorInStyleSheet(styleSheet,i),updateOrCreateSelectorInStyleSheet(styleSheet,n);let r=document.body.getAttribute(attrKeys.layout_constraintGuideColor);!r&&this.layoutObj&&this.layoutObj.body&&(r=this.layoutObj.body["data-guide-color"]);let o=new Style("."+GUIDE_CLASS,[]);o.addFromOptions({"background-color":r||"transparent",visibility:r?"visible":"hidden"}),updateOrCreateSelectorInStyleSheet(styleSheet,o)}}function shouldIgnoreNonLayoutNode(t){let e=t.nodeName.toLowerCase();return"meta"===e||"title"===e||"head"==e||"script"==e||"link"==e||"style"==e}function isWhiteSpaceOrCommentNode(t){let e=t.nodeName.toLowerCase();return"#text"===e||"#comment"===e}function isWhiteSpaceCommentStyleOrScriptNode(t){let e=t.nodeName.toLowerCase();return"#text"===e||"#comment"===e||"script"===e||"style"===e}function shouldIgnoreSpecialChildElement(t){let e=t.nodeName.toLowerCase();return"li"===e||"tr"===e||"td"===e||"th"===e||"tbody"===e||"thead"===e||"tfoot"===e||"col"===e||"colgroup"===e||"option"===e||"optgroup"===e||"b"===e||"i"===e||"strong"===e||"u"===e||"caption"===e}function enforceIdOnChildElements(t){let e=null;return!shouldIgnoreSpecialChildElement(t)||(e=t.getAttribute(attrKeys.id))||(e=ULID.ulid(),t.setAttribute(attrKeys.id,e)),e}docReady(function(){(page=new Page(null)).layout()}),Page.prototype.findViewById=function(t){return this.viewMap.get(t)},Page.prototype.layout=function(){this===page&&layoutCode()?this.layoutFromSheet(this.rootElement):this.layoutFromTags(this.rootElement)},Page.prototype.layoutFromSheet=function(t){let e=this,i=t||document.body;if(i===document.body&&(i.id=BODY_ID),t){let n=t.nodeName.toLowerCase();if("script"===n)return;if(!t.id&&!shouldIgnoreSpecialChildElement(t))throw"Please supply the id for node: "+n+", around:\n"+t.outerHTML+". The layout engine needs it."}if(!isWhiteSpaceOrCommentNode(i)){let r=i===document.body?this.layoutObj.body:this.layoutObj.elements[i.id];r?i===document.body&&(r.w="match_parent",r.h="match_parent",r.ss="parent",r.ee="parent",r.tt="parent",r.bb="parent"):(document.body,r={w:"match_parent",h:"match_parent",ss:"parent",ee:"parent",tt:"parent",bb:"parent"});let o=new Map;Object.keys(r).forEach(function(t){let n=r[t];if(o.set(t,n),t===attrKeys.layout_src){e.srcPaths.push(n),e.sourcesLoaded=!1;let s=new RemoteLayoutData(n),l=r[attrKeys.layout_popup],u=r[attrKeys.layout_menuLeft],h=r[attrKeys.layout_menuRight];if(!0===u&&!0===h)throw`Each html element can only take one of ${attrKeys.layout_menuLeft} or ${attrKeys.layout_menuRight} at once...`;!0===u||"true"===u?(e.leftMenus.push(i.id),e.sidemenus.set(i.id,s)):!0===h||"true"===h?(e.rightMenus.push(i.id),e.sidemenus.set(i.id,s)):!0===l||"true"===l?e.popups.set(i.id,s):e.includes.set(i.id,s)}if(t===attrKeys.customType&&"canvas"!==i.nodeName.toLowerCase())throw"Error: the `customType` attribute can only be defined on canvas elements"});let s,l=r[attrKeys.layout_constraintGuide];if(l){if("true"===l||!0===l)o.set(attrKeys.layout_width,sizes.WRAP_CONTENT),o.set(attrKeys.layout_height,sizes.WRAP_CONTENT),s=new Guideline(this,i,o,i.parentNode.id);else throw"Invalid value for guide"}else enforceIdOnChildElements(i),s=i===document.body?new View(this,i,o,void 0):new View(this,i,o,i.parentNode.id);if(i.hasChildNodes()){let u=i.children;for(let h=0;h<u.length;h++){let c=u[h];if(!isWhiteSpaceCommentStyleOrScriptNode(c)){if(!shouldIgnoreSpecialChildElement(c)){let p=c.getAttribute(attrKeys.id);s.childrenIds.push(p)}this.layoutFromSheet(c)}}}s&&!0===s.topLevel&&((this.buildUI(s),this.showRoot(),e.srcPaths.length>0)?BuildBridgedWorker(workerCode,["loadAll"],["layoutLoaded","layoutError"],[layoutLoaded,layoutError]).loadAll(projectURL,e.srcPaths):(e.sourcesLoaded=!0,onLayoutComplete()))}},Page.prototype.layoutFromTags=function(t){let e=this,i=t||document.body;if(i===document.body&&(i.id=BODY_ID),t){let n=t.nodeName.toLowerCase();if("script"===n)return;if(!t.id&&!shouldIgnoreSpecialChildElement(t))throw"Please supply the id for node: "+n+", around:\n"+t.outerHTML+". The layout engine needs it."}if(!isWhiteSpaceOrCommentNode(i)){let r=i.getAttribute(attrKeys.layout_constraint);i.removeAttribute(attrKeys.layout_constraint),r||(document.body,r="w:match_parent;h:match_parent;ss:parent;ee:parent;tt:parent;bb:parent"),endsWith(r=r.trim(),";")&&(r=r.substring(0,r.length-1)),r=(r=(r=r.replace(/\s*?(;)\s*/g,";")).replace(/\s*?(:)\s*/g,":")).split(";");let o=new Map,s=!1,l=!1,u=!1,h=null;for(let c=0;c<r.length;c++){let p=r[c],d;if(-1!==(d=p.indexOf(":"))){let f=p.substring(0,d),g=p.substring(d+1);switch(o.set(f,g),f===attrKeys.layout_src&&(e.srcPaths.push(g),e.sourcesLoaded=!1,h=g),f){case attrKeys.layout_popup:s=!0===g||"true"===g;break;case attrKeys.layout_menuLeft:l=!0===g||"true"===g;break;case attrKeys.layout_menuRight:u=!0===g||"true"===g}if(l&&u)throw`Each html element can only take one of ${attrKeys.layout_menuLeft} or ${attrKeys.layout_menuRight} at once...`;if(f===attrKeys.customType&&"canvas"!==i.nodeName.toLowerCase())throw"Error: the `customType` attribute can only be defined on canvas elements"}else throw"invalid constraint definition... no colon found in "+p+" on "+i.id}if(h){let m=new RemoteLayoutData(h);!0===s?e.popups.set(i.id,m):!0===l?(e.leftMenus.push(i.id),e.sidemenus.set(i.id,m)):!0===u?(e.rightMenus.push(i.id),e.sidemenus.set(i.id,m)):e.includes.set(i.id,m)}let $,v=i.getAttribute(attrKeys.layout_constraintGuide);if(v){if("true"===v)o.set(attrKeys.layout_width,sizes.WRAP_CONTENT),o.set(attrKeys.layout_height,sizes.WRAP_CONTENT),$=new Guideline(this,i,o,i.parentNode.id);else throw"Invalid value for data-guide"}else enforceIdOnChildElements(i),$=i===document.body?new View(this,i,o,void 0):new View(this,i,o,i.parentNode.id);if(i.hasChildNodes()){let _=i.children;for(let E=0;E<_.length;E++){let A=_[E];if(!isWhiteSpaceCommentStyleOrScriptNode(A)){if(!shouldIgnoreSpecialChildElement(A)){let T=A.getAttribute(attrKeys.id);$.childrenIds.push(T)}this.layoutFromTags(A)}}}$&&!0===$.topLevel&&((this.buildUI($),this.showRoot(),e.srcPaths.length>0)?BuildBridgedWorker(workerCode,["loadAll"],["layoutLoaded","layoutError"],[layoutLoaded,layoutError]).loadAll(projectURL,e.srcPaths):(e.sourcesLoaded=!0,onLayoutComplete()))}},Page.prototype.buildUI=function(t){let e=[],i=[],n=[],r=function(t,o){t.childrenIds.length>0&&(autoLayout(t.htmlNode===document.body?void 0:t.htmlNode,t.layoutChildren(o)),t.childrenIds.forEach(function(t){let s=o.viewMap.get(t);s.isPopup()&&i.push(s),s.isSideMenu()&&n.push(s),s.hasBgImage&&e.push(s),s.childrenIds.length>0&&r(s,o)}))};r(t,this),e.forEach(function(t){t.makeBgImage()});let o=this;i.forEach(function(t){let e=o.popups.get(t.id);e.rect=t.htmlNode.getBoundingClientRect(),o.popups.set(t.id,e),t.htmlNode.remove()}),n.forEach(function(t){let e=o.sidemenus.get(t.id);e.rect=t.htmlNode.getBoundingClientRect(),o.sidemenus.set(t.id,e),t.htmlNode.remove()})},Page.prototype.showRoot=function(){this.rootElement&&this.rootElement!==document.body?this.rootElement.style.visibility="visible":document.body.style.visibility="visible"},Page.prototype.hideRoot=function(){this.rootElement&&this.rootElement!==document.body?this.rootElement.style.visibility="hidden":document.body.style.visibility="hidden"},Page.prototype.openSideMenu=function(t,e,i,n){if(4!==arguments.length)throw"`Page.openSideMenu` function requires 4 arguments";if("string"!=typeof t)throw"`menuId` must be a string";if("boolean"!=typeof e)throw"`closeOnClickOutSide` must be  a boolean";if("function"!=typeof i)throw"onOpen must be a function";if("function"!=typeof n)throw"onClose must be a function";let r=this.sidemenus.get(t),o=-1!==this.leftMenus.indexOf(t),s=-1!==this.rightMenus.indexOf(t),l=o?SideMenuTypes.LEFT:s?SideMenuTypes.RIGHT:null;if(!l)throw"Invalid menutype found";let u=this.sources.get(r.path),h=r.rect;if(!h||!h.width||!h.height)throw"specify width or height on popup: "+popupId;return new SideMenuX({id:t,layout:u,width:h.width,onOpen:i,onClose:n,menuType:l,closeOnClickOutside:"boolean"==typeof e&&e,bg:"#fff"}).open()},Page.prototype.initSideMenu=function(t,e,i,n){if(4!==arguments.length)throw"`Page.openSideMenu` function requires 4 arguments";if("string"!=typeof t)throw"`menuId` must be a string";if("boolean"!=typeof e)throw"`closeOnClickOutSide` must be  a boolean";if("function"!=typeof i)throw"onOpen must be a function";if("function"!=typeof n)throw"onClose must be a function";let r=this.sidemenus.get(t),o=-1!==this.leftMenus.indexOf(t),s=-1!==this.rightMenus.indexOf(t),l=o?SideMenuTypes.LEFT:s?SideMenuTypes.RIGHT:null;if(!l)throw"Invalid menutype found";let u=this.sources.get(r.path),h=r.rect;if(!h||!h.width||!h.height)throw"specify width or height on popup: "+popupId;return new SideMenuX({id:t,layout:u,width:h.width,onOpen:i,onClose:n,menuType:l,closeOnClickOutside:"boolean"==typeof e&&e,bg:"#fff"}).build()},Page.prototype.openPopup=function(t,e,i,n){if(4!==arguments.length)throw"`Page.openPopup` function requires 4 arguments";if("string"!=typeof t)throw"`popupId` must be a string";if("boolean"!=typeof e)throw"`closeOnClickOutSide` must be  a boolean";if("function"!=typeof i)throw"onOpen must be a function";if("function"!=typeof n)throw"onClose must be a function";let r=this.popups.get(t),o=this.sources.get(r.path),s=r.rect;if(!s||!s.width||!s.height)throw"specify width or height on popup: "+t;return new Popup({id:t,layout:o,width:s.width,height:s.height,closeOnClickOutside:"boolean"==typeof e&&e,bg:"#fff",onOpen:i,onClose:n}).open()},Page.prototype.closePopup=function(t){t.hide()},Page.prototype.renderInclude=function(t,e){let i=this.includes.get(t).path,n=e||this.sources.get(i),r=document.getElementById(t);r.innerHTML=n;let o=new Page(r);o.layout(),this.subPages.set(t,o)};var workerCode=function(){var t,e,i;function n(t,e){!function t(e,i,n){if(Array.isArray(i)){if(n<i.length){var r=i[n];!function t(e,i,n){let r=new URL(i,e);fetch(r,{credentials:"same-origin"}).then(function(t){return t}).then(function(t){return t.text()}).then(function(t){n(t)}).catch(function(t){setTimeout(function(){throw main.layoutError(t),t})})}(e,r,function(o){main.layoutLoaded(r,o,!1),t(e,i,n+1)})}else main.layoutLoaded(null,"",!0)}else main.layoutError(Error("Pass an array of filepaths here"))}(t,e,0)}t=function(){"use strict";function t(t){var e=this.constructor;return this.then(function(i){return e.resolve(t()).then(function(){return i})},function(i){return e.resolve(t()).then(function(){return e.reject(i)})})}function e(t){return new this(function(e,i){function n(t,i){if(i&&("object"==typeof i||"function"==typeof i)){var s=i.then;if("function"==typeof s)return void s.call(i,function(e){n(t,e)},function(i){r[t]={status:"rejected",reason:i},0==--o&&e(r)})}r[t]={status:"fulfilled",value:i},0==--o&&e(r)}if(!t||void 0===t.length)return i(TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);for(var o=r.length,s=0;r.length>s;s++)n(s,r[s])})}function i(t){return!(!t||void 0===t.length)}function n(){}function r(t){if(!(this instanceof r))throw TypeError("Promises must be constructed via new");if("function"!=typeof t)throw TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(t,this)}function o(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var i,n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){try{i=n(t._value)}catch(r){return void l(e.promise,r)}s(e.promise,i)}else(1===t._state?s:l)(e.promise,t._value)})):t._deferreds.push(e)}function s(t,e){try{if(e===t)throw TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i,n,o=e.then;if(e instanceof r)return t._state=3,t._value=e,void u(t);if("function"==typeof o)return void h((i=o,n=e,function(){i.apply(n,arguments)}),t)}t._state=1,t._value=e,u(t)}catch(s){l(t,s)}}function l(t,e){t._state=2,t._value=e,u(t)}function u(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,i=t._deferreds.length;i>e;e++)o(t,t._deferreds[e]);t._deferreds=null}function h(t,e){var i=!1;try{t(function(t){i||(i=!0,s(e,t))},function(t){i||(i=!0,l(e,t))})}catch(n){if(i)return;i=!0,l(e,n)}}var c=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var i=new this.constructor(n);return o(this,new function(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}(t,e,i)),i},r.prototype.finally=t,r.all=function(t){return new r(function(e,n){function r(t,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var l=i.then;if("function"==typeof l)return void l.call(i,function(e){r(t,e)},n)}o[t]=i,0==--s&&e(o)}catch(u){n(u)}}if(!i(t))return n(TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(t);if(0===o.length)return e([]);for(var s=o.length,l=0;o.length>l;l++)r(l,o[l])})},r.allSettled=e,r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,i){i(t)})},r.race=function(t){return new r(function(e,n){if(!i(t))return n(TypeError("Promise.race accepts an array"));for(var o=0,s=t.length;s>o;o++)r.resolve(t[o]).then(e,n)})},r._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){c(t,0)},r._unhandledRejectionFn=function(t){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var p=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"function"!=typeof p.Promise?p.Promise=r:(p.Promise.prototype.finally||(p.Promise.prototype.finally=t),p.Promise.allSettled||(p.Promise.allSettled=e))},"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t(),e=this,i=function(t){"use strict";var e="undefined"!=typeof self&&self||void 0!==e&&e,i={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(i.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(t){return t&&n.indexOf(Object.prototype.toString.call(t))>-1};function o(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw TypeError("Invalid character in header field name");return t.toLowerCase()}function s(t){return"string"!=typeof t&&(t=String(t)),t}function l(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return i.iterable&&(e[Symbol.iterator]=function(){return e}),e}function u(t){this.map={},t instanceof u?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function h(t){if(t.bodyUsed)return Promise.reject(TypeError("Already read"));t.bodyUsed=!0}function c(t){return new Promise(function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}})}function p(t){var e=new FileReader,i=c(e);return e.readAsArrayBuffer(t),i}function d(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(t){if(this.bodyUsed=this.bodyUsed,this._bodyInit=t,t){if("string"==typeof t)this._bodyText=t;else if(i.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(i.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else{var e;i.arrayBuffer&&i.blob&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=d(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||r(t))?this._bodyArrayBuffer=d(t):this._bodyText=t=Object.prototype.toString.call(t)}}else this._bodyText="";!this.headers.get("content-type")&&("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(!this._bodyFormData)return Promise.resolve(new Blob([this._bodyText]));throw Error("could not read FormData body as blob")},this.arrayBuffer=function(){if(!this._bodyArrayBuffer)return this.blob().then(p);var t=h(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}),this.text=function(){var t,e,i,n=h(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,i=c(e),e.readAsText(t),i;if(this._bodyArrayBuffer)return Promise.resolve(function t(e){for(var i=new Uint8Array(e),n=Array(i.length),r=0;r<i.length;r++)n[r]=String.fromCharCode(i[r]);return n.join("")}(this._bodyArrayBuffer));if(!this._bodyFormData)return Promise.resolve(this._bodyText);throw Error("could not read FormData body as text")},i.formData&&(this.formData=function(){return this.text().then($)}),this.json=function(){return this.text().then(JSON.parse)},this}u.prototype.append=function(t,e){t=o(t),e=s(e);var i=this.map[t];this.map[t]=i?i+", "+e:e},u.prototype.delete=function(t){delete this.map[o(t)]},u.prototype.get=function(t){return t=o(t),this.has(t)?this.map[t]:null},u.prototype.has=function(t){return this.map.hasOwnProperty(o(t))},u.prototype.set=function(t,e){this.map[o(t)]=s(e)},u.prototype.forEach=function(t,e){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(e,this.map[i],i,this)},u.prototype.keys=function(){var t=[];return this.forEach(function(e,i){t.push(i)}),l(t)},u.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),l(t)},u.prototype.entries=function(){var t=[];return this.forEach(function(e,i){t.push([i,e])}),l(t)},i.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(t,e){if(!(this instanceof m))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var i,n,r=(e=e||{}).body;if(t instanceof m){if(t.bodyUsed)throw TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new u(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new u(e.headers)),this.method=(n=(i=e.method||this.method||"GET").toUpperCase(),g.indexOf(n)>-1?n:i),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),("GET"===this.method||"HEAD"===this.method)&&("no-store"===e.cache||"no-cache"===e.cache)){var o=/([?&])_=[^&]*/;o.test(this.url)?this.url=this.url.replace(o,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function $(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var i=t.split("="),n=i.shift().replace(/\+/g," "),r=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(r))}}),e}function v(t,e){if(!(this instanceof v))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"",this.headers=new u(e.headers),this.url=e.url||"",this._initBody(t)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},f.call(m.prototype),f.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},v.error=function(){var t=new v(null,{status:0,statusText:""});return t.type="error",t};var _=[301,302,303,307,308];v.redirect=function(t,e){if(-1===_.indexOf(e))throw RangeError("Invalid status code");return new v(null,{status:e,headers:{location:t}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(E){t.DOMException=function(t,e){this.message=t,this.name=e;var i=Error(t);this.stack=i.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function A(n,r){return new Promise(function(o,l){var h=new m(n,r);if(h.signal&&h.signal.aborted)return l(new t.DOMException("Aborted","AbortError"));var c=new XMLHttpRequest;function p(){c.abort()}c.onload=function(){var t,e,i={status:c.status,statusText:c.statusText,headers:(t=c.getAllResponseHeaders()||"",e=new u,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var i=t.split(":"),n=i.shift().trim();if(n){var r=i.join(":").trim();e.append(n,r)}}),e)};i.url="responseURL"in c?c.responseURL:i.headers.get("X-Request-URL");var n="response"in c?c.response:c.responseText;setTimeout(function(){o(new v(n,i))},0)},c.onerror=function(){setTimeout(function(){l(TypeError("Network request failed"))},0)},c.ontimeout=function(){setTimeout(function(){l(TypeError("Network request failed"))},0)},c.onabort=function(){setTimeout(function(){l(new t.DOMException("Aborted","AbortError"))},0)},c.open(h.method,function t(i){try{return""===i&&e.location.href?e.location.href:i}catch(n){return i}}(h.url),!0),"include"===h.credentials?c.withCredentials=!0:"omit"===h.credentials&&(c.withCredentials=!1),"responseType"in c&&(i.blob?c.responseType="blob":i.arrayBuffer&&h.headers.get("Content-Type")&&-1!==h.headers.get("Content-Type").indexOf("application/octet-stream")&&(c.responseType="arraybuffer")),!r||"object"!=typeof r.headers||r.headers instanceof u?h.headers.forEach(function(t,e){c.setRequestHeader(e,t)}):Object.getOwnPropertyNames(r.headers).forEach(function(t){c.setRequestHeader(t,s(r.headers[t]))}),h.signal&&(h.signal.addEventListener("abort",p),c.onreadystatechange=function(){4===c.readyState&&h.signal.removeEventListener("abort",p)}),c.send(void 0===h._bodyInit?null:h._bodyInit)})}A.polyfill=!0,e.fetch||(e.fetch=A,e.Headers=u,e.Request=m,e.Response=v),t.Headers=u,t.Request=m,t.Response=v,t.fetch=A,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(e.WHATWGFetch={})},layoutLoaded=function(t,e,i){page.sources.set(t,e),i&&(page.sourcesLoaded=i,onSourcesLoaded()),page.includes.forEach(function(i,n){!1===i.consumed&&i.path===t&&(page.renderInclude(n,e),i.consumed=!0)}),i&&onLayoutComplete()},layoutError=function(t){throw t};function layoutRootOnBindingElement(t,e){if("string"!=typeof t&&t)throw"Invalid bindingElemId...bindingElemId: "+t;if("string"!=typeof e||0===e.length)throw"Invalid rootChildId";return[{view1:e,attr1:"centerX",relation:"equ",view2:t,attr2:"centerX",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED},{view1:e,attr1:"centerY",relation:"equ",view2:t,attr2:"centerY",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED},{view1:e,attr1:"width",relation:"equ",view2:t,attr2:"width",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED},{view1:e,attr1:"height",relation:"equ",view2:t,attr2:"height",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED}]}function autoLayout(t,e){let i=e&&isOneDimArray(e)&&e.length>0&&"string"==typeof e[0],n=e&&isOneDimArray(e)&&(e.length>0&&"object"==typeof e[0]||0===e.length),r=window.AutoLayout,o=new r.View;if(!0===i)o.addConstraints(r.VisualFormat.parse(e,{extended:!0}));else if(n)o.addConstraints(e);else throw"Invalid parameters passed to autoLayout! no layout constraints specified";let s={};for(let l in o.subViews){let u=document.getElementById(l);u&&(addClass(u,"abs"),s[l]=u)}var h=function(){if(t){let e=t.scrollWidth>t.clientWidth,i=t.scrollHeight>t.clientHeight?window.innerWidth-getScrollBarWidth():window.innerWidth,n=e?window.innerHeight-getScrollBarWidth():window.innerHeight;o.setSize(t?t.clientWidth:i,t?t.clientHeight:n-1)}else o.setSize(t?t.clientWidth:window.innerWidth,t?t.clientHeight:window.innerHeight-1);for(let r in o.subViews){var l=o.subViews[r];let u=s[r];u&&setAbsoluteSizeAndPosition(u,l.left,l.top,l.width,l.height)}};if(window.addEventListener("resize",h),!t){let c=document.body.children;for(let p=0;p<c.length;p++){let d=c[p];new ResizeSensor(d,function(){d&&(d.scrollHeight>d.clientHeight||d.scrollWidth>d.clientWidth)&&h()})}}return h(),h}let transformAttr="transform"in document.documentElement.style?"transform":void 0;function setAbsoluteSizeAndPosition(t,e,i,n,r){t.setAttribute("style","width: "+n+"px; height: "+r+"px; "+transformAttr+": translate3d("+e+"px, "+i+"px, 0px);")}function View(t,e,i,n){let r=e.id;if(null==r||""===r)throw"Please specify the view id properly";if(void 0!==t.findViewById(r))throw"A view with this id(`"+r+"`) exists already";if(this.htmlNode=e,this.topLevel=0===t.viewMap.size||!n,this.id=r,this.parentId=n,this.childrenIds=[],this.hasBgImage=!!i.get(attrKeys.mi_useAutoBg),i&&i.size>0){let o=i.get(attrKeys.layout_margin),s=i.get(attrKeys.layout_marginHorizontal),l=i.get(attrKeys.layout_marginVertical);if(this.margins={top:i.get(attrKeys.layout_marginTop),bottom:i.get(attrKeys.layout_marginBottom),start:i.get(attrKeys.layout_marginStart),end:i.get(attrKeys.layout_marginEnd),horUnitsSame:!0,verUnitsSame:!0,horMarginDiff:function(){let t=parseNumberAndUnitsNoValidation(this.start,!0),e=parseNumberAndUnitsNoValidation(this.end,!0);if(!this.horUnitsSame)throw"start and end margins must be same when using `cx, scx, cxs` etc.";return parseFloat(t.number)-parseFloat(e.number)+t.units},verMarginDiff:function(){let t=parseNumberAndUnitsNoValidation(this.top,!0),e=parseNumberAndUnitsNoValidation(this.bottom,!0);if(!this.verUnitsSame)throw"top and bottom margins must be same when using `cy, tcy, cyt` etc.";return parseFloat(t.number)-parseFloat(e.number)+t.units}},l){if(isNumber(parseInt(l)))this.margins.top=l,this.margins.bottom=l;else throw Error("Invalid value specified for the vertical margin on "+this.constructor.name+"("+this.id+")")}if(s){if(isNumber(parseInt(s)))this.margins.start=s,this.margins.end=s;else throw Error("Invalid value specified for the horizontal margin on "+this.constructor.name+"("+this.id+")")}if(o){if(isNumber(parseInt(o)))this.margins.top=o,this.margins.bottom=o,this.margins.start=o,this.margins.end=o;else throw Error("Invalid value specified for the margins on "+this.constructor.name+"("+this.id+")")}this.margins.top&&startsWith(this.margins.top,"+")&&(this.margins.top=this.margins.top.substr(1)),this.margins.bottom&&startsWith(this.margins.bottom,"+")&&(this.margins.bottom=this.margins.bottom.substr(1)),this.margins.start&&startsWith(this.margins.start,"+")&&(this.margins.start=this.margins.start.substr(1)),this.margins.end&&startsWith(this.margins.end,"+")&&(this.margins.end=this.margins.end.substr(1)),this.margins.start&&"0"!==this.margins.start||(this.margins.start=0),this.margins.end&&"0"!==this.margins.end||(this.margins.end=0),this.margins.top&&"0"!==this.margins.top||(this.margins.top=0),this.margins.bottom&&"0"!==this.margins.bottom||(this.margins.bottom=0);enforceSameUnitsOnMargins:{let u=parseNumberAndUnitsNoValidation(this.margins.start,!0),h=parseNumberAndUnitsNoValidation(this.margins.end,!0),c=parseNumberAndUnitsNoValidation(this.margins.top,!0),p=parseNumberAndUnitsNoValidation(this.margins.bottom,!0),d=i.get(attrKeys.layout_marginStart),f=i.get(attrKeys.layout_marginEnd),g=i.get(attrKeys.layout_marginTop),m=i.get(attrKeys.layout_marginBottom);d&&f&&u.units!==h.units&&0!==parseInt(u.number)&&0!==parseInt(h.number)&&(this.margins.horUnitsSame=!1),g&&m&&c.units!==p.units&&0!==parseInt(c.number)&&0!==parseInt(p.number)&&(this.margins.verUnitsSame=!1),d&&!f&&(this.margins.end="0"+u.units),f&&!d&&(this.margins.start="0"+h.units),g&&!m&&(this.margins.bottom="0"+c.units),m&&!g&&(this.margins.top="0"+p.units)}this.width=i.get(attrKeys.layout_width),this.height=i.get(attrKeys.layout_height),this.width===sizes.MATCH_PARENT&&(this.width="100%"),this.height===sizes.MATCH_PARENT&&(this.height="100%");changePxToUnitLess:endsWith(this.width,"px")&&(this.width=parseFloat(this.width)),endsWith(this.height,"px")&&(this.height=parseFloat(this.height));this.dimRatio=-1,this.wrapWidth=-1,this.wrapHeight=-1;let $=Error();if(void 0===this.width||null===this.width||""===this.width)throw $.name="UnspecifiedWidthError",$.message="Please specify the width for '"+this.id+"'",$;if(void 0===this.height||null===this.height||""===this.height)throw $.name="UnspecifiedHeightError",$.message="Please specify the height for '"+this.id+"'",$;let v=this;i.forEach(function(t,e,n){switch(e){case attrKeys.layout:i.set(attrKeys.layout,t);break;case attrKeys.layout_width:isNaN(parseInt(e))&&i.set(attrKeys.layout_width,t);break;case attrKeys.layout_height:isNaN(parseInt(e))&&i.set(attrKeys.layout_height,t);break;case attrKeys.layout_maxWidth:isNaN(parseInt(e))&&i.set(attrKeys.layout_maxWidth,t);break;case attrKeys.layout_maxHeight:isNaN(parseInt(e))&&i.set(attrKeys.layout_maxHeight,t);break;case attrKeys.layout_minWidth:isNaN(parseInt(e))&&i.set(attrKeys.layout_minWidth,t);break;case attrKeys.layout_minHeight:isNaN(parseInt(e))&&i.set(attrKeys.layout_minHeight,t);break;case attrKeys.dimension_ratio:if(isNumber(t))this.dimRatio=parseFloat(t),i.set(attrKeys.dimension_ratio,v.dimRatio);else if(!0===isDimensionRatio(t)){let r=t.split(":"),o=parseFloat(r[0]),s=parseFloat(r[1]);if(o<=0)throw Error("Bad ratio specified! LHS can neither be 0 nor less than 0");if(s<=0)throw Error("Bad ratio specified! RHS can neither be 0 nor less than 0");v.dimRatio=o/s,i.set(attrKeys.dimension_ratio,v.dimRatio)}else throw Error("Invalid dimension ratio specified on view with id: "+v.id)}})}if(this.refIds=i,!this.id)throw"Your view must have an id!";if("string"!=typeof this.id)throw"The view id must be a string!";if(0===this.id.trim().length)throw"The view id cannot be an empty string!";customRenderer(t,this);let _=e.getBoundingClientRect();this.width===sizes.WRAP_CONTENT&&(this.width=this.wrapWidth=_.width),this.height===sizes.WRAP_CONTENT&&(this.height=this.wrapHeight=_.height),t.viewMap.set(this.id,this)}function customRenderer(t,e){"Page"===t.constructor.name&&"View"===e.constructor.name&&"canvas"===e.htmlNode.nodeName.toLowerCase()&&e.refIds.get(attrKeys.customType)===attrKeys.customTypeLabel&&renderTextBox(t,e)}function renderTextBox(t,e){if("canvas"===e.htmlNode.nodeName.toLowerCase()&&e.refIds.get(attrKeys.customType)===attrKeys.customTypeLabel){let i=e.refIds.get(attrKeys.layout_width),n=parseNumberAndUnits(i,!0),r=e.refIds.get(attrKeys.mi_text);r||(r=(r=e.htmlNode.textContent).trim()),r||(r="LABEL");let o=e.refIds.get(attrKeys.mi_singleLine);if(null==o)o=!1;else if("true"===o||"false"===o)o="true"===o;else if(!0===o||!1===o);else throw"Invalid type specified for singleLine on view: "+e.id;i=n.number;let s=e.refIds.get(attrKeys.mi_gravity);s||(s=Gravity.LEFT);let l=e.refIds.get(attrKeys.mi_fontName);l||(l="Arial");let u=e.refIds.get(attrKeys.mi_fontSize);u||(u="13px");let h=e.refIds.get(attrKeys.mi_fontStyle);h||(h=FontStyle.REGULAR);let c=e.refIds.get(attrKeys.mi_fontWeight);c||(c=FontStyle.REGULAR),h=c+" "+h;let p=e.refIds.get(attrKeys.mi_border_radius);p||(p="2px");let d=parseNumberAndUnits(u,!0),f=parseNumberAndUnits(p,!0),g=e.refIds.get(attrKeys.mi_fg);g||(g="#000");let m=e.refIds.get(attrKeys.mi_bg);m||(m="white");let $=e.refIds.get(attrKeys.mi_padding);$||($="4px");let v=e.refIds.get(attrKeys.mi_line_spacing);v||(v=8);let _=new TextBox({width:i,text:r,gravity:s,fontName:l,singleLine:o,fontSize:d.number,sizeUnits:d.units,fontStyle:h,backgroundColor:m,textColor:g,borderRadius:f.number,padding:$,lineSpacing:v},e.htmlNode);e.refIds.set(attrKeys.layout_width,_.width+"px"),e.refIds.set(attrKeys.layout_height,_.height+"px"),e.width=_.width,e.height=_.height}}function isDimensionRatio(t){if(!isNaN(t))return t+=":1",!0;let e=0;for(let i=0;i<t.length;i++)if(":"===t.substring(i,i+1)&&++e>1)return!1;if(0===e||e>1)return!1;let n=t.split(":");return 2===n.length&&!isNaN(n[0])&&!isNaN(n[1])}function quickScan(t,e){let i=t+"";i=(i=i.replace(".width","%width")).replace(".height","%height");let n=new Scanner(i,!0,["*","+","%","-"]).scan();if(e&&!0===e)return n;let r=n.indexOf("%");return -1!==r&&(n[r]="."),n}function isHTMLTagName(t){if("string"==typeof t){let e="a b u i body head header h1 h2 h3 h4 h5 h6 style title div p span button checkbox radio input label textarea select legend ul ol li link table tbody thead tfoot tr td th option optgroup video meta img hr picture pre script section small strong noscript object canvas caption blockquote article audio time var cite code iframe nav noframes menu br".split(" ");return e.indexOf(t.trim().toLowerCase())>-1}return!1}function getSignedValue(t){if(void 0===t)return"+0.0";if("string"==typeof t){let e=parseInt(t);return isNaN(e)?"+0.0":e>=0?"+"+e:""+e}if("number"==typeof t)return t>0?"+"+t:"-"+t}function Guideline(t,e,i,n){View.call(this,t,e,i,n);let r=i.get(attrKeys.layout_width),o=i.get(attrKeys.layout_height);r!==sizes.WRAP_CONTENT&&this.refIds.set(attrKeys.layout_width,sizes.WRAP_CONTENT),o!==sizes.WRAP_CONTENT&&this.refIds.set(attrKeys.layout_height,sizes.WRAP_CONTENT),addClass(e,GUIDE_CLASS)}function IncludedView(t,e,i,n){View.call(this,t,e,i,n);let r=e.getAttribute(attrKeys.layout);if(!r||"string"!=typeof r)throw"An included layout must be the name of a valid xml file in the `"+PATH_TO_LAYOUTS_FOLDER+"` folder";let o=r.length;".xml"!==r.substring(o-4)&&(r+=".xml"),new Parser(t,r,this.id)}function is2DArray(t){if("[object Array]"===Object.prototype.toString.call(t)){for(let e=0;e<t.length;e++)if("[object Array]"!==Object.prototype.toString.call(t[e]))return!1;return!0}return!1}function attributeNotEmpty(t){return!!t&&!!(t.trim().length>0)}function attributeEmpty(t){return!t||0===t.trim().length}function Scanner(t,e,i){this.input=t,this.includeTokensInOutput=e,this.tokens=i}function StringBuffer(t){this.dataArray=Array(t)}transformAttr=(transformAttr=(transformAttr=(transformAttr=transformAttr||("-webkit-transform"in document.documentElement.style?"-webkit-transform":"undefined"))||("-moz-transform"in document.documentElement.style?"-moz-transform":"undefined"))||("-ms-transform"in document.documentElement.style?"-ms-transform":"undefined"))||("-o-transform"in document.documentElement.style?"-o-transform":"undefined"),View.prototype.isPopup=function(){let t=this.refIds.get(attrKeys.layout_popup);return void 0!==t&&(!0===t||"true"===t)},View.prototype.isLeftSideMenu=function(){let t=this.refIds.get(attrKeys.layout_menuLeft);return void 0!==t&&(!0===t||"true"===t)},View.prototype.isRightSideMenu=function(){let t=this.refIds.get(attrKeys.layout_menuRight);return void 0!==t&&(!0===t||"true"===t)},View.prototype.isSideMenu=function(){return this.isLeftSideMenu()||this.isRightSideMenu()},View.prototype.makeBgImage=function(){let t=this.refIds,e=t.get(attrKeys.mi_useAutoBg);if(!e||"false"===e)return;let i=t.get(attrKeys.mi_fg),n=t.get(attrKeys.mi_bg),r=t.get(attrKeys.mi_strokeWidth),o=t.get(attrKeys.mi_minSize),s=t.get(attrKeys.mi_textArray),l=t.get(attrKeys.mi_fontName),u=t.get(attrKeys.mi_fontWeight),h=t.get(attrKeys.mi_fontStyle),c=t.get(attrKeys.mi_fontSize),p=t.get(attrKeys.mi_numShapes),d=t.get(attrKeys.mi_shapesDensity),f=t.get(attrKeys.mi_opacity),g=t.get(attrKeys.mi_cacheAfterDraw),m=t.get(attrKeys.mi_opaqueBg),$=t.get(attrKeys.mi_mode),v=t.get(attrKeys.mi_textOnly),_=null;if(h?(_=h,u&&(_+=" "+u)):u&&(_=u),s&&"string"==typeof s)try{s=JSON.parse(s)}catch(E){throw E}g=!0===g||"true"===g,v=!0===v||"true"===v,m=!0===m||"true"===m;let A=this.htmlNode.getBoundingClientRect(),T={width:A.width,height:A.height,fontName:l,fontSize:c,fontStyle:_,fgColor:i,bgColor:n,mode:$,numShapes:p,shapesDensity:d,strokeWidth:r,minSize:o,opacity:f,bgOpacityEnabled:m,textArray:s,textOnly:v,cacheAfterDraw:g};T.width=A.width,T.height=A.height;let S=new MysteryImage(T);S.draw();let C=new Style("#"+this.id,[]);C.addFromOptions({"background-image":"url('"+S.getImage()+"')","background-position":"0% 0%"}),updateOrCreateSelectorInStyleSheet(styleSheet,C),S.cleanup()},View.prototype.getValueAndPriority=function(t){if(void 0===t)return t;if(isNumber(t))return{id:t+"",defaultUsed:!0,priority:AutoLayout.Priority.REQUIRED};let e=t.indexOf("@");if(-1===e)return{id:t,defaultUsed:!0,priority:AutoLayout.Priority.REQUIRED};if(0===e)throw"Bad value for id";return{id:t.substring(0,e),defaultUsed:!1,priority:parseInt(t.substring(e+1))}},View.prototype.layoutSelf=function(t){let e=this.width,i=this.height,n=this.id,r=this.refIds.get(attrKeys.layout_maxWidth),o=this.refIds.get(attrKeys.layout_maxHeight),s=this.refIds.get(attrKeys.layout_minWidth),l=this.refIds.get(attrKeys.layout_minHeight),u=this.refIds.get(attrKeys.layout_constraintStart_toStartOf),h=this.refIds.get(attrKeys.layout_constraintEnd_toEndOf),c=this.refIds.get(attrKeys.layout_constraintTop_toTopOf),p=this.refIds.get(attrKeys.layout_constraintBottom_toBottomOf),d=this.refIds.get(attrKeys.layout_constraintCenterXAlign),f=this.refIds.get(attrKeys.layout_constraintCenterYAlign),g=[],m=this.getValueAndPriority(e);e=m.id;let $=m.priority;this.setWidthConstraints(t,g,this.id,e,$);let v=this.getValueAndPriority(i);i=v.id;let _=v.priority;if(this.setHeightConstraints(t,g,this.id,i,_),r){let E=this.getValueAndPriority(r);r=E.id;let A=E.priority;g.push({view1:n,attr1:"width",relation:"leq",constant:parseFloat(r),multiplier:1,priority:A})}if(s){let T=this.getValueAndPriority(s);s=T.id;let S=T.priority;g.push({view1:n,attr1:"width",relation:"geq",constant:parseFloat(s),multiplier:1,priority:S})}if(o){let C=this.getValueAndPriority(o);o=C.id;let I=C.priority;g.push({view1:n,attr1:"height",relation:"leq",constant:parseFloat(o),multiplier:1,priority:I})}if(l){let R=this.getValueAndPriority(l);l=R.id;let O=R.priority;g.push({view1:n,attr1:"height",relation:"geq",constant:parseFloat(l),multiplier:1,priority:O})}if(u){let P=this.getValueAndPriority(u);u=P.id;let L=P.priority;this.setLeftAlignSS(n,this.margins.start,"parent",L,g)}if(c){let N=this.getValueAndPriority(c);c=N.id;let V=N.priority;this.setTopAlignTT(n,this.margins.top,"parent",V,g)}if(h){let B=this.getValueAndPriority(h);h=B.id;let D=B.priority;this.setRightAlignEE(n,this.margins.end,"parent",D,g)}if(p){let W=this.getValueAndPriority(p);p=W.id;let q=W.priority;this.setBottomAlignBB(n,this.margins.bottom,"parent",q,g)}if(d){let M=this.getValueAndPriority(d);d=M.id;let k=M.priority;g.push({view1:n,attr1:"centerX",relation:"equ",view2:null,attr2:"centerX",constant:this.margins.start-this.margins.end,multiplier:1,priority:k})}if(f){let H=this.getValueAndPriority(f);f=H.id;let U=H.priority;g.push({view1:n,attr1:"centerY",relation:"equ",view2:null,attr2:"centerY",constant:this.margins.top-this.margins.bottom,multiplier:1,priority:U})}return g},View.prototype.layoutChildren=function(t){this.width,this.height;let e=[];for(let i=0;i<this.childrenIds.length;i++){let n=this.childrenIds[i],r=t.viewMap.get(n),o=r.refIds.get(attrKeys.layout_constraintStart_toStartOf),s=r.refIds.get(attrKeys.layout_constraintStart_toEndOf),l=r.refIds.get(attrKeys.layout_constraintEnd_toStartOf),u=r.refIds.get(attrKeys.layout_constraintEnd_toEndOf),h=r.refIds.get(attrKeys.layout_constraintTop_toTopOf),c=r.refIds.get(attrKeys.layout_constraintTop_toBottomOf),p=r.refIds.get(attrKeys.layout_constraintBottom_toTopOf),d=r.refIds.get(attrKeys.layout_constraintBottom_toBottomOf),f=r.refIds.get(attrKeys.layout_constraintCenterXAlign),g=r.refIds.get(attrKeys.layout_constraintCenterYAlign),m=r.refIds.get(attrKeys.layout_constraintStart_toCenterX),$=r.refIds.get(attrKeys.layout_constraintEnd_toCenterX),v=r.refIds.get(attrKeys.layout_constraintCenterX_toStart),_=r.refIds.get(attrKeys.layout_constraintCenterX_toEnd),E=r.refIds.get(attrKeys.layout_constraintTop_toCenterY),A=r.refIds.get(attrKeys.layout_constraintCenterY_toTop),T=r.refIds.get(attrKeys.layout_constraintBottom_toCenterY),S=r.refIds.get(attrKeys.layout_constraintCenterY_toBottom),C=r.refIds.get(attrKeys.layout_horizontalBias),I=r.refIds.get(attrKeys.layout_verticalBias);if("Guideline"===r.constructor.name){r.layoutGuide(e);continue}if(C){if(isNumber(C)){if((C=2*parseFloat(C))<0||C>2)throw"Invalid value set for horBias... should be between 0 and 1 on view.id="+n;0===C&&(C=MIN_BIAS)}else throw"Invalid type set for horBias... should be a number between 0 and 1 view.id="+n}else C=1;if(I){if(isNumber(I)){if((I=2*parseFloat(I))<0||I>2)throw"Invalid value set for verBias... should be between 0 and 1 on view.id="+n;0===I&&(I=MIN_BIAS)}else throw"Invalid type set for verBias... should be between 0 and 1 view.id="+n}else I=1;let R=r.refIds.get(attrKeys.layout_maxWidth),O=r.refIds.get(attrKeys.layout_maxHeight),P=r.refIds.get(attrKeys.layout_minWidth),L=r.refIds.get(attrKeys.layout_minHeight),N=r.width,V=r.height;N===sizes.WRAP_CONTENT&&(N=r.wrapWidth),V===sizes.WRAP_CONTENT&&(V=r.wrapHeight);let B=this.getValueAndPriority(N);N=B.id;let D=B.priority,W,q;B.defaultUsed&&(o&&u||o&&l||o&&$||s&&u||s&&l||s&&$||m&&u||m&&l||m&&$)&&(0===parseInt(N)?D=AutoLayout.Priority.DEFAULTLOW:(W=n+"_dummywid_"+ULID.ulid(),o?this.setLeftAlignSS(W,r.margins.start,o,AutoLayout.Priority.REQUIRED,e):s?this.setLeftAlignSE(W,r.margins.start,s,AutoLayout.Priority.REQUIRED,e):m&&this.setLeftAlignCX(W,r.margins.start,m,AutoLayout.Priority.REQUIRED,e),u?this.setRightAlignEE(W,r.margins.end,u,AutoLayout.Priority.REQUIRED,e):l?this.setRightAlignES(W,r.margins.end,l,AutoLayout.Priority.REQUIRED,e):$&&this.setRightAlignCX(W,r.margins.end,$,AutoLayout.Priority.REQUIRED,e),e.push({view1:W,attr1:"width",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:0,multiplier:1,priority:249}),e.push({view1:n,attr1:"centerX",relation:"equ",view2:W,attr2:"centerX",constant:r.margins.horMarginDiff(),multiplier:C,priority:AutoLayout.Priority.REQUIRED}))),this.setWidthConstraints(t,e,n,N,D);let M=this.getValueAndPriority(V);V=M.id;let k=M.priority;if(M.defaultUsed&&(h&&d||h&&p||h&&T||c&&d||c&&p||c&&T||E&&d||E&&p||E&&T)&&(0===parseInt(V)?k=AutoLayout.Priority.DEFAULTLOW:(k=AutoLayout.Priority.REQUIRED,q=n+"_dummyhei_"+ULID.ulid(),h?this.setTopAlignTT(q,r.margins.top,h,AutoLayout.Priority.REQUIRED,e):c?this.setTopAlignTB(q,r.margins.top,c,AutoLayout.Priority.REQUIRED,e):E&&this.setTopAlignCY(q,r.margins.top,E,AutoLayout.Priority.REQUIRED,e),d?this.setBottomAlignBB(q,r.margins.bottom,d,AutoLayout.Priority.REQUIRED,e):p?this.setBottomAlignBT(q,r.margins.bottom,p,AutoLayout.Priority.REQUIRED,e):T&&this.setBottomAlignCY(q,r.margins.bottom,T,AutoLayout.Priority.REQUIRED,e),e.push({view1:q,attr1:"height",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:0,multiplier:1,priority:249}),e.push({view1:n,attr1:"centerY",relation:"equ",view2:q,attr2:"centerY",constant:r.margins.verMarginDiff(),multiplier:I,priority:AutoLayout.Priority.REQUIRED}))),this.setHeightConstraints(t,e,n,V,k),this.setSizeBoundariesConstraints(t,e,n,R,P,O,L),o&&!W){let H=this.getValueAndPriority(o);o=H.id;let U=H.priority;this.setLeftAlignSS(n,r.margins.start,o,U,e)}if(h&&!q){let F=this.getValueAndPriority(h);h=F.id;let G=F.priority;this.setTopAlignTT(n,r.margins.top,h,G,e)}if(u&&!W){let X=this.getValueAndPriority(u);u=X.id;let j=X.priority;this.setRightAlignEE(n,r.margins.end,u,j,e)}if(d&&!q){let K=this.getValueAndPriority(d);d=K.id;let Y=K.priority;this.setBottomAlignBB(n,r.margins.bottom,d,Y,e)}if(s&&!W){let Q=this.getValueAndPriority(s);s=Q.id;let Z=Q.priority;this.setLeftAlignSE(n,r.margins.start,s,Z,e)}if(l&&!W){let J=this.getValueAndPriority(l);l=J.id;let tt=J.priority;this.setRightAlignES(n,r.margins.end,l,tt,e)}if(c&&!q){let te=this.getValueAndPriority(c);c=te.id;let ti=te.priority;this.setTopAlignTB(n,r.margins.top,c,ti,e)}if(p&&!q){let tn=this.getValueAndPriority(p);p=tn.id;let tr=tn.priority;this.setBottomAlignBT(n,r.margins.bottom,p,tr,e)}if(f){let to=this.getValueAndPriority(f);f=to.id;let ts=to.priority;if(!r.margins.horUnitsSame)throw"`cx` needs margin-start and margin-end to have same units!";e.push({view1:n,attr1:"centerX",relation:"equ",view2:"parent"===f?null:f,attr2:"centerX",constant:r.margins.horMarginDiff(),multiplier:C,priority:ts})}if(g){let ta=this.getValueAndPriority(g);g=ta.id;let tl=ta.priority;if(!r.margins.verUnitsSame)throw"`cy` needs margin-top and margin-bottom to have same units!";e.push({view1:n,attr1:"centerY",relation:"equ",view2:"parent"===g?null:g,attr2:"centerY",constant:r.margins.verMarginDiff(),multiplier:I,priority:tl})}if(m&&!W){let tu=this.getValueAndPriority(m);m=tu.id;let th=tu.priority;this.setLeftAlignCX(n,r.margins.start,m,th,e)}if($&&!W){let tc=this.getValueAndPriority($);$=tc.id;let tp=tc.priority;this.setRightAlignCX(n,r.margins.end,$,tp,e)}if(v&&!W){let td=this.getValueAndPriority(v);v=td.id;let tf=td.priority;if(!r.margins.horUnitsSame)throw"`cxs` needs margin-start and margin-end to have same units!";this.setCXAlignLeft(n,r.margins.horMarginDiff(),v,tf,e)}if(_&&!W){let ty=this.getValueAndPriority(_);_=ty.id;let tg=ty.priority;if(!r.margins.horUnitsSame)throw"`cxe` needs margin-start and margin-end to have same units!";this.setCXAlignRight(n,r.margins.horMarginDiff(),_,tg,e)}if(E&&!W){let tm=this.getValueAndPriority(E);E=tm.id;let tw=tm.priority;this.setTopAlignCY(n,r.margins.top,E,tw,e)}if(T&&!W){let t$=this.getValueAndPriority(T);T=t$.id;let tv=t$.priority;this.setBottomAlignCY(n,r.margins.bottom,T,tv,e)}if(A&&!W){let tb=this.getValueAndPriority(A);A=tb.id;let t_=tb.priority;if(!r.margins.verUnitsSame)throw"`bcy` needs margin-top and margin-bottom to have same units!";this.setCYAlignTop(n,r.margins.verMarginDiff(),A,t_,e)}if(S&&!W){let t8=this.getValueAndPriority(S);S=t8.id;let tx=t8.priority;if(!r.margins.verUnitsSame)throw"`cyb` needs margin-top and margin-bottom to have same units!";this.setCYAlignBottom(n,r.margins.verMarginDiff(),S,tx,e)}}return e},View.prototype.setLeftAlignSS=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:"left",relation:"equ",view2:"parent"===i?null:i,attr2:"left",constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:"left",relation:"equ",view2:"parent"===i?null:i,attr2:"left",constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:"left",relation:"equ",view2:"parent"===i?null:i,attr2:"left",constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-left can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:"left",relation:"equ",view2:null,attr2:"left",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"left",relation:"equ",view2:s,attr2:"right",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:"left",relation:"equ",view2:i,attr2:"left",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"left",relation:"equ",view2:s,attr2:"right",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setLeftAlignSE=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:"left",relation:"equ",view2:"parent"===i?null:i,attr2:"right",constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:"left",relation:"equ",view2:"parent"===i?null:i,attr2:"right",constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:"left",relation:"equ",view2:"parent"===i?null:i,attr2:"right",constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-left can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:"left",relation:"equ",view2:null,attr2:"right",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"left",relation:"equ",view2:s,attr2:"right",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:"left",relation:"equ",view2:i,attr2:"right",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"left",relation:"equ",view2:s,attr2:"right",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setRightAlignEE=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:"right",relation:"equ",view2:"parent"===i?null:i,attr2:"right",constant:-1*e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:"right",relation:"equ",view2:"parent"===i?null:i,attr2:"right",constant:-1*parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:"right",relation:"equ",view2:"parent"===i?null:i,attr2:"right",constant:-1*parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-right can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:"right",relation:"equ",view2:null,attr2:"right",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"right",relation:"equ",view2:s,attr2:"left",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:"right",relation:"equ",view2:i,attr2:"right",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"right",relation:"equ",view2:s,attr2:"left",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setRightAlignES=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:"right",relation:"equ",view2:"parent"===i?null:i,attr2:"left",constant:-1*e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:"right",relation:"equ",view2:"parent"===i?null:i,attr2:"left",constant:-1*parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:"right",relation:"equ",view2:"parent"===i?null:i,attr2:"left",constant:-1*parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-right can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:"right",relation:"equ",view2:null,attr2:"left",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"right",relation:"equ",view2:s,attr2:"left",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:"right",relation:"equ",view2:i,attr2:"left",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"right",relation:"equ",view2:s,attr2:"left",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setLeftAlignCX=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERX,constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERX,constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERX,constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-left can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:null,attr2:AutoLayout.Attribute.CENTERX,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"left",relation:"equ",view2:s,attr2:"right",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:i,attr2:AutoLayout.Attribute.CENTERX,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"left",relation:"equ",view2:s,attr2:"right",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setCXAlignLeft=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.LEFT,constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.LEFT,constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.LEFT,constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-left can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:null,attr2:AutoLayout.Attribute.LEFT,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:s,attr2:AutoLayout.Attribute.RIGHT,constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:i,attr2:AutoLayout.Attribute.LEFT,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:s,attr2:AutoLayout.Attribute.RIGHT,constant:1,multiplier:1,priority:1e3}))}},View.prototype.setCXAlignRight=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.RIGHT,constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.RIGHT,constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.RIGHT,constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margins can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:null,attr2:AutoLayout.Attribute.RIGHT,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:s,attr2:AutoLayout.Attribute.RIGHT,constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:AutoLayout.Attribute.LEFT,relation:"equ",view2:i,attr2:AutoLayout.Attribute.RIGHT,constant:1,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:AutoLayout.Attribute.CENTERX,relation:"equ",view2:s,attr2:AutoLayout.Attribute.RIGHT,constant:1,multiplier:1,priority:1e3}))}},View.prototype.setRightAlignCX=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:AutoLayout.Attribute.RIGHT,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERX,constant:-e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:AutoLayout.Attribute.RIGHT,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERX,constant:-parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:AutoLayout.Attribute.RIGHT,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERX,constant:-parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-left can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:AutoLayout.Attribute.RIGHT,relation:"equ",view2:null,attr2:AutoLayout.Attribute.CENTERX,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"left",relation:"equ",view2:s,attr2:"left",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:AutoLayout.Attribute.RIGHT,relation:"equ",view2:i,attr2:AutoLayout.Attribute.CENTERX,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"left",relation:"equ",view2:s,attr2:"left",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setTopAlignCY=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERY,constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERY,constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERY,constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-left can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:null,attr2:AutoLayout.Attribute.CENTERY,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"height",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"top",relation:"equ",view2:s,attr2:"bottom",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:i,attr2:AutoLayout.Attribute.CENTERY,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"top",relation:"equ",view2:s,attr2:"bottom",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setCYAlignTop=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.TOP,constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.TOP,constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.TOP,constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-left can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:null,attr2:AutoLayout.Attribute.TOP,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:s,attr2:AutoLayout.Attribute.BOTTOM,constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:i,attr2:AutoLayout.Attribute.TOP,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:s,attr2:AutoLayout.Attribute.BOTTOM,constant:1,multiplier:1,priority:1e3}))}},View.prototype.setCYAlignBottom=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.BOTTOM,constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.BOTTOM,constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.BOTTOM,constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margins can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:null,attr2:AutoLayout.Attribute.BOTTOM,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:s,attr2:AutoLayout.Attribute.BOTTOM,constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:AutoLayout.Attribute.TOP,relation:"equ",view2:i,attr2:AutoLayout.Attribute.BOTTOM,constant:1,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:AutoLayout.Attribute.CENTERY,relation:"equ",view2:s,attr2:AutoLayout.Attribute.BOTTOM,constant:1,multiplier:1,priority:1e3}))}},View.prototype.setBottomAlignCY=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:AutoLayout.Attribute.BOTTOM,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERY,constant:-e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:AutoLayout.Attribute.BOTTOM,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERY,constant:-parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:AutoLayout.Attribute.BOTTOM,relation:"equ",view2:"parent"===i?null:i,attr2:AutoLayout.Attribute.CENTERY,constant:-parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-left can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:AutoLayout.Attribute.BOTTOM,relation:"equ",view2:null,attr2:AutoLayout.Attribute.CENTERY,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"top",relation:"equ",view2:s,attr2:"top",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:AutoLayout.Attribute.BOTTOM,relation:"equ",view2:i,attr2:AutoLayout.Attribute.CENTERY,constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"top",relation:"equ",view2:s,attr2:"top",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setTopAlignTT=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:"top",relation:"equ",view2:"parent"===i?null:i,attr2:"top",constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:"top",relation:"equ",view2:"parent"===i?null:i,attr2:"top",constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:"top",relation:"equ",view2:"parent"===i?null:i,attr2:"top",constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-top can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100;if(!o)throw"Invalid expression found for margin-top on id: "+t;let s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:"top",relation:"equ",view2:null,attr2:"top",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"top",relation:"equ",view2:s,attr2:"bottom",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:"top",relation:"equ",view2:i,attr2:"top",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"top",relation:"equ",view2:s,attr2:"bottom",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setTopAlignTB=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:"top",relation:"equ",view2:"parent"===i?null:i,attr2:"bottom",constant:e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:"top",relation:"equ",view2:"parent"===i?null:i,attr2:"bottom",constant:parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:"top",relation:"equ",view2:"parent"===i?null:i,attr2:"bottom",constant:parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-top can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100;if(!o)throw"Invalid expression found for margin-top on id: "+t;let s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:"top",relation:"equ",view2:null,attr2:"bottom",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"top",relation:"equ",view2:s,attr2:"bottom",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:"top",relation:"equ",view2:i,attr2:"bottom",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"top",relation:"equ",view2:s,attr2:"bottom",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setBottomAlignBB=function(t,e,i,n,r){if("number"==typeof e)r.push({view1:t,attr1:"bottom",relation:"equ",view2:"parent"===i?null:i,attr2:"bottom",constant:-1*e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:"bottom",relation:"equ",view2:"parent"===i?null:i,attr2:"bottom",constant:-1*parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:"bottom",relation:"equ",view2:"parent"===i?null:i,attr2:"bottom",constant:-1*parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-bottom can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:"bottom",relation:"equ",view2:null,attr2:"bottom",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"bottom",relation:"equ",view2:s,attr2:"top",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:"bottom",relation:"equ",view2:i,attr2:"bottom",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"bottom",relation:"equ",view2:s,attr2:"top",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setBottomAlignBT=function(t,e,i,n,r){if("number"==typeof(e="0%"===e?0:e))r.push({view1:t,attr1:"bottom",relation:"equ",view2:"parent"===i?null:i,attr2:"top",constant:-1*e,multiplier:1,priority:n});else if(isNumber(e))r.push({view1:t,attr1:"bottom",relation:"equ",view2:"parent"===i?null:i,attr2:"top",constant:-1*parseFloat(e),multiplier:1,priority:n});else if(endsWith(e,"px"))r.push({view1:t,attr1:"bottom",relation:"equ",view2:"parent"===i?null:i,attr2:"top",constant:-1*parseFloat(e),multiplier:1,priority:n});else{if(!endsWith(e,"%"))throw"margin-bottom can only be expressed in pixels, in percentage(%) or without units, on id: "+t;let o=parseFloat(e)/100,s=t+"_dummy_"+ULID.ulid();"parent"===i?(r.push({view1:s,attr1:"bottom",relation:"equ",view2:null,attr2:"top",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"bottom",relation:"equ",view2:s,attr2:"top",constant:1,multiplier:1,priority:1e3})):(r.push({view1:s,attr1:"bottom",relation:"equ",view2:i,attr2:"top",constant:0,multiplier:1,priority:1e3}),r.push({view1:s,attr1:"height",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:o,priority:1e3}),r.push({view1:t,attr1:"bottom",relation:"equ",view2:s,attr2:"top",constant:1,multiplier:1,priority:1e3}))}},View.prototype.setSizeBoundariesConstraints=function(t,e,i,n,r,o,s){if(n){let l=this.getValueAndPriority(n);n=l.id;let u=l.priority,h=-1,c="";if(isNumber(n))e.push({view1:i,attr1:"width",relation:"leq",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:parseFloat(n),multiplier:1,priority:u});else if("parent"===n||-1!==this.childrenIds.indexOf(n))e.push({view1:i,attr1:"width",relation:"leq",view2:"parent"===n?null:n,attr2:"width",constant:0,multiplier:1,priority:u});else if(-1!==(h=n.indexOf("."))&&-1!==this.childrenIds.indexOf(c=n.substring(0,h)))"width"===n.substring(h+1)?e.push({view1:i,attr1:"width",relation:"leq",view2:"parent"===c?null:c,attr2:"width",constant:0,multiplier:1,priority:u}):"height"===n.substring(h+1)&&e.push({view1:i,attr1:"width",relation:"leq",view2:"parent"===c?null:c,attr2:"height",constant:0,multiplier:1,priority:u});else{let p=parseNumberAndUnitsNoValidation(n,!0);if(p.number){if("px"===p.units)e.push({view1:i,attr1:"width",relation:"leq",constant:parseFloat(p.number),view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,multiplier:1,priority:u});else if("%"===p.units)e.push({view1:i,attr1:"width",relation:"leq",view2:null,attr2:"width",constant:0,multiplier:parseFloat(p.number)/100,priority:u});else if("em"===p.units)e.push({view1:i,attr1:"width",relation:"leq",view2:null,attr2:"width",constant:0,multiplier:parseFloat(p.number),priority:u});else throw"Invalid values specified for the max-width units on view.id="+i}else throw"Bad value specified for the max-width units on view.id="+i+", value="+n}}if(r){let d=this.getValueAndPriority(r);r=d.id;let f=d.priority,g=-1,m="";if(isNumber(r))e.push({view1:i,attr1:"width",relation:"geq",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:parseFloat(r),multiplier:1,priority:f});else if("parent"===r||-1!==this.childrenIds.indexOf(r))e.push({view1:i,attr1:"width",relation:"geq",view2:"parent"===r?null:r,attr2:"width",constant:0,multiplier:1,priority:f});else if(-1!==(g=r.indexOf("."))&&-1!==this.childrenIds.indexOf(m=r.substring(0,g)))"width"===r.substring(g+1)?e.push({view1:i,attr1:"width",relation:"geq",view2:"parent"===m?null:m,attr2:"width",constant:0,multiplier:1,priority:f}):"height"===r.substring(g+1)&&e.push({view1:i,attr1:"width",relation:"geq",view2:"parent"===m?null:m,attr2:"height",constant:0,multiplier:1,priority:f});else{let $=parseNumberAndUnitsNoValidation(r,!0);if($.number){if("px"===$.units)e.push({view1:i,attr1:"width",relation:"geq",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:parseFloat($.number),multiplier:1,priority:f});else if("%"===$.units)e.push({view1:i,attr1:"width",relation:"geq",view2:null,attr2:"width",constant:0,multiplier:parseFloat($.number)/100,priority:f});else if("em"===$.units)e.push({view1:i,attr1:"width",relation:"geq",view2:null,attr2:"width",constant:0,multiplier:parseFloat($.number),priority:f});else throw"Invalid values specified for the min-width units on view.id="+i}else throw"Bad value specified for the min-width units on view.id="+i+", value="+r}}if(o){let v=this.getValueAndPriority(o);o=v.id;let _=v.priority,E=-1,A="";if(isNumber(o))e.push({view1:i,attr1:"height",relation:"leq",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:parseFloat(o),multiplier:1,priority:_});else if("parent"===o||-1!==this.childrenIds.indexOf(o))e.push({view1:i,attr1:"height",relation:"leq",view2:"parent"===o?null:o,attr2:"height",constant:0,multiplier:1,priority:_});else if(-1!==(E=o.indexOf("."))&&-1!==this.childrenIds.indexOf(A=o.substring(0,E)))"width"===o.substring(E+1)?e.push({view1:i,attr1:"height",relation:"leq",view2:"parent"===A?null:A,attr2:"width",constant:0,multiplier:1,priority:_}):"height"===o.substring(E+1)&&e.push({view1:i,attr1:"height",relation:"leq",view2:"parent"===A?null:A,attr2:"height",constant:0,multiplier:1,priority:_});else{let T=parseNumberAndUnitsNoValidation(o,!0);if(T.number){if("px"===T.units)e.push({view1:i,attr1:"height",relation:"leq",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:parseFloat(T.number),multiplier:1,priority:_});else if("%"===T.units)e.push({view1:i,attr1:"height",relation:"leq",view2:null,attr2:"height",constant:0,multiplier:parseFloat(T.number)/100,priority:_});else if("em"===T.units)e.push({view1:i,attr1:"height",relation:"leq",view2:null,attr2:"height",constant:0,multiplier:parseFloat(T.number),priority:_});else throw"Invalid values specified for the max-height units on view.id="+i}else throw"Bad value specified for the max-height units on view.id="+i+", value="+o}}if(s){let S=this.getValueAndPriority(s);s=S.id;let C=S.priority,I=-1,R="";if(isNumber(s))e.push({view1:i,attr1:"height",relation:"geq",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:parseFloat(s),multiplier:1,priority:C});else if("parent"===s||-1!==this.childrenIds.indexOf(o))e.push({view1:i,attr1:"height",relation:"geq",view2:"parent"===s?null:s,attr2:"height",constant:0,multiplier:1,priority:C});else if(-1!==(I=s.indexOf("."))&&-1!==this.childrenIds.indexOf(R=s.substring(0,I)))"width"===s.substring(I+1)?e.push({view1:i,attr1:"height",relation:"geq",view2:"parent"===R?null:R,attr2:"width",constant:0,multiplier:1,priority:C}):"height"===s.substring(I+1)&&e.push({view1:i,attr1:"height",relation:"geq",view2:"parent"===R?null:R,attr2:"height",constant:0,multiplier:1,priority:C});else{let O=parseNumberAndUnitsNoValidation(s,!0);if(O.number){if("px"===O.units)e.push({view1:i,attr1:"height",relation:"geq",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:parseFloat(O.number),multiplier:1,priority:C});else if("%"===O.units)e.push({view1:i,attr1:"height",relation:"geq",view2:null,attr2:"height",constant:0,multiplier:parseFloat(O.number)/100,priority:C});else if("em"===O.units)e.push({view1:i,attr1:"height",relation:"geq",view2:null,attr2:"height",constant:0,multiplier:parseFloat(O.number),priority:C});else throw"Invalid values specified for the min-height units on view.id="+i}else throw"Bad value specified for the min-height units on view.id="+i+", value="+s}}},View.prototype.setWidthConstraints=function(t,e,i,n,r){let o=n.indexOf("*"),s=n.indexOf("+"),l=n.indexOf("-"),u=n.indexOf("."),h,c;if(isNumber(n)){if(0===(n="string"==typeof n?parseFloat(n):n)){let p=t.viewMap.get(i);if(-1!==p.dimRatio){e.push({view1:i,attr1:"width",relation:"equ",view2:i,attr2:AutoLayout.Attribute.HEIGHT,constant:0,multiplier:p.dimRatio,priority:r});return}}e.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:n,multiplier:1,priority:r})}else if((h=parseNumberAndUnitsNoValidation(n,!0)).number){let d=parseFloat(h.number);if(0===d){let f=t.viewMap.get(i);if(-1!==f.dimRatio){e.push({view1:i,attr1:"width",relation:"equ",view2:i,attr2:AutoLayout.Attribute.HEIGHT,constant:0,multiplier:f.dimRatio,priority:r});return}}switch(h.units){case CssSizeUnits.PX:e.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:d,multiplier:1,priority:r});break;case CssSizeUnits.PCT:e.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:0,multiplier:d/100,priority:r});break;default:throw"width value is bad on id: "+i+", bad value is: "+n}}else if("height"===n)e.push({view1:i,attr1:"width",relation:"equ",view2:i,attr2:"height",constant:0,multiplier:1,priority:r});else if("parent"===n||-1!==this.childrenIds.indexOf(n))e.push({view1:i,attr1:"width",relation:"equ",view2:"parent"===n?null:n,attr2:"width",constant:0,multiplier:1,priority:r});else if(-1!==o&&-1!==s||-1!==s&&-1!==l||-1!==o&&-1!==l)throw"width can only compare using one of `*` or `+` or `-`";else if(-1!==o||-1!==s||-1!==l){let g=quickScan(n,!0);if(3!==g.length&&5!==g.length)throw"invalid expression for width found on view.id="+i+", expression: "+n;let m=g.indexOf("*"),$=g.indexOf("+"),v=g.indexOf("-");if(-1!==m){let _,E;if(isNumber(E=g[0])){if("width"===(_="height"===g[2]?i:g[2]))throw"the width is not yet initialized";if(3===g.length)c="height"!==g[2];else if(5===g.length)c="width"===g[4];else throw"error in value specified for width on view.id="+i+"... expression "+n}else if(isNumber(E=g[g.length-1])){if("width"===(_="height"===g[0]?i:g[0]))throw"the width is not yet initialized";if(3===g.length)c="height"!==g[0];else if(5===g.length)c="width"===g[2];else throw"error in value specified for width on view.id="+i+"... expression "+n}e.push({view1:i,attr1:"width",relation:"equ",view2:"parent"===_?null:_,attr2:c?"width":"height",constant:0,multiplier:parseFloat(E),priority:r})}else if(-1!==$){let A,T;if(isNumber(T=g[0])){if("width"===(A="height"===g[2]?i:g[2]))throw"the width is not yet initialized";if(3===g.length)c="height"!==g[2];else if(5===g.length)c="width"===g[4];else throw"error in value specified for width on view.id="+cid+"... expression "+n}else if(isNumber(T=g[g.length-1])){if("width"===(A="height"===g[0]?i:g[0]))throw"the width is not yet initialized";if(3===g.length)c="height"!==g[0];else if(5===g.length)c="width"===g[2];else throw"error in value specified for width on view.id="+i+"... expression "+n}e.push({view1:i,attr1:"width",relation:"equ",view2:"parent"===A?null:A,attr2:c?"width":"height",constant:parseFloat(T),multiplier:1,priority:r})}else if(-1!==v){let S,C;if(isNumber(C=g[0]))throw"`value-elem[.width|height]` is not allowed, but `elem[.width|height]-value is allowed on ` view.id="+cid+"... expression "+n;if(isNumber(C=g[g.length-1])){if("width"===(S="height"===g[0]?i:g[0]))throw"the width is not yet initialized";if(3===g.length)c="height"!==g[0];else if(5===g.length)c="width"===g[2];else throw"error in value specified for width on view.id="+i+"... expression "+n}e.push({view1:i,attr1:"width",relation:"equ",view2:"parent"===S?null:S,attr2:c?"width":"height",constant:-1*parseFloat(C),multiplier:1,priority:r})}}else if(-1===o&&-1===s&&-1===l&&-1!==u){let I=n.substring(0,u),R=n.substring(u+1);if("width"===R)c=!0;else if("height"===R)c=!1;else throw"Strange expression found for width on id: "+i+", expression is: "+n;let O;if("parent"===I||"parent"===R)O=null;else if(-1!==this.childrenIds.indexOf(I))O=I;else throw"Bad expression found for width on id: "+i+", expression is: "+n;e.push({view1:i,attr1:"width",relation:"equ",view2:O,attr2:c?"width":"height",constant:0,multiplier:1,priority:r})}else throw"invalid value for width on id: "+i+", bad value is: "+n},View.prototype.setHeightConstraints=function(t,e,i,n,r){let o=n.indexOf("*"),s=n.indexOf("+"),l=n.indexOf("-"),u=n.indexOf("."),h,c;if(isNumber(n)){if(0===(n="string"==typeof n?parseFloat(n):n)){let p=t.viewMap.get(i);if(-1!==p.dimRatio){e.push({view1:i,attr1:AutoLayout.Attribute.HEIGHT,relation:"equ",view2:i,attr2:AutoLayout.Attribute.WIDTH,constant:0,multiplier:1/p.dimRatio,priority:r});return}}e.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:n,multiplier:1,priority:r})}else if((h=parseNumberAndUnitsNoValidation(n,!0)).number){let d=parseFloat(h.number);if(0===d){let f=t.viewMap.get(i);if(-1!==f.dimRatio){e.push({view1:i,attr1:AutoLayout.Attribute.HEIGHT,relation:"equ",view2:i,attr2:AutoLayout.Attribute.WIDTH,constant:0,multiplier:1/f.dimRatio,priority:r});return}}switch(h.units){case CssSizeUnits.PX:e.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:d,multiplier:1,priority:r});break;case CssSizeUnits.PCT:e.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:"height",constant:0,multiplier:d/100,priority:r});break;default:throw"height value is bad on id: "+i+", bad value is: "+n}}else if("width"===n)e.push({view1:i,attr1:"height",relation:"equ",view2:i,attr2:"width",constant:0,multiplier:1,priority:r});else if("parent"===n||-1!==this.childrenIds.indexOf(n))e.push({view1:i,attr1:"height",relation:"equ",view2:"parent"===n?null:n,attr2:"height",constant:0,multiplier:1,priority:r});else if(-1!==o&&-1!==s||-1!==s&&-1!==l||-1!==o&&-1!==l)throw"width can only compare using one of `*` or `+` or `-`";else if(-1!==o||-1!==s||-1!==l){let g=quickScan(n,!0);if(3!==g.length&&5!==g.length)throw"invalid expression for height found on view.id="+i+",... "+g;let m=g.indexOf("*"),$=g.indexOf("+"),v=g.indexOf("-");if(-1!==m){let _,E;if(isNumber(E=g[0])){if("height"===(_="width"===g[2]?i:g[2]))throw"the height is not yet initialized";if(3===g.length)c="width"!==g[2];else if(5===g.length)c="height"===g[4];else throw"error in value specified for height on view.id="+i+"... expression "+n}else if(isNumber(E=g[g.length-1])){if("height"===(_="width"===g[0]?i:g[0]))throw"the height is not yet initialized";if(3===g.length)c="width"!==g[0];else if(5===g.length)c="height"===g[2];else throw"error in value specified for height on view.id="+i+"... expression "+n}e.push({view1:i,attr1:"height",relation:"equ",view2:"parent"===_?null:_,attr2:c?"height":"width",constant:0,multiplier:parseFloat(E),priority:r})}else if(-1!==$){let A,T;if(isNumber(T=g[0])){if("height"===(A="width"===g[2]?i:g[2]))throw"the height is not yet initialized";if(3===g.length)c="width"!==g[2];else if(5===g.length)c="height"===g[4];else throw"error in value specified for height on view.id="+i+"... expression "+n}else if(isNumber(T=g[g.length-1])){if("height"===(A="width"===g[0]?i:g[0]))throw"the height is not yet initialized";if(3===g.length)c="width"!==g[0];else if(5===g.length)c="height"===g[2];else throw"error in value specified for height on view.id="+i+"... expression "+n}e.push({view1:i,attr1:"height",relation:"equ",view2:"parent"===A?null:A,attr2:c?"height":"width",constant:parseFloat(T),multiplier:1,priority:r})}else if(-1!==v){let S,C;if(isNumber(C=g[0]))throw"`value-elem[.width|height]` is not allowed, but `elem[.width|height]-value is allowed on ` view.id="+cid+"... expression "+w;if(isNumber(C=g[g.length-1])){if("height"===(S="width"===g[0]?i:g[0]))throw"the height is not yet initialized";if(3===g.length)c="width"!==g[0];else if(5===g.length)c="height"===g[2];else throw"error in value specified for height on view.id="+i+"... expression "+n}e.push({view1:i,attr1:"height",relation:"equ",view2:"parent"===S?null:S,attr2:c?"height":"width",constant:-1*parseFloat(C),multiplier:1,priority:r})}}else if(-1===o&&-1===s&&-1!==u){let I=n.substring(0,u),R=n.substring(u+1);if("height"===R)c=!0;else if("width"===R)c=!1;else throw"Strange expression found for height on id: "+i+", expression is: "+n;let O;if("parent"===I||"parent"===R)O=null;else if(-1!==this.childrenIds.indexOf(I))O=I;else throw"Bad expression found for height on id: "+i+", expression is: "+n;e.push({view1:i,attr1:"height",relation:"equ",view2:O,attr2:c?"height":"width",constant:0,multiplier:1,priority:r})}else throw"invalid value for height on id: "+i+", bad value is: "+n},View.prototype.toHTML=function(){let t=null,e=this.htmlNode.nodeName.toLowerCase();if(isHTMLTagName(e))return(t="li"===e?document.createElement("ul"):"tbody"===e||"thead"===e||"tfoot"===e?document.createElement("table"):"tr"===e?document.createElement("table"):"td"===e||"th"===e?document.createElement("tr"):"option"===e?document.createElement("select"):document.createElement("div")).appendChild(this.htmlNode),t.innerHTML;throw"Invalid HTML element!"},View.prototype.calculateWrapContentSizes=function(t){let e=this.refIds.get(attrKeys.layout_width),i=this.refIds.get(attrKeys.layout_height);if(e===sizes.WRAP_CONTENT&&i===sizes.WRAP_CONTENT){let n=t.getBoundingClientRect();this.wrapWidth=.813*n.width+"px",this.wrapHeight=.825*n.height+"px"}else if(e!==sizes.WRAP_CONTENT&&i===sizes.WRAP_CONTENT){t.style.width=e;let r=t.getBoundingClientRect();this.wrapHeight=.825*r.height+"px"}else if(e===sizes.WRAP_CONTENT&&i!==sizes.WRAP_CONTENT){t.style.height=i;let o=t.getBoundingClientRect();this.wrapWidth=.813*o.width+"px"}},Guideline.prototype=Object.create(View.prototype),Guideline.prototype.constructor=Guideline,IncludedView.prototype=Object.create(View.prototype),IncludedView.prototype.constructor=IncludedView,Guideline.prototype.calculateWrapContentSizes=function(t){let e=this.refIds.get(attrKeys.orientation);if(null==e||""===e)throw"Please specify the orientation of the Guideline whose id is `"+this.id+"`";e===orientations.VERTICAL?(this.wrapWidth="1",this.wrapHeight=sizes.MATCH_PARENT):(this.wrapWidth=sizes.MATCH_PARENT,this.wrapHeight="1")},Guideline.prototype.layoutGuide=function(t){let e=this.refIds.get(attrKeys.orientation);if(!e||""===e)throw"Please specify the orientation of the Guideline whose id is `"+this.id+"`";let i=this.id,n=this.refIds.get(attrKeys.layout_constraintGuide_percent),r=this.refIds.get(attrKeys.layout_constraintGuide_begin),o=this.refIds.get(attrKeys.layout_constraintGuide_end);if(isEmpty(n)&&isEmpty(r)&&isEmpty(o))throw"Please specify either constraint-guide-(percentage|begin|end) for the Guideline whose id is `"+this.id+"`";let s=0;if(!isEmpty(n)){if(!isEmpty(r)||!isEmpty(o))throw"Conflicting guide constraints! only one of guide_percent, guide_begin and guide_end hould be set!";if(endsWith(n,"%")){if(isNaN(s=parseFloat(n)))throw"Please specify a floating point number between 0 and 1 to signify 0 - 100% of width";s=s>1?s/100:s}else if(isNaN(s=parseFloat(n)))throw"Please specify a floating point number between 0 and 1 to signify 0 - 100% of width";else{if(s>1)throw"The guide percentage may not be greater than 1";if(s<0)throw"The guide percentage may not be less than 0"}if(e===orientations.VERTICAL){t.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:"height",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED}),t.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:.1,multiplier:1,priority:AutoLayout.Priority.REQUIRED});let l=i+"_dummy_"+ULID.ulid();t.push({view1:l,attr1:"left",relation:"equ",view2:null,attr2:"left",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED}),t.push({view1:l,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:1,multiplier:s,priority:AutoLayout.Priority.REQUIRED}),t.push({view1:i,attr1:"left",relation:"equ",view2:l,attr2:"right",constant:1,multiplier:1,priority:AutoLayout.Priority.REQUIRED})}else if(e===orientations.HORIZONTAL){t.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED}),t.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:.1,multiplier:1,priority:AutoLayout.Priority.REQUIRED});let u=i+"_dummy_"+ULID.ulid();t.push({view1:u,attr1:"top",relation:"equ",view2:null,attr2:"top",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED}),t.push({view1:u,attr1:"height",relation:"equ",view2:null,attr2:"height",constant:1,multiplier:s,priority:AutoLayout.Priority.REQUIRED}),t.push({view1:i,attr1:"top",relation:"equ",view2:u,attr2:"bottom",constant:0,multiplier:1,priority:AutoLayout.Priority.REQUIRED})}}if(!isEmpty(r)){if(!isEmpty(n)||!isEmpty(o))throw"Conflicting guide constraints! only one of `guide_percent`, `guide_begin` and `guide_end` should be set!";if(isNumber(r)||endsWith(r,"px")&&isNumber(parseInt(r)))r=parseFloat(r);else throw"`guide_begin` must be a unitless number or be specified in pixels";if(isNaN(r))throw"please specify a number for `guide_begin`";s=r,e===orientations.VERTICAL?(t.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:"height",constant:0,multiplier:1,priority:1e3}),t.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:.1,multiplier:1,priority:1e3}),t.push({view1:i,attr1:"left",relation:"equ",view2:null,attr2:"left",constant:s,multiplier:1,priority:1e3})):e===orientations.HORIZONTAL&&(t.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:0,multiplier:1,priority:1e3}),t.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:.1,multiplier:1,priority:1e3}),t.push({view1:i,attr1:"top",relation:"equ",view2:null,attr2:"top",constant:s,multiplier:1,priority:1e3}))}if(!isEmpty(o)){if(!isEmpty(n)||!isEmpty(r))throw"Conflicting guide constraints! only one of `guide_percent`, `guide_begin` and `guide_end` should be set!";if(isNumber(o)||endsWith(o,"px")&&isNumber(parseInt(o)))o=parseFloat(o);else throw"`guide_end` must be a unitless number or be specified in pixels";if(isNaN(o))throw"please specify a number for `guide_end`";s=o,e===orientations.VERTICAL?(t.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:"height",constant:0,multiplier:1,priority:1e3}),t.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:.1,multiplier:1,priority:1e3}),t.push({view1:i,attr1:"right",relation:"equ",view2:null,attr2:"right",constant:-s,multiplier:1,priority:1e3})):e===orientations.HORIZONTAL&&(t.push({view1:i,attr1:"width",relation:"equ",view2:null,attr2:"width",constant:0,multiplier:1,priority:1e3}),t.push({view1:i,attr1:"height",relation:"equ",view2:null,attr2:AutoLayout.Attribute.NOTANATTRIBUTE,constant:.1,multiplier:1,priority:1e3}),t.push({view1:i,attr1:"bottom",relation:"equ",view2:null,attr2:"bottom",constant:-s,multiplier:1,priority:1e3}))}},IncludedView.prototype.calculateWrapContentSizes=function(t){this.wrapWidth=300,this.wrapHeight=320},Scanner.prototype.scan=function(){let t=this.input,e=[];this.tokens.sort(function(t,e){return e.length-t.length});for(let i=0;i<t.length;i++)for(let n=0;n<this.tokens.length;n++){let r=this.tokens[n],o=r.length;if(o>0&&i+o<=t.length&&t.substring(i,i+o)===r){0!==i&&(e[e.length]=t.substring(0,i)),this.includeTokensInOutput&&(e[e.length]=r),t=t.substring(i+o),i=-1;break}}return 0!==t.length&&(e[e.length]=t),e},StringBuffer.prototype.append=function(t){return this.dataArray.push(t),this},StringBuffer.prototype.toString=function(){return this.dataArray.join("")},StringBuffer.prototype.length=function(){return this.dataArray.length},StringBuffer.prototype.reset=function(){return this.dataArray.length=0,this};let cloneText=function(t){if(t&&"string"==typeof t)return(" "+t).slice(1);throw Error("Invalid text supplied.")};function startsWith(t,e){if("string"!=typeof t||"string"!=typeof e)return!1;{let i=t.length,n=e.length;return i===n?t===e:!(i<n)&&0===t.indexOf(e,0)}}function endsWith(t,e){if("string"!=typeof t||"string"!=typeof e)return!1;{let i=t.length,n=e.length;return i===n?t===e:!(i<n)&&t.lastIndexOf(e)===i-n}}function contain(t,e){if("string"!=typeof t||"string"!=typeof e)return!1;{let i=t.length,n=e.length;return i===n?t===e:!(i<n)&&-1!==t.indexOf(e,0)}}function endsWithAnyOf(t,e){for(var i=e.length,n=0;n<i;n++)if(endsWith(t,e[n]))return!0;return!1}function indexOfEnder(t,e){for(var i=e.length,n=0;n<i;n++)if(endsWith(t,e[n]))return n;return -1}function startsWithAnyOf(t,e){for(var i=e.length,n=0;n<i;n++)if(startsWith(t,e[n]))return!0;return!1}function indexOfStarter(t,e){for(var i=e.length,n=0;n<i;n++)if(startsWith(t,e[n]))return n;return -1}function containsAnyOf(t,e){let i=e.length;for(let n=0;n<i;n++)if(contain(t,e[n]))return!0;return!1}function reverse(t){for(var e=t.length,i="",n=e-1;n>=0;n--)i+=t.charAt(n);return i}function isWhiteSpacesOnly(t){return null===t||!t||!/\S/.test(t)}function isEmpty(t){return!t||!/\S/.test(t)}let isNumber=function(t){return null!==t&&""!==t&&!1===isNaN(t)};function isOneDimArray(t){return"[object Array]"===Object.prototype.toString.call(t)}function addClass(t,e){t&&e&&t.classList.add(e)}function removeClass(t,e){t&&e&&t.classList.remove(e)}function isDomEntity(t){return"object"==typeof t&&void 0!==t.nodeType}const attrKeys={id:"id",layout:"layout",layout_width:"w",layout_height:"h",layout_maxWidth:"maxW",layout_maxHeight:"maxH",layout_minWidth:"minW",layout_minHeight:"minH",layout_margin:"m",layout_marginStart:"ms",layout_marginEnd:"me",layout_marginTop:"mt",layout_marginBottom:"mb",layout_marginHorizontal:"mh",layout_marginVertical:"mv",layout_constraintTop_toTopOf:"tt",layout_constraintBottom_toBottomOf:"bb",layout_constraintStart_toStartOf:"ss",layout_constraintEnd_toEndOf:"ee",layout_constraintTop_toBottomOf:"tb",layout_constraintStart_toEndOf:"se",layout_constraintEnd_toStartOf:"es",layout_constraintBottom_toTopOf:"bt",layout_constraintCenterXAlign:"cx",layout_constraintCenterYAlign:"cy",layout_constraintStart_toCenterX:"scx",layout_constraintCenterX_toStart:"cxs",layout_constraintEnd_toCenterX:"ecx",layout_constraintCenterX_toEnd:"cxe",layout_constraintTop_toCenterY:"tcy",layout_constraintCenterY_toTop:"cyt",layout_constraintBottom_toCenterY:"bcy",layout_constraintCenterY_toBottom:"cyb",layout_constraint:"data-const",layout_constraintGuide:"data-guide",layout_constraintGuideColor:"data-guide-color",layout_popup:"popup",layout_menuLeft:"menu-left",layout_menuRight:"menu-right",layout_src:"src",layout_constraintGuide_percent:"guide-pct",layout_constraintGuide_begin:"guide-begin",layout_constraintGuide_end:"guide-end",layout_horizontalBias:"hor-bias",layout_verticalBias:"ver-bias",dimension_ratio:"dim-ratio",orientation:"orient",customType:"custom-widget",customTypeLabel:"label",customTypeTabView:"tabview",mi_gravity:"mi-gravity",mi_border_radius:"mi-border-radius",mi_padding:"mi-padding",mi_line_spacing:"mi-line-spacing",mi_text:"mi-text",mi_useAutoBg:"mi-use-bg",mi_mode:"mi-mode",mi_fontStyle:"mi-font-st",mi_fontName:"mi-font-nm",mi_fontWeight:"mi-font-wt",mi_fontSize:"mi-font-sz",mi_shapesDensity:"mi-shapes-density",mi_singleLine:"mi-single-line",mi_opacity:"mi-opacity",mi_fg:"mi-fg",mi_bg:"mi-bg",mi_opaqueBg:"mi-opq-bg",mi_strokeWidth:"mi-sw",mi_minSize:"mi-min-sz",mi_numShapes:"mi-num-shapes",mi_textOnly:"mi-text-only",mi_textArray:"mi-text-arr",mi_cacheAfterDraw:"mi-cache-image"},sizes={MATCH_PARENT:"match_parent",WRAP_CONTENT:"wrap_content"},orientations={VERTICAL:"vertical",HORIZONTAL:"horizontal",GRID:"grid"},CssSizeUnits={VMAX:"vmax",VMIN:"vmin",REM:"rem",EM:"em",PT:"pt",PX:"px",CM:"cm",IN:"in",MM:"mm",VM:"vm",VH:"vh",VW:"vw",PC:"pc",EX:"ex",CH:"ch",GD:"gd",PCT:"%",Q:"q"},CssSizeUnitsValues=getObjectValues(CssSizeUnits).sort(function(t,e){return e.length-t.length});function getObjectValues(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(t[i]);return e}function StyleElement(t,e){if("string"==typeof t&&"string"==typeof e)this.attr=t.trim(),this.value=e.trim();else throw Error("attr or value must be string...`attr` = "+t+", `value` = "+e)}function Style(t,e){if(e||(e=[]),!isOneDimArray(e))throw Error("One dimensional array of style elements expected");this.name=t.trim(),this.styleElements=e}function injectStyleSheets(t,e){if("[object Array]"===Object.prototype.toString.call(e)){let i=new StringBuffer("");i.append(t.innerHTML);for(let n=0;n<e.length;n++){let r=e[n];if("Style"!==r.constructor.name)throw Error("Please put only styles in the supplied array");if(void 0===r.name||null===r.name||""===r.name)throw"Please define the name of this style!... e.g #name or .name";i.append(r.styleSheetEntry(r.name)),i.append("\n")}t.innerHTML=i.toString(),document.getElementsByTagName("head")[0].appendChild(t)}else throw Error("Please supply an array of styles")}function indexOfSelector(t,e){let i=t.innerHTML,n=new Scanner(i,!0,["{","}"]).scan();for(let r=0;r<n.length;r++)if("{"===n[r]&&r-1>=0&&e.trim()===n[r-1].trim())return r-1;return -1}function sheetContainsSelector(t,e){return -1!==indexOfSelector(t.innerHTML,e)}function getAllStyles(t){let e=t.innerHTML,i=new Scanner(e,!0,["{","}",";"]).scan();for(let n=0;n<i.length;n++)";"===i[n]&&n+1<i.length&&!1===startsWith(i[n+1],"\n")&&(i[n-1]=i[n-1]+i[n]+i[n+1],i.splice(n,1),i.splice(n,1));let r=[];for(let o=0;o<i.length;o++){if("{"===i[o]&&o-1>=0){let s=i[o-1].trim(),l=new Style(s,[]);r.push(l)}";"===i[o]&&r[r.length-1].addStyleElementCss(i[o-1]+";")}return r}function getStyle(t,e){if(e)e=e.trim();else throw Error("No selector supplied!");let i=t.innerHTML,n=new Scanner(i,!0,[e,"{","}",";"]).scan(),r=!1,o;for(let s=0;s<n.length;s++){if(n[s].trim()===e&&s+1<n.length){let l=s+1;for(;"{"!==n[l]&&l<n.length;){if(""!==n[l].trim())throw Error("Invalid token found in browser style sheet! File a bug report with browser manufacturer!! Description:\n                  No token like: ``"+n[l]+"`` should exist between ``"+e+"`` and a ``{``");l++}o=new Style(e,[]),r=!0,s=l}if(!0===r){if(";"===n[s])o.addStyleElementCss(n[s-1]+";");else if("}"===n[s])return o}}return null}function editSelectorInStyleSheet(t,e){if("Style"===e.constructor.name){let i=e.name,n=getAllStyles(t),r=!1;for(let o=0;o<n.length;o++){let s=n[o];if(s.name.trim()===i){r=!0;for(let l=0;l<e.styleElements.length;l++){let u=e.styleElements[l];s.addStyleElement(u.attr,u.value,!1)}break}}return r||n.push(e),t.innerHTML="",injectStyleSheets(t,n),!0}throw Error("Invalid style object supplied")}function updateOrCreateSelectorInStyleSheet(t,e){if("Style"===e.constructor.name){let i=e.name,n=getAllStyles(t),r=!1;for(let o=0;o<n.length;o++){let s=n[o];s.name.trim()===i&&(r=!0,s.styleElements=e.styleElements)}return r||n.push(e),t.innerHTML="",injectStyleSheets(t,n),!0}throw Error("Invalid style object supplied")}function updateOrCreateSelectorsInStyleSheet(t,e){if(!isOneDimArray(e))throw Error("A one dimensional array expected for `newStyles`");let i=getAllStyles(t);for(let n=0;n<e.length;n++){let r=e[n];if("Style"===r.constructor.name){let o=r.name,s=!1;for(let l=0;l<i.length;l++){let u=i[l];u.name.trim()===o&&(s=!0,u.styleElements=r.styleElements)}s||i.push(r)}else throw Error("Invalid style object supplied")}t.innerHTML="",injectStyleSheets(t,i)}function getScrollBarWidth(){var t=document.createElement("div");t.style.visibility="hidden",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t);var e=document.createElement("div");t.appendChild(e);var i=t.offsetWidth-e.offsetWidth;return t.parentNode.removeChild(t),i}function parseNumberAndUnitsNoValidation(t,e){if("number"==typeof t&&(t+=""),"string"!=typeof t)return{number:null,units:null};if(isNumber(t))return e&&!0===e?{number:t,units:"px"}:{number:null,units:null};let i="",n=t.length-1;for(;n>=0;n--){let r=t.substring(n,n+1);if("0"!==r&&"1"!==r&&"2"!==r&&"3"!==r&&"4"!==r&&"5"!==r&&"6"!==r&&"7"!==r&&"8"!==r&&"9"!==r);else{i=t.substring(0,n+1);break}}let o=t.substring(n+1);return -1!==CssSizeUnitsValues.indexOf(o)&&isNumber(i)?{number:i,units:o}:{number:null,units:null}}function parseNumberAndUnits(t,e){if("string"!=typeof t)throw Error("parses only string input");if(e&&!0===e&&isNumber(t)&&(t+="px"),isNumber(t)){if(e&&!0===e)return{number:t,units:"px"};throw"No units specified for number: "+t}let i="",n=t.length-1;for(;n>=0;n--){let r=t.substring(n,n+1);if("0"!==r&&"1"!==r&&"2"!==r&&"3"!==r&&"4"!==r&&"5"!==r&&"6"!==r&&"7"!==r&&"8"!==r&&"9"!==r);else{i=t.substring(0,n+1);break}}let o=t.substring(n+1);if(-1===CssSizeUnitsValues.indexOf(o))throw Error("This unit is not a valid css unit.. Use one of:\n "+CssSizeUnitsValues);if(!isNumber(i))throw Error("The number is not a valid number!..."+i);return{number:i,units:o}}function getUrls(){let t=document.getElementsByTagName("script");for(let e=0;e<t.length;e++){let i=t[e].src,n="layman-extra.js",r=i.length,o=n.length;if(i.lastIndexOf(n)===r-o){scriptURL=i.substring(0,r-o),projectURL=window.location.href;let s=0;for(;projectURL.charAt(s)===scriptURL.charAt(s);)s+=1;return[projectURL=projectURL.substring(0,s),scriptURL]}}return null}StyleElement.prototype.setAttr=function(t){this.attr=t},StyleElement.prototype.getAttr=function(){return this.attr},StyleElement.prototype.setValue=function(t){this.value=t},StyleElement.prototype.getValue=function(){return this.value},StyleElement.prototype.getCss=function(){return this.attr+":"+this.value+";"},Style.prototype.setName=function(t){this.name=t},Style.prototype.getName=function(){return this.name},Style.prototype.setStyleElements=function(t){this.styleElements=t},Style.prototype.getStyleElements=function(){return this.styleElements},Style.prototype.isEmpty=function(){return 0===this.styleElements.length},Style.prototype.styleSheetEntry=function(t){this.name=t;let e=new StringBuffer;if(0===this.styleElements.length)return"";e.append(t).append(" { \n");for(let i=0;i<this.styleElements.length;i++){let n=this.styleElements[i];e.append(n.getCss()).append("\n")}return e.append("} \n"),e.toString()},Style.prototype.injectStyleSheet=function(){if(void 0===this.name||null===this.name||""===this.name)throw"Please define the name of this style!... e.g #name or .name";let t=document.createElement("style");this.styleElements.length>0&&(t.setAttribute("type","text/css"),t.innerHTML=this.styleSheetEntry(this.name),document.getElementsByTagName("head")[0].appendChild(t))},Style.prototype.toOptions=function(){let t={};for(let e=0;e<this.styleElements.length;e++){let i=getObjectValues(this.styleElements[e]);t[i[0]]=i[1]}return t},Style.prototype.addFromOptions=function(t){for(let e in t)this.addStyleElement(e,t[e])},Style.prototype.getCss=function(){let t=new StringBuffer;if(0===this.styleElements.length)return"";t.append(" style = '");for(let e=0;e<this.styleElements.length;e++){let i=this.styleElements[e];t.append(i.getCss())}return t.append("' "),t.toString()},Style.prototype.rawCss=function(){let t=new StringBuffer;if(0===this.styleElements.length)return"";t.append(" ");for(let e=0;e<this.styleElements.length;e++){let i=this.styleElements[e];t.append(i.getCss())}return t.append(" "),t.toString()},Style.prototype.applyInline=function(t){if(t){if(isDomEntity(t))for(let e=0;e<this.styleElements.length;e++){let i=this.styleElements[e];t.style[i.attr]=i.value}else throw Error("Invalid html element: "+t)}else throw Error("Please specify an html element.")},Style.prototype.removeStyleElementObj=function(t){if(StyleElement.prototype.isPrototypeOf(t)){let e=t.getAttr();for(let i=0;i<this.styleElements.length;i++)if(this.styleElements[i].getAttr()===e){this.styleElements.splice(i,1);return}}},Style.prototype.removeStyleElementByAttr=function(t){for(let e=0;e<this.styleElements.length;e++)if(this.styleElements[e].getAttr()===t){this.styleElements.splice(e,1);return}},Style.prototype.addStyleElement=function(t,e,i){if(i)this.styleElements.push(new StyleElement(t,e));else{for(let n=0;n<this.styleElements.length;n++)if(this.styleElements[n].getAttr()===t){this.styleElements[n]=new StyleElement(t,e);return}this.styleElements.push(new StyleElement(t,e))}},Style.prototype.addStyleElementsArray=function(t,e){for(let i=0;i<t.length;i++){let n=t[i];this.addStyleElementObj(n,e)}},Style.prototype.addStyleElementObj=function(t,e){if(StyleElement.prototype.isPrototypeOf(t)){if(e)this.styleElements.push(t);else{let i=t.getAttr();for(let n=0;n<this.styleElements.length;n++)if(this.styleElements[n].getAttr()===i){this.styleElements[n]=t;return}this.styleElements.push(t)}}else throw Error("Invalid Style specified.")},Style.prototype.clone=function(t){let e=[];for(let i=0;i<this.styleElements.length;i++){let n=this.styleElements[i];e.push(new StyleElement(n.attr,n.value))}return t||(t=this.name),new Style(t,e)},Style.prototype.addStyleElementCss=function(t,e){if(t){let i=!0===contain(t=t.trim(),"url"),n=t.indexOf(":"),r=i?t.lastIndexOf(";"):t.indexOf(";");if(-1!==r&&r===t.length-1&&-1!==n){let o=t.substring(0,n),s=t.substring(n+1,r);if(-1===o.indexOf(":")&&-1===o.indexOf(";")&&(-1===s.indexOf("url")&&-1===s.indexOf(":")&&-1===s.indexOf(";")||"-1"!==s.indexOf("url"))){let l=new StyleElement(o,s);if(e)this.styleElements.push(l);else{for(let u=0;u<this.styleElements.length;u++)if(this.styleElements[u].getAttr()===o){this.styleElements[u]=l;return}this.styleElements.push(l)}}else throw Error("Weird css line expression____!"+t)}else throw Error("Invalid css line expression!..."+t)}else throw Error("No css line supplied!")},Style.prototype.getValue=function(t){for(let e=0;e<this.styleElements.length;e++){let i=this.styleElements[e];if(i.attr===t)return i.value}return null};const SideMenuTypes={LEFT:"left",RIGHT:"right"};function SideMenuX(t){if(!t)throw Error("Please supply the options for creating the menu.");if(this.id="","string"==typeof t.id)this.id=t.id;else throw Error("Please supply the id of the menu");if(this.width=-1,this.parsedWidth=-1,"number"==typeof t.width)this.width=t.width+"px";else if("string"==typeof t.width){if(isNumber(parseInt(t.width)))this.width=t.width;else throw"invalid value specified for width!"}else throw Error('Please supply the width of the menu.. e.g. `width:"300px"` or `width:"30%"`');if(this.menuType=SideMenuTypes.LEFT,t.menuType){if(t.menuType===SideMenuTypes.LEFT||t.menuType===SideMenuTypes.RIGHT)this.menuType=t.menuType;else throw Error("Invalid menu type specified! Use either of `"+SideMenuTypes.PUSH+"` or `"+SideMenuTypes.OVERLAY+"`")}if(this.layout="","string"==typeof t.layout)this.layout=t.layout;else throw Error("Please supply the name of the xml layout");this.background="#fff",t.background&&(this.background=t.background),this.registry={};var e=document.body,i=document.documentElement;e.scrollWidth,e.offsetWidth,i.clientWidth,i.scrollWidth,i.offsetWidth;let n=Math.max(e.scrollHeight,e.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);this.overlayStyle=new Style("."+this.overlayClass(),[]),this.frameStyle=new Style("."+this.containerClass(),[]),this.closeBtnStyle=new Style("."+this.closeBtnClass(),[]),this.noScrollStyle=new Style(".noscroll",[]);let r=2e3;this.overlayStyle.addFromOptions({display:"block",visibility:"visible",opacity:"0.8",position:"fixed","background-color":"black",top:"0",left:"0",bottom:"0",right:"0","z-index":r+""}),this.noScrollStyle.addFromOptions({overflow:"hidden"});initFrameCss:{r+=10;let o={width:this.width,height:n+"px",position:"fixed",top:"0",left:"0",padding:"0","z-index":r+"","background-color":this.background,"overflow-x":"hidden","overflow-y":"auto",transition:"0.5s"};o[this.menuType]="0",this.frameStyle.addFromOptions(o)}initCloseBtnStyle:{let s={top:"12px",position:"fixed","font-size":"8em","font-weight":"bold","font-family":"monospace",cursor:"pointer",color:"white","background-color":"transparent",border:"none",padding:"none"};this.menuType===SideMenuTypes.LEFT?s[SideMenuTypes.RIGHT]="18px":s[SideMenuTypes.LEFT]="18px",this.closeBtnStyle.addFromOptions(s)}this.onOpen=function(){},t.onOpen&&"[object Function]"===({}).toString.call(t.onOpen)?this.onOpen=t.onOpen:this.onOpen=function(){},this.onClose=function(){},t.onClose&&"[object Function]"===({}).toString.call(t.onClose)?this.onClose=t.onClose:this.onClose=function(){},this.registerStyle(this.overlayStyle),this.registerStyle(this.noScrollStyle),this.registerStyle(this.frameStyle),this.registerStyle(this.closeBtnStyle),this.rootView=null,this.shouldOpen=!1}SideMenuX.prototype.registerStyle=function(t){this.registry[t.name]=t},SideMenuX.prototype.hide=function(){var t=document.getElementById(this.overlayId()),e=document.getElementById(this.containerId());return t&&(t.style.display="none"),e&&this.closeMenu(),removeClass(document.body,this.noScrollStyle.name.substring(1)),this.onClose(),this},SideMenuX.prototype.open=function(){return this.shouldOpen=!0,this.build(),this.openMenu(),this},SideMenuX.prototype.build=function(){var t=this;let e=!1;var i=document.getElementById(this.overlayId()),n=document.getElementById(this.containerId());i||(e=!0,(i=document.createElement("div")).setAttribute("id",this.overlayId()),addClass(i,this.overlayClass()),document.body.appendChild(i)),i.style.display="block",i.onclick=function(){t.hide()},n||((n=document.createElement("div")).setAttribute("id",this.containerId()),addClass(n,this.containerClass()),n.innerHTML=this.layout.trim(),document.body.appendChild(n));let r=document.getElementById(this.closeBtnId());if(r||((r=document.createElement("input")).setAttribute("id",this.closeBtnId()),addClass(r,this.closeBtnClass()),r.setAttribute("type","button"),r.value="˟",i.appendChild(r)),r.onclick=function(){t.hide()},e){let o=document.createElement("style");o.setAttribute("type","text/css");let s=new StringBuffer;for(var l in this.registry)s.append(this.registry[l].styleSheetEntry(l));o.innerHTML=s.toString(),document.getElementsByTagName("head")[0].appendChild(o);let u=new Page(n);u.layout(),page.subPages.set(n.id,u),t.openMenu(),t.rootView=n,t.parsedWidth=parseInt(window.getComputedStyle(n).width),this.shouldOpen||(n.style.visibility="hidden",i.style.visibility="hidden",this.hide(),setTimeout(function(){n.style.visibility="visible",i.style.visibility="visible"},200))}return this.addDragEvents(i,n),this},SideMenuX.prototype.addDragEvents=function(t,e){let i=this,n=!0;e.onmousemove=function(t){},e.onmousedown=function(t){((t=window.event||t).target===this||t.target===i.rootView)&&(n=!0,e.onmousemove=function(t){((t=window.event||t).target===this||t.target===i.rootView)&&!0===n&&t.pageX<i.parsedWidth&&(e.style.width=t.pageX+2+"px",e.style.transition="0.5s")},e.onmouseup=function(t){((t=window.event||t).target===this||t.target===i.rootView)&&(n=!1,e.style.transition="0.5s",e.onmousemove=function(t){},t.pageX<i.parsedWidth/3?i.hide():i.openMenu())})},t.onmouseup=function(t){t.preventDefault(),n=!1},t.onmousemove=function(t){((ev=window.event||ev).target===this||ev.target===i.rootView)&&!0===n&&(ev.pageX<i.parsedWidth?(e.style.width=ev.pageX+2+"px",e.style.transition="0.5s"):ev.pageX>=i.parsedWidth+80&&(e.style.width=i.parsedWidth+"px"))}},SideMenuX.prototype.containerClass=function(){return this.id+"_side_menux_frame_class"},SideMenuX.prototype.overlayClass=function(){return this.id+"_side_menux_overlay_class"},SideMenuX.prototype.overlayId=function(){return this.id+"_side_menux_overlay_id"},SideMenuX.prototype.closeBtnClass=function(){return this.id+"_side_menux_close_btn_class"},SideMenuX.prototype.closeBtnId=function(){return this.id+"_side_menux_close_btn_class"},SideMenuX.prototype.containerId=function(){return this.id},SideMenuX.prototype.openMenu=function(){document.getElementById(this.containerId()).style.width=this.width,addClass(document.body,this.noScrollStyle.name.substring(1)),this.onOpen()},SideMenuX.prototype.closeMenu=function(){document.getElementById(this.containerId()).style.width="0"};var popupZIndex=1e3;function Popup(t){if(!t)throw Error("No options specified for creating this popup");if(!t.id||"string"!=typeof t.id)throw Error("Hi! You have not specified a value for options.layitId! Popup cannot be created");if(this.id=t.id,"string"!=typeof t.width&&(console.log("Hi! options.width must be a valid css dimension! Defaulting to 90%"),t.width="90%"),t.width||(t.width="90%"),"string"!=typeof t.height&&(console.log("Hi! options.height must be a valid css dimension!  Defaulting to 90%"),t.height="90%"),t.height||(t.height="90%"),t.bg&&"string"==typeof t.bg?this.background=t.bg:(console.log("Hi! options.bg must be a valid html color!  defaulting to white"),this.background="#ffffff"),this.layout="","string"==typeof t.layout)this.layout=t.layout;else throw Error("Please supply the name of the xml layout");this.closeOnClickOutside=!0,"boolean"==typeof t.closeOnClickOutside&&(this.closeOnClickOutside=t.closeOnClickOutside),t.onOpen&&"[object Function]"===({}).toString.call(t.onOpen)?this.onOpen=t.onOpen:this.onOpen=function(){},t.onClose&&"[object Function]"===({}).toString.call(t.onClose)?this.onClose=t.onClose:this.onClose=function(){},this.registry={};var e=document.body,i=document.documentElement;let n=Math.max(e.scrollWidth,e.offsetWidth,i.clientWidth,i.scrollWidth,i.offsetWidth),r=Math.max(e.scrollHeight,e.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);this.opaqueBgStyle=new Style("#"+this.overlayId(),[]),this.containerStyle=new Style("#"+this.containerId(),[]),this.noScrollStyle=new Style(".noscroll",[]),this.closeBtnStyle=new Style("#"+this.closeBtnId(),[]),popupZIndex+=10,this.opaqueBgStyle.addFromOptions({display:"block",visibility:"visible",opacity:"0.8",position:"fixed","background-color":"black",top:"0",left:"0",bottom:"0",right:"0","z-index":popupZIndex+"",width:n+"px",height:r+"px"}),this.noScrollStyle.addFromOptions({overflow:"hidden"}),this.width=t.width,this.height=t.height;var o=this.width,s=this.height,l=this.background;if(this.containerStyle.addFromOptions({position:"absolute",left:"calc(50% - "+o+" / 2 )",top:"calc(50% - "+s+" / 2 )",visibility:"visible",display:"block",padding:"0px",margin:"0px",overflow:"auto",width:o,height:s,"background-color":l,"z-index":popupZIndex+1+"","border-radius":"0.3em"}),"object"==typeof t.containerStyle){var u=t.containerStyle;for(var h in u)this.containerStyle.addStyleElement(h,u[h])}this.closeBtnStyle.addFromOptions({top:"0.1em",right:"0.1em",position:"fixed","font-size":"6rem","font-weight":"bold","font-family":"monospace",cursor:"pointer",color:"white","background-color":"transparent",border:"none",padding:"none"}),this.registerStyle(this.opaqueBgStyle),this.registerStyle(this.containerStyle),this.registerStyle(this.closeBtnStyle),this.registerStyle(this.noScrollStyle)}"use strict";function Point(t,e){this.x=t,this.y=e}function FloatPoint(t,e,i){Point.call(this,t,e),this.z=i}function midPoint(t,e){return t&&"Point"===t.constructor.name&&e&&"Point"===e.constructor.name?new Point(.5*(t.x+e.x),.5*(t.y+e.y)):null}function midPointF(t,e){return t&&"FloatPoint"===t.constructor.name&&e&&"FloatPoint"===e.constructor.name?new FloatPoint(.5*(t.x+e.x),.5*(t.y+e.y),.5*(t.z+e.z)):null}function Line(t,e){return t&&"FloatPoint"===t.constructor.name&&e&&"FloatPoint"===e.constructor.name&&(this.m=t.findXYGrad(e),this.c=t.y-this.m*t.x),null}function approxEquals(t,e,i){return i||(i=1e-14),"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&Math.abs(Math.abs(t)-Math.abs(e))<=Math.abs(i)}function Dimension(t,e){"number"==typeof t&&"number"==typeof e?(this.width=t,this.height=e):(this.width=0,this.height=0)}function Quadratic(t,e,i){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&(this.a=t,this.b=e,this.c=i)}function Rectangle(t,e,i,n){this.width=this.height=this.left=this.top=0,"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&(this.left=t,this.top=e,this.width=i-t,this.height=n-e)}function EllipseModel(t,e,i){t&&"FloatPoint"===t.constructor.name&&"number"==typeof e&&"number"==typeof i?(this.center=t,this.size=new Dimension(e,i)):(this.center=new FloatPoint(0,0,0),this.size=new Dimension(0,0)),new Rect}function componentToHex(t){var e=t.toString(16);return 1===e.length?"0"+e:e}function rgbToHEX(t,e,i){return"#"+componentToHex(t)+componentToHex(e)+componentToHex(i)}function hexToRGB(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,n){return e+e+i+i+n+n});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16),a:1}:null}function getRGB(t){if(!t)throw"supply a color";if(0!==(t=t.toLowerCase().trim()).indexOf("rgb"))return hexToRGB(t);var e=t.indexOf("("),i=t.indexOf(")");if(-1===e||-1===i)throw"invalid rgb|rgba color";return 3===(t=t.substring(e+1,i).split(",")).length?{r:parseInt(t[0]),g:parseInt(t[1]),b:parseInt(t[2]),a:1}:{r:parseInt(t[0]),g:parseInt(t[1]),b:parseInt(t[2]),a:parseFloat(t[3])}}function randomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}function Random(){}function oneDegInRads(){return Math.PI/180}function angDegToRads(t){return t*Math.PI/180}function angRadToDegs(t){return 180*t/Math.PI}function equals(t,e){return 1e-10>=Math.abs(Math.abs(t)-Math.abs(e))}function dragElement(t){var e=0,i=0,n=0,r=0;function o(t){(t=t||window.event).preventDefault(),n=t.clientX,r=t.clientY,document.onmouseup=l,document.onmousemove=s}function s(o){(o=o||window.event).preventDefault(),e=n-o.clientX,i=r-o.clientY,n=o.clientX,r=o.clientY,t.style.top=t.offsetTop-i+"px",t.style.left=t.offsetLeft-e+"px"}function l(){document.onmouseup=null,document.onmousemove=null}document.getElementById(t.id+"header")?document.getElementById(t.id+"header").onmousedown=o:t.onmousedown=o}Popup.prototype.registerStyle=function(t){this.registry[t.name]=t},Popup.prototype.hide=function(){var t=document.getElementById(this.overlayId()),e=document.getElementById(this.containerId());return t&&(t.style.display="none"),e&&(e.style.display="none"),removeClass(document.body,this.noScrollStyle.name.substring(1)),this.onClose(),this},Popup.prototype.open=function(){return this.build(),this},Popup.prototype.build=function(){var t=this;let e=!1;var i=document.getElementById(this.overlayId()),n=document.getElementById(this.containerId());i||(e=!0,(i=document.createElement("div")).setAttribute("id",this.overlayId()),addClass(i,this.overlayClass()),document.body.appendChild(i)),i.style.display="block",i.onclick=function(){t.closeOnClickOutside&&t.hide()},n?n.style.display="block":((n=document.createElement("div")).setAttribute("id",this.containerId()),addClass(n,this.containerClass()),n.innerHTML=this.layout,document.body.appendChild(n));let r=document.getElementById(this.closeBtnId());if(r||((r=document.createElement("input")).setAttribute("id",this.closeBtnId()),addClass(r,this.closeBtnClass()),r.type="button",r.value="˟",i.appendChild(r)),r.onclick=function(){t.hide()},e){var o=document.createElement("style");o.setAttribute("type","text/css");var s=new StringBuffer;for(var l in this.registry)s.append(this.registry[l].styleSheetEntry(l));o.innerHTML=s.toString(),document.getElementsByTagName("head")[0].appendChild(o);let u=new Page(n);u.layout(),page.subPages.set(n.id,u)}return addClass(document.body,this.noScrollStyle.name.substring(1)),t.onOpen(),this},Popup.prototype.overlayId=function(){return this.id+"_main_overlay"},Popup.prototype.overlayClass=function(){return this.id+"_main_overlay_class"},Popup.prototype.containerId=function(){return this.id},Popup.prototype.containerClass=function(){return this.id+"_container_class"},Popup.prototype.closeBtnClass=function(){return this.id+"_close_btn_class"},Popup.prototype.closeBtnId=function(){return this.id+"_close_btn_class"},function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.ResizeSensor=e()}("undefined"!=typeof window?window:this,function(){if("undefined"==typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},i=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||function(e){t.clearTimeout(e)};function n(t,e){var i=Object.prototype.toString.call(t),n="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,r=0,o=t.length;if(n)for(;r<o;r++)e(t[r]);else e(t)}function r(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}function o(t,e){Object.keys(e).forEach(function(i){t.style[i]=e[i]})}var s=function(t,l){var u=0;function h(){var t,e,i=[];this.add=function(t){i.push(t)},this.call=function(n){for(t=0,e=i.length;t<e;t++)i[t].call(this,n)},this.remove=function(n){var r=[];for(t=0,e=i.length;t<e;t++)i[t]!==n&&r.push(i[t]);i=r},this.length=function(){return i.length}}n(t,function(t){!function t(i,n){if(i){if(i.resizedAttached){i.resizedAttached.add(n);return}i.resizedAttached=new h,i.resizedAttached.add(n),i.resizeSensor=document.createElement("div"),i.resizeSensor.dir="ltr",i.resizeSensor.className="resize-sensor";var s={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},l={position:"absolute",left:"0px",top:"0px",transition:"0s"};o(i.resizeSensor,s);var c=document.createElement("div");c.className="resize-sensor-expand",o(c,s);var p=document.createElement("div");o(p,l),c.appendChild(p);var d=document.createElement("div");d.className="resize-sensor-shrink",o(d,s);var f=document.createElement("div");o(f,l),o(f,{width:"200%",height:"200%"}),d.appendChild(f),i.resizeSensor.appendChild(c),i.resizeSensor.appendChild(d),i.appendChild(i.resizeSensor);var g=window.getComputedStyle(i),m=g?g.getPropertyValue("position"):null;"absolute"!==m&&"relative"!==m&&"fixed"!==m&&"sticky"!==m&&(i.style.position="relative");var $=!1,v=0,_=r(i),E=0,A=0,T=!0;u=0;var S=function(){var t=i.offsetWidth,e=i.offsetHeight;p.style.width=t+10+"px",p.style.height=e+10+"px",c.scrollLeft=t+10,c.scrollTop=e+10,d.scrollLeft=t+10,d.scrollTop=e+10},C=function(){if(T){if(0===i.offsetWidth&&0===i.offsetHeight){u||(u=e(function(){u=0,C()}));return}T=!1}S()};i.resizeSensor.resetSensor=C;var I=function(){v=0,$&&(E=_.width,A=_.height,i.resizedAttached&&i.resizedAttached.call(_))},R=function(){($=(_=r(i)).width!==E||_.height!==A)&&!v&&(v=e(I)),C()},O=function(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i)};O(c,"scroll",R),O(d,"scroll",R),u=e(function(){u=0,C()})}}(t,l)}),this.detach=function(e){u&&(i(u),u=0),s.detach(t,e)},this.reset=function(){t.resizeSensor.resetSensor&&t.resizeSensor.resetSensor()}};if(s.reset=function(t){n(t,function(e){t.resizeSensor.resetSensor&&e.resizeSensor.resetSensor()})},s.detach=function(t,e){n(t,function(t){t&&!(t.resizedAttached&&"function"==typeof e&&(t.resizedAttached.remove(e),t.resizedAttached.length()))&&t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached)})},"undefined"!=typeof MutationObserver){var l=new MutationObserver(function(t){for(var e in t)if(t.hasOwnProperty(e))for(var i=t[e].addedNodes,n=0;n<i.length;n++)i[n].resizeSensor&&s.reset(i[n])});document.addEventListener("DOMContentLoaded",function(t){l.observe(document.body,{childList:!0,subtree:!0})})}return s}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.ULID={})}(this,function(t){"use strict";function e(t){var e=Error(t);return e.source="ulid",e}var i="0123456789ABCDEFGHJKMNPQRSTVWXYZ",n=i.length;function r(t,e,i){return e>t.length-1?t:t.substr(0,e)+i+t.substr(e+1)}function o(t){for(var o=void 0,s=t.length,l=void 0,u=void 0,h=n-1;!o&&s-- >=0;){if(l=t[s],-1===(u=i.indexOf(l)))throw e("incorrectly encoded string");if(u===h){t=r(t,s,i[0]);continue}o=r(t,s,i[u+1])}if("string"==typeof o)return o;throw e("cannot increment this string")}function s(t){var e=Math.floor(t()*n);return e===n&&(e=n-1),i.charAt(e)}function l(t,r){if(isNaN(t))throw Error(t+" must be a number");if(t>0xffffffffffff)throw e("cannot encode time greater than 281474976710655");if(t<0)throw e("time must be positive");if(!1===Number.isInteger(t))throw e("time must be an integer");for(var o=void 0,s="";r>0;r--)o=t%n,s=i.charAt(o)+s,t=(t-o)/n;return s}function u(t,e){for(var i="";t>0;t--)i=s(e)+i;return i}function h(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments[1];i||(i="undefined"!=typeof window?window:null);var n=i&&(i.crypto||i.msCrypto);if(n)return function(){var t=new Uint8Array(1);return n.getRandomValues(t),t[0]/255};try{var r=require("crypto");return function(){return r.randomBytes(1).readUInt8()/255}}catch(o){}if(t){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch(s){}return function(){return Math.random()}}throw e("secure crypto unusable, insecure Math.random not allowed")}function c(t){return t||(t=h()),function e(i){return isNaN(i)&&(i=Date.now()),l(i,10)+u(16,t)}}var p=c();t.replaceCharAt=r,t.incrementBase32=o,t.randomChar=s,t.encodeTime=l,t.encodeRandom=u,t.decodeTime=function t(r){if(26!==r.length)throw e("malformed ulid");var o=r.substr(0,10).split("").reverse().reduce(function(t,r,o){var s=i.indexOf(r);if(-1===s)throw e("invalid character found: "+r);return t+s*Math.pow(n,o)},0);if(o>0xffffffffffff)throw e("malformed ulid, timestamp too large");return o},t.detectPrng=h,t.factory=c,t.monotonicFactory=function t(e){e||(e=h());var i=0,n=void 0;return function t(r){if(isNaN(r)&&(r=Date.now()),r<=i){var s=n=o(n);return l(i,10)+s}i=r;var h=n=u(16,e);return l(r,10)+h}},t.ulid=p,Object.defineProperty(t,"__esModule",{value:!0})}),/**
 * AutoLayout.js is licensed under the MIT license. If a copy of the
 * MIT-license was not distributed with this file, You can obtain one at:
 * http://opensource.org/licenses/mit-license.html.
 * @link https://github.com/lume/autolayout
 *
 * @author: Hein Rutjes (IjzerenHein)
 * @license MIT
 * @copyright Gloey Apps, 2017
 *
 * @library autolayout.js
 * @version 0.7.0
 */ function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;(e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).AutoLayout=t()}}(function(){return(function t(e,i,n){function r(s,l){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var h=Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i;return r(e[s][1][t]||t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r})({1:[function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function r(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}var o=t("cassowary/bin/c"),s={CONST:"const",NOTANATTRIBUTE:"const",VARIABLE:"var",LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom",WIDTH:"width",HEIGHT:"height",CENTERX:"centerX",CENTERY:"centerY",ZINDEX:"zIndex"},l={LEQ:"leq",EQU:"equ",GEQ:"geq"},u=function(){function t(t,e,i,n,r,o){this.message=t,this.expected=e,this.found=i,this.offset=n,this.line=r,this.column=o,this.name="SyntaxError"}return function t(e,i){function n(){this.constructor=e}n.prototype=i.prototype,e.prototype=new n}(t,Error),{SyntaxError:t,parse:function e(i){var n,r=arguments.length>1?arguments[1]:{},o={},s={visualFormatString:Q},l=Q,u=o,h={type:"literal",value:":",description:'":"'},c={type:"literal",value:"H",description:'"H"'},p={type:"literal",value:"V",description:'"V"'},d={type:"literal",value:"|",description:'"|"'},f={type:"literal",value:"[",description:'"["'},g={type:"literal",value:"]",description:'"]"'},m={type:"literal",value:"-",description:'"-"'},$={type:"literal",value:"(",description:'"("'},v={type:"literal",value:",",description:'","'},_={type:"literal",value:")",description:'")"'},E={type:"literal",value:"@",description:'"@"'},A={type:"literal",value:"==",description:'"=="'},T={type:"literal",value:"<=",description:'"<="'},S={type:"literal",value:">=",description:'">="'},C=/^[0-9]/,I={type:"class",value:"[0-9]",description:"[0-9]"},R=/^[a-zA-Z_]/,O={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},P=/^[a-zA-Z0-9_]/,L={type:"class",value:"[a-zA-Z0-9_]",description:"[a-zA-Z0-9_]"},N={type:"literal",value:".",description:'"."'},V=0,B=0,D=0,W={line:1,column:1,seenCR:!1},q=0,M=[];if("startRule"in r){if(!(r.startRule in s))throw Error("Can't start parsing from rule \""+r.startRule+'".');l=s[r.startRule]}function k(){return i.substring(B,V)}function H(){return B}function U(){return j(B).line}function F(){return j(B).column}function G(t){throw Y(null,[{type:"other",description:t}],B)}function X(t){throw Y(t,null,B)}function j(t){return D!==t&&(D>t&&(D=0,W={line:1,column:1,seenCR:!1}),function t(e,n,r){var o,s;for(o=n;o<r;o++)"\n"===(s=i.charAt(o))?(!e.seenCR&&e.line++,e.column=1,e.seenCR=!1):"\r"===s||"\u2028"===s||"\u2029"===s?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(W,D,t),D=t),W}function K(t){!(V<q)&&(V>q&&(q=V,M=[]),M.push(t))}function Y(e,n,r){var o=j(r),s=r<i.length?i.charAt(r):null;return null!==n&&function t(e){var i=1;for(e.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});i<e.length;)e[i-1]===e[i]?e.splice(i,1):i++}(n),new t(null!==e?e:function t(e,i){var n,r,o,s=Array(e.length);for(o=0;o<e.length;o++)s[o]=e[o].description;return"Expected "+(n=e.length>1?s.slice(0,-1).join(", ")+" or "+s[e.length-1]:s[0])+" but "+(r=i?'"'+function t(e){function i(t){return t.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+i(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+i(t)}).replace(/[\u0180-\u0FFF]/g,function(t){return"\\u0"+i(t)}).replace(/[\u1080-\uFFFF]/g,function(t){return"\\u"+i(t)})}(i)+'"':"end of input")+" found."}(n,s),n,s,r,o.line,o.column)}function Q(){var t,e,n,r,s,l,d,f,g,m,$,v,_,E,A,T;if(t=V,e=V,(n=(E=V,72===i.charCodeAt(V)?(A="H",V++):(A=o,K(c)),A===o&&(86===i.charCodeAt(V)?(A="V",V++):(A=o,K(p))),A!==o&&(B=E,A="H"==(T=A)?"horizontal":"vertical"),A))!==o?(58===i.charCodeAt(V)?(r=":",V++):(r=o,K(h)),r!==o?e=n=[n,r]:(V=e,e=u)):(V=e,e=u),e===o&&(e=null),e!==o){if(n=V,(r=Z())!==o&&(s=tt())!==o?n=r=[r,s]:(V=n,n=u),n===o&&(n=null),n!==o){if((r=J())!==o){for(s=[],l=V,(d=tt())!==o&&(f=J())!==o?l=d=[d,f]:(V=l,l=u);l!==o;)s.push(l),l=V,(d=tt())!==o&&(f=J())!==o?l=d=[d,f]:(V=l,l=u);s!==o&&(l=V,(d=tt())!==o&&(f=Z())!==o?l=d=[d,f]:(V=l,l=u),l===o&&(l=null),l!==o)?(B=t,t=e=(g=e,m=n,$=r,v=s,_=l,{orientation:g?g[0]:"horizontal",cascade:(m||[]).concat([$],[].concat.apply([],v),_||[])})):(V=t,t=u)}else V=t,t=u}else V=t,t=u}else V=t,t=u;return t}function Z(){var t,e;return t=V,124===i.charCodeAt(V)?(e="|",V++):(e=o,K(d)),e!==o&&(B=t,e={view:null}),t=e}function J(){var t,e,n,r,s,l,h;return(t=V,91===i.charCodeAt(V)?(e="[",V++):(e=o,K(f)),e!==o&&(n=tn())!==o&&((r=te())===o&&(r=null),r!==o&&(93===i.charCodeAt(V)?(s="]",V++):(s=o,K(g)),s!==o)))?(B=t,t=e=(l=n,to(l,(h=r)?{constraints:h}:{}))):(V=t,t=u),t}function tt(){var t,e,n,r,s,l,h,c,p;if(t=V,45===i.charCodeAt(V)?(e="-",V++):(e=o,K(m)),e!==o){if((n=((l=(h=V,(c=tr())!==o&&(B=h,c=[{relation:"equ",constant:p=c,$parserOffset:B}]),c))===o&&(l=te()),l))!==o)(45===i.charCodeAt(V)?(r="-",V++):(r=o,K(m)),r!==o)?(B=t,t=e=s=n):(V=t,t=u);else V=t,t=u}else V=t,t=u;return t===o&&(t=V,45===i.charCodeAt(V)?(e="-",V++):(e=o,K(m)),e!==o&&(e=[{relation:"equ",constant:"default",$parserOffset:B=t}]),(t=e)===o&&(t=V,(e="")!==o&&(e=[{relation:"equ",constant:0,$parserOffset:B=t}]),t=e)),t}function te(){var t,e,n,r,s,l,h,c,p;if(t=V,40===i.charCodeAt(V)?(e="(",V++):(e=o,K($)),e!==o){if((n=ti())!==o){for(r=[],s=V,44===i.charCodeAt(V)?(l=",",V++):(l=o,K(v)),l!==o&&(h=ti())!==o?s=l=[l,h]:(V=s,s=u);s!==o;)r.push(s),s=V,44===i.charCodeAt(V)?(l=",",V++):(l=o,K(v)),l!==o&&(h=ti())!==o?s=l=[l,h]:(V=s,s=u);r!==o&&(41===i.charCodeAt(V)?(s=")",V++):(s=o,K(_)),s!==o)?(B=t,t=e=(c=n,[c].concat((p=r).map(function(t){return t[1]})))):(V=t,t=u)}else V=t,t=u}else V=t,t=u;return t}function ti(){var t,e,n,r,s,l,h,c,p,d,f,g,m,$,v;if(t=V,(e=(d=V,"=="===i.substr(V,2)?(f="==",V+=2):(f=o,K(A)),f!==o&&(f={relation:"equ",$parserOffset:B=d}),(d=f)===o&&(d=V,"<="===i.substr(V,2)?(f="<=",V+=2):(f=o,K(T)),f!==o&&(f={relation:"leq",$parserOffset:B=d}),(d=f)===o&&(d=V,">="===i.substr(V,2)?(f=">=",V+=2):(f=o,K(S)),f!==o&&(f={relation:"geq",$parserOffset:B=d}),d=f)),d))===o&&(e=null),e!==o){if((n=((g=(m=V,($=tr())!==o&&(B=m,$={constant:v=$}),$))===o&&(g=tn()),g))!==o)(r=V,64===i.charCodeAt(V)?(s="@",V++):(s=o,K(E)),s!==o&&(l=function t(){var e,n,r,s;if(e=V,n=[],C.test(i.charAt(V))?(r=i.charAt(V),V++):(r=o,K(I)),r!==o)for(;r!==o;)n.push(r),C.test(i.charAt(V))?(r=i.charAt(V),V++):(r=o,K(I));else n=u;return n!==o&&(B=e,n={priority:parseInt((s=n).join(""),10)}),n}())!==o?r=s=[s,l]:(V=r,r=u),r===o&&(r=null),r!==o)?(B=t,t=e=(h=e,c=n,to({relation:"equ"},h||{},c,(p=r)?p[1]:{}))):(V=t,t=u);else V=t,t=u}else V=t,t=u;return t}function tn(){var t,e,n,r,s,l,h;if(t=V,e=V,n=[],R.test(i.charAt(V))?(r=i.charAt(V),V++):(r=o,K(O)),r!==o)for(;r!==o;)n.push(r),R.test(i.charAt(V))?(r=i.charAt(V),V++):(r=o,K(O));else n=u;if(n!==o&&(n=i.substring(e,V)),(e=n)!==o){for(n=V,r=[],P.test(i.charAt(V))?(s=i.charAt(V),V++):(s=o,K(L));s!==o;)r.push(s),P.test(i.charAt(V))?(s=i.charAt(V),V++):(s=o,K(L));(r!==o&&(r=i.substring(n,V)),(n=r)!==o)?(B=t,t=e=(l=e,{view:l+(h=n)})):(V=t,t=u)}else V=t,t=u;return t}function tr(){var t,e,n,r,s,l,h,c;if(t=V,e=[],C.test(i.charAt(V))?(n=i.charAt(V),V++):(n=o,K(I)),n!==o)for(;n!==o;)e.push(n),C.test(i.charAt(V))?(n=i.charAt(V),V++):(n=o,K(I));else e=u;if(e!==o){if(46===i.charCodeAt(V)?(n=".",V++):(n=o,K(N)),n!==o){if(r=[],C.test(i.charAt(V))?(s=i.charAt(V),V++):(s=o,K(I)),s!==o)for(;s!==o;)r.push(s),C.test(i.charAt(V))?(s=i.charAt(V),V++):(s=o,K(I));else r=u;r!==o?(B=t,t=e=(l=e,h=r,parseFloat(l.concat(".").concat(h).join(""),10))):(V=t,t=u)}else V=t,t=u}else V=t,t=u;if(t===o){if(t=V,e=[],C.test(i.charAt(V))?(n=i.charAt(V),V++):(n=o,K(I)),n!==o)for(;n!==o;)e.push(n),C.test(i.charAt(V))?(n=i.charAt(V),V++):(n=o,K(I));else e=u;e!==o&&(B=t,e=parseInt((c=e).join(""),10)),t=e}return t}function to(t){for(var e=1;e<arguments.length;e++)for(var i in arguments[e])t[i]=arguments[e][i];return t}if((n=l())!==o&&V===i.length)return n;throw n!==o&&V<i.length&&K({type:"end",description:"end of input"}),Y(null,M,q)}}}(),h=function(){function t(t,e,i,n,r,o){this.message=t,this.expected=e,this.found=i,this.offset=n,this.line=r,this.column=o,this.name="SyntaxError"}return function t(e,i){function n(){this.constructor=e}n.prototype=i.prototype,e.prototype=new n}(t,Error),{SyntaxError:t,parse:function e(i){var n,r=arguments.length>1?arguments[1]:{},o={},s={visualFormatStringExt:tB},l=tB,u=o,h={type:"literal",value:"C:",description:'"C:"'},c={type:"literal",value:":",description:'":"'},p={type:"literal",value:"HV",description:'"HV"'},d={type:"literal",value:"H",description:'"H"'},f={type:"literal",value:"V",description:'"V"'},g={type:"literal",value:"Z",description:'"Z"'},m={type:"literal",value:" ",description:'" "'},$={type:"literal",value:"//",description:'"//"'},v={type:"any",description:"any character"},_={type:"literal",value:"|",description:'"|"'},E={type:"literal",value:"[",description:'"["'},A={type:"literal",value:",",description:'","'},T={type:"literal",value:"]",description:'"]"'},S={type:"literal",value:"->",description:'"->"'},C={type:"literal",value:"-",description:'"-"'},I=function t(e){return e},R={type:"literal",value:"~",description:'"~"'},O={type:"literal",value:"(",description:'"("'},P={type:"literal",value:")",description:'")"'},L=function t(e,i){return[e].concat(i.map(function(t){return t[1]}))},N={type:"literal",value:"@",description:'"@"'},V={type:"literal",value:"==",description:'"=="'},B={type:"literal",value:"<=",description:'"<="'},D={type:"literal",value:">=",description:'">="'},W=/^[0-9]/,q={type:"class",value:"[0-9]",description:"[0-9]"},M=function t(e){return{constant:e}},k={type:"literal",value:"+",description:'"+"'},H={type:"literal",value:"%",description:'"%"'},U=function t(e){return{view:null,multiplier:e/100}},F=".left",G={type:"literal",value:".left",description:'".left"'},X=".right",j={type:"literal",value:".right",description:'".right"'},K=".top",Y={type:"literal",value:".top",description:'".top"'},Q=".bottom",Z={type:"literal",value:".bottom",description:'".bottom"'},J=".width",tt={type:"literal",value:".width",description:'".width"'},te=".height",ti={type:"literal",value:".height",description:'".height"'},tn=".centerX",tr={type:"literal",value:".centerX",description:'".centerX"'},to=".centerY",ts={type:"literal",value:".centerY",description:'".centerY"'},ta={type:"literal",value:"/",description:'"/"'},tl=function t(e){return 1/e},tu={type:"literal",value:"/+",description:'"/+"'},th={type:"literal",value:"/-",description:'"/-"'},tc={type:"literal",value:"*",description:'"*"'},tp=function t(e){return e},td={type:"literal",value:"*+",description:'"*+"'},tf={type:"literal",value:"*-",description:'"*-"'},ty=function t(e){return-e},tg=/^[a-zA-Z_]/,tm={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},tw=/^[a-zA-Z0-9_]/,t$={type:"class",value:"[a-zA-Z0-9_]",description:"[a-zA-Z0-9_]"},tv=function t(e,i){return{view:e+i,$parserOffset:tx}},tb={type:"literal",value:"..",description:'".."'},t_={type:"literal",value:".",description:'"."'},t8=0,tx=0,tE=0,tA={line:1,column:1,seenCR:!1},tT=0,tS=[];if("startRule"in r){if(!(r.startRule in s))throw Error("Can't start parsing from rule \""+r.startRule+'".');l=s[r.startRule]}function tC(){return i.substring(tx,t8)}function t0(){return tx}function tI(){return tL(tx).line}function tR(){return tL(tx).column}function tO(t){throw tV(null,[{type:"other",description:t}],tx)}function tP(t){throw tV(t,null,tx)}function tL(t){return tE!==t&&(tE>t&&(tE=0,tA={line:1,column:1,seenCR:!1}),function t(e,n,r){var o,s;for(o=n;o<r;o++)"\n"===(s=i.charAt(o))?(!e.seenCR&&e.line++,e.column=1,e.seenCR=!1):"\r"===s||"\u2028"===s||"\u2029"===s?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(tA,tE,t),tE=t),tA}function tN(t){!(t8<tT)&&(t8>tT&&(tT=t8,tS=[]),tS.push(t))}function tV(e,n,r){var o=tL(r),s=r<i.length?i.charAt(r):null;return null!==n&&function t(e){var i=1;for(e.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});i<e.length;)e[i-1]===e[i]?e.splice(i,1):i++}(n),new t(null!==e?e:function t(e,i){var n,r,o,s=Array(e.length);for(o=0;o<e.length;o++)s[o]=e[o].description;return"Expected "+(n=e.length>1?s.slice(0,-1).join(", ")+" or "+s[e.length-1]:s[0])+" but "+(r=i?'"'+function t(e){function i(t){return t.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+i(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+i(t)}).replace(/[\u0180-\u0FFF]/g,function(t){return"\\u0"+i(t)}).replace(/[\u1080-\uFFFF]/g,function(t){return"\\u"+i(t)})}(i)+'"':"end of input")+" found."}(n,s),n,s,r,o.line,o.column)}function tB(){var t;return(t=function t(){var e,n,r,s,l,h,m,$,v,_,E,A,T,S,C,I;if(e=t8,n=t8,(r=(C=t8,"HV"===i.substr(t8,2)?(I="HV",t8+=2):(I=o,tN(p)),I!==o&&(tx=C,I="horzvert"),(C=I)===o&&(C=t8,72===i.charCodeAt(t8)?(I="H",t8++):(I=o,tN(d)),I!==o&&(tx=C,I="horizontal"),(C=I)===o&&(C=t8,86===i.charCodeAt(t8)?(I="V",t8++):(I=o,tN(f)),I!==o&&(tx=C,I="vertical"),(C=I)===o&&(C=t8,90===i.charCodeAt(t8)?(I="Z",t8++):(I=o,tN(g)),I!==o&&(tx=C,I="zIndex"),C=I))),C))!==o?(58===i.charCodeAt(t8)?(s=":",t8++):(s=o,tN(c)),s!==o?n=r=[r,s]:(t8=n,n=u)):(t8=n,n=u),n===o&&(n=null),n!==o){if(r=t8,(s=tq())!==o&&(l=tk())!==o?r=s=[s,l]:(t8=r,r=u),r===o&&(r=null),r!==o){if((s=tM())!==o){for(l=[],h=t8,(m=tk())!==o&&($=tM())!==o?h=m=[m,$]:(t8=h,h=u);h!==o;)l.push(h),h=t8,(m=tk())!==o&&($=tM())!==o?h=m=[m,$]:(t8=h,h=u);l!==o&&(h=t8,(m=tk())!==o&&($=tq())!==o?h=m=[m,$]:(t8=h,h=u),h===o&&(h=null),h!==o&&((m=tW())===o&&(m=null),m!==o))?(tx=e,e=n=(v=n,_=r,E=s,A=l,T=h,{type:"vfl",orientation:v?v[0]:"horizontal",cascade:(_||[]).concat(E,[].concat.apply([],A),T||[])})):(t8=e,e=u)}else t8=e,e=u}else t8=e,e=u}else t8=e,e=u;return e}())===o&&(t=function t(){var e,n,r,s,l,c,p,d,f,g;if(e=t8,"C:"===i.substr(t8,2)?(n="C:",t8+=2):(n=o,tN(h)),n!==o){if((r=t1())!==o){if((s=tD())!==o){for(l=[],c=tD();c!==o;)l.push(c),c=tD();l!==o&&((c=tW())===o&&(c=null),c!==o)?(tx=e,e=n=(p=r,d=s,f=l,{type:"attribute",view:p.view,attributes:[d].concat(f)})):(t8=e,e=u)}else t8=e,e=u}else t8=e,e=u}else t8=e,e=u;return e}()),t}function tD(){var t,e,i,n,r;return(t=t8,(e=tK())!==o&&(i=tH())!==o)?(tx=t,t=e=(n=e,{attr:n,predicates:r=i})):(t8=t,t=u),t}function tW(){var t,e,n,r,s;for(t=t8,e=[],32===i.charCodeAt(t8)?(n=" ",t8++):(n=o,tN(m));n!==o;)e.push(n),32===i.charCodeAt(t8)?(n=" ",t8++):(n=o,tN(m));if(e!==o){if("//"===i.substr(t8,2)?(n="//",t8+=2):(n=o,tN($)),n!==o){for(r=[],i.length>t8?(s=i.charAt(t8),t8++):(s=o,tN(v));s!==o;)r.push(s),i.length>t8?(s=i.charAt(t8),t8++):(s=o,tN(v));r!==o?t=e=[e,n,r]:(t8=t,t=u)}else t8=t,t=u}else t8=t,t=u;return t}function tq(){var t,e;return t=t8,124===i.charCodeAt(t8)?(e="|",t8++):(e=o,tN(_)),e!==o&&(tx=t,e={view:null}),t=e}function tM(){var t,e,n,r,s,l,h,c,p;if(t=t8,91===i.charCodeAt(t8)?(e="[",t8++):(e=o,tN(E)),e!==o){if((n=tz())!==o){for(r=[],s=t8,44===i.charCodeAt(t8)?(l=",",t8++):(l=o,tN(A)),l!==o&&(h=tz())!==o?s=l=[l,h]:(t8=s,s=u);s!==o;)r.push(s),s=t8,44===i.charCodeAt(t8)?(l=",",t8++):(l=o,tN(A)),l!==o&&(h=tz())!==o?s=l=[l,h]:(t8=s,s=u);r!==o&&(93===i.charCodeAt(t8)?(s="]",t8++):(s=o,tN(T)),s!==o)?(tx=t,t=e=(c=n,(p=r).length?[c].concat([].concat.apply([],p)):c)):(t8=t,t=u)}else t8=t,t=u}else t8=t,t=u;return t}function tz(){var t,e,n,r,s,l,h;return(t=t8,(e=function t(){var e,n,r,s,l,h,c,p;if(e=t8,n=t8,r=[],tg.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(tm)),s!==o)for(;s!==o;)r.push(s),tg.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(tm));else r=u;if(r!==o&&(r=i.substring(n,t8)),(n=r)!==o){for(r=t8,s=[],tw.test(i.charAt(t8))?(l=i.charAt(t8),t8++):(l=o,tN(t$));l!==o;)s.push(l),tw.test(i.charAt(t8))?(l=i.charAt(t8),t8++):(l=o,tN(t$));(s!==o&&(s=i.substring(r,t8)),(r=s)!==o&&(s=function t(){var e,n,r,s,l;if(e=t8,".."===i.substr(t8,2)?(n="..",t8+=2):(n=o,tN(tb)),n!==o){if(r=[],W.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(q)),s!==o)for(;s!==o;)r.push(s),W.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(q));else r=u;r!==o?(tx=e,e=n=parseInt(l=r)):(t8=e,e=u)}else t8=e,e=u;return e}())!==o)?(tx=e,e=n=(h=n,c=r,{view:h+c,range:p=s,$parserOffset:tx})):(t8=e,e=u)}else t8=e,e=u;if(e===o){if(e=t8,n=t8,r=[],tg.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(tm)),s!==o)for(;s!==o;)r.push(s),tg.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(tm));else r=u;if(r!==o&&(r=i.substring(n,t8)),(n=r)!==o){for(r=t8,s=[],tw.test(i.charAt(t8))?(l=i.charAt(t8),t8++):(l=o,tN(t$));l!==o;)s.push(l),tw.test(i.charAt(t8))?(l=i.charAt(t8),t8++):(l=o,tN(t$));s!==o&&(s=i.substring(r,t8)),(r=s)!==o?(tx=e,e=n=tv(n,r)):(t8=e,e=u)}else t8=e,e=u}return e}())!==o&&((n=tH())===o&&(n=null),n!==o&&((r=function t(){var e,n,r,s,l,h,p,d;if(e=t8,58===i.charCodeAt(t8)?(n=":",t8++):(n=o,tN(c)),n!==o){if(r=[],s=t8,(l=tk())!==o&&(h=tM())!==o?s=l=[l,h]:(t8=s,s=u),s!==o)for(;s!==o;)r.push(s),s=t8,(l=tk())!==o&&(h=tM())!==o?s=l=[l,h]:(t8=s,s=u);else r=u;r!==o&&(s=tk())!==o?(tx=e,e=n=(p=r,d=s,[].concat([].concat.apply([],p),[d]))):(t8=e,e=u)}else t8=e,e=u;return e}())===o&&(r=null),r!==o)))?(tx=t,t=e=(s=e,l=n,h=r,tY(tY(s,l?{constraints:l}:{}),h?{cascade:h}:{}))):(t8=t,t=u),t}function tk(){var t,e,n,r,s,l,h,c,p;return t=t8,"->"===i.substr(t8,2)?(e="->",t8+=2):(e=o,tN(S)),e!==o&&(tx=t,e=[{relation:"none"}]),(t=e)===o&&(t=t8,45===i.charCodeAt(t8)?(e="-",t8++):(e=o,tN(C)),e!==o&&(n=((s=(l=t8,(h=tj())!==o&&(tx=l,h=[{relation:"equ",multiplier:(c=h).multiplier}]),(l=h)===o&&(l=t8,(h=t3())!==o&&(tx=l,h=[{relation:"equ",constant:p=h}]),l=h),l))===o&&(s=tH()),s))!==o?(45===i.charCodeAt(t8)?(r="-",t8++):(r=o,tN(C)),r!==o?(tx=t,t=e=I(n)):(t8=t,t=u)):(t8=t,t=u),t===o&&(t=t8,45===i.charCodeAt(t8)?(e="-",t8++):(e=o,tN(C)),e!==o&&(tx=t,e=[{relation:"equ",constant:"default"}]),(t=e)===o&&(t=t8,126===i.charCodeAt(t8)?(e="~",t8++):(e=o,tN(R)),e!==o&&(n=function t(){var e,n,r,s,l,h,c;if(e=t8,40===i.charCodeAt(t8)?(n="(",t8++):(n=o,tN(O)),n!==o){if((r=tF())!==o){for(s=[],l=t8,44===i.charCodeAt(t8)?(h=",",t8++):(h=o,tN(A)),h!==o&&(c=tF())!==o?l=h=[h,c]:(t8=l,l=u);l!==o;)s.push(l),l=t8,44===i.charCodeAt(t8)?(h=",",t8++):(h=o,tN(A)),h!==o&&(c=tF())!==o?l=h=[h,c]:(t8=l,l=u);s!==o?(41===i.charCodeAt(t8)?(l=")",t8++):(l=o,tN(P)),l!==o?(tx=e,e=n=L(r,s)):(t8=e,e=u)):(t8=e,e=u)}else t8=e,e=u}else t8=e,e=u;return e}())!==o?(126===i.charCodeAt(t8)?(r="~",t8++):(r=o,tN(R)),r!==o?(tx=t,t=e=I(n)):(t8=t,t=u)):(t8=t,t=u),t===o&&(t=t8,126===i.charCodeAt(t8)?(e="~",t8++):(e=o,tN(R)),e!==o&&(tx=t,e=[{relation:"equ",equalSpacing:!0}]),(t=e)===o&&(t=t8,(e="")!==o&&(tx=t,e=[{relation:"equ",constant:0}]),t=e))))),t}function tH(){var t,e,n,r,s,l,h;if(t=t8,40===i.charCodeAt(t8)?(e="(",t8++):(e=o,tN(O)),e!==o){if((n=tU())!==o){for(r=[],s=t8,44===i.charCodeAt(t8)?(l=",",t8++):(l=o,tN(A)),l!==o&&(h=tU())!==o?s=l=[l,h]:(t8=s,s=u);s!==o;)r.push(s),s=t8,44===i.charCodeAt(t8)?(l=",",t8++):(l=o,tN(A)),l!==o&&(h=tU())!==o?s=l=[l,h]:(t8=s,s=u);r!==o?(41===i.charCodeAt(t8)?(s=")",t8++):(s=o,tN(P)),s!==o?(tx=t,t=e=L(n,r)):(t8=t,t=u)):(t8=t,t=u)}else t8=t,t=u}else t8=t,t=u;return t}function tU(){var t,e,n,r,s,l,h,c,p;return(t=t8,(e=tG())===o&&(e=null),e!==o&&(n=tX())!==o&&(r=t8,64===i.charCodeAt(t8)?(s="@",t8++):(s=o,tN(N)),s!==o&&(l=t2())!==o?r=s=[s,l]:(t8=r,r=u),r===o&&(r=null),r!==o))?(tx=t,t=e=(h=e,c=n,tY({relation:"equ"},h||{},c,(p=r)?p[1]:{}))):(t8=t,t=u),t}function tF(){var t,e,n,r,s,l,h,c,p;return(t=t8,(e=tG())===o&&(e=null),e!==o&&(n=tX())!==o&&(r=t8,64===i.charCodeAt(t8)?(s="@",t8++):(s=o,tN(N)),s!==o&&(l=t2())!==o?r=s=[s,l]:(t8=r,r=u),r===o&&(r=null),r!==o))?(tx=t,t=e=(h=e,c=n,tY({relation:"equ",equalSpacing:!0},h||{},c,(p=r)?p[1]:{}))):(t8=t,t=u),t}function tG(){var t,e;return t=t8,"=="===i.substr(t8,2)?(e="==",t8+=2):(e=o,tN(V)),e!==o&&(tx=t,e={relation:"equ"}),(t=e)===o&&(t=t8,"<="===i.substr(t8,2)?(e="<=",t8+=2):(e=o,tN(B)),e!==o&&(tx=t,e={relation:"leq"}),(t=e)===o&&(t=t8,">="===i.substr(t8,2)?(e=">=",t8+=2):(e=o,tN(D)),e!==o&&(tx=t,e={relation:"geq"}),t=e)),t}function tX(){var t,e,n,r,s;return(t=tj())===o&&(t=(e=t8,(n=t3())!==o&&(tx=e,n=M(n)),(e=n)===o&&((e=t8,45===i.charCodeAt(t8)?(n="-",t8++):(n=o,tN(C)),n!==o&&(r=t3())!==o)?(tx=e,e=n={constant:-(s=r)}):(t8=e,e=u),e===o&&(e=t8,43===i.charCodeAt(t8)?(n="+",t8++):(n=o,tN(k)),n!==o&&(r=t3())!==o?(tx=e,e=n=M(r)):(t8=e,e=u))),e))===o&&(t=function t(){var e,n,r,s,l,h,c,p,d,f,g,m,$,v,_,E;if(e=t8,(n=t1())!==o){if((r=tK())===o&&(r=null),r!==o){if((s=(f=t8,47===i.charCodeAt(t8)?(g="/",t8++):(g=o,tN(ta)),g!==o&&(m=t3())!==o?(tx=f,f=g=tl(m)):(t8=f,f=u),f===o&&(f=t8,"/+"===i.substr(t8,2)?(g="/+",t8+=2):(g=o,tN(tu)),g!==o&&(m=t3())!==o?(tx=f,f=g=tl(m)):(t8=f,f=u),f===o)&&((f=t8,"/-"===i.substr(t8,2)?(g="/-",t8+=2):(g=o,tN(th)),g!==o&&(m=t3())!==o)?(tx=f,f=g=-1/($=m)):(t8=f,f=u),f===o&&(f=t8,42===i.charCodeAt(t8)?(g="*",t8++):(g=o,tN(tc)),g!==o&&(m=t3())!==o?(tx=f,f=g=tp(m)):(t8=f,f=u),f===o&&(f=t8,"*+"===i.substr(t8,2)?(g="*+",t8+=2):(g=o,tN(td)),g!==o&&(m=t3())!==o?(tx=f,f=g=tp(m)):(t8=f,f=u),f===o&&(f=t8,"*-"===i.substr(t8,2)?(g="*-",t8+=2):(g=o,tN(tf)),g!==o&&(m=t3())!==o?(tx=f,f=g=ty(m)):(t8=f,f=u))))),f))===o&&(s=null),s!==o){if((l=(v=t8,45===i.charCodeAt(t8)?(_="-",t8++):(_=o,tN(C)),_!==o&&(E=t3())!==o?(tx=v,v=_=ty(E)):(t8=v,v=u),v===o&&(v=t8,43===i.charCodeAt(t8)?(_="+",t8++):(_=o,tN(k)),_!==o&&(E=t3())!==o?(tx=v,v=_=tp(E)):(t8=v,v=u)),v))===o&&(l=null),l!==o)tx=e,e=n=(h=n,c=r,p=s,d=l,{view:h.view,attribute:c||void 0,multiplier:p||1,constant:d||void 0});else t8=e,e=u}else t8=e,e=u}else t8=e,e=u}else t8=e,e=u;return e}()),t}function t2(){var t,e,n,r;if(t=t8,e=[],W.test(i.charAt(t8))?(n=i.charAt(t8),t8++):(n=o,tN(q)),n!==o)for(;n!==o;)e.push(n),W.test(i.charAt(t8))?(n=i.charAt(t8),t8++):(n=o,tN(q));else e=u;return e!==o&&(tx=t,e={priority:parseInt((r=e).join(""),10)}),e}function tj(){var t,e,n,r,s;return t=t8,(e=t3())!==o?(37===i.charCodeAt(t8)?(n="%",t8++):(n=o,tN(H)),n!==o?(tx=t,t=e=U(e)):(t8=t,t=u)):(t8=t,t=u),t===o&&((t=t8,45===i.charCodeAt(t8)?(e="-",t8++):(e=o,tN(C)),e!==o&&(n=t3())!==o&&(37===i.charCodeAt(t8)?(r="%",t8++):(r=o,tN(H)),r!==o))?(tx=t,t=e={view:null,multiplier:-((s=n)/100)}):(t8=t,t=u),t===o&&(t=t8,43===i.charCodeAt(t8)?(e="+",t8++):(e=o,tN(k)),e!==o&&(n=t3())!==o?(37===i.charCodeAt(t8)?(r="%",t8++):(r=o,tN(H)),r!==o?(tx=t,t=e=U(n)):(t8=t,t=u)):(t8=t,t=u))),t}function tK(){var t,e;return t=t8,i.substr(t8,5)===F?(e=F,t8+=5):(e=o,tN(G)),e!==o&&(tx=t,e="left"),(t=e)===o&&(t=t8,i.substr(t8,6)===X?(e=X,t8+=6):(e=o,tN(j)),e!==o&&(tx=t,e="right"),(t=e)===o&&(t=t8,i.substr(t8,4)===K?(e=K,t8+=4):(e=o,tN(Y)),e!==o&&(tx=t,e="top"),(t=e)===o&&(t=t8,i.substr(t8,7)===Q?(e=Q,t8+=7):(e=o,tN(Z)),e!==o&&(tx=t,e="bottom"),(t=e)===o&&(t=t8,i.substr(t8,6)===J?(e=J,t8+=6):(e=o,tN(tt)),e!==o&&(tx=t,e="width"),(t=e)===o&&(t=t8,i.substr(t8,7)===te?(e=te,t8+=7):(e=o,tN(ti)),e!==o&&(tx=t,e="height"),(t=e)===o&&(t=t8,i.substr(t8,8)===tn?(e=tn,t8+=8):(e=o,tN(tr)),e!==o&&(tx=t,e="centerX"),(t=e)===o&&(t=t8,i.substr(t8,8)===to?(e=to,t8+=8):(e=o,tN(ts)),e!==o&&(tx=t,e="centerY"),t=e))))))),t}function t1(){var t,e,n,r,s;if(t=t8,e=t8,n=[],tg.test(i.charAt(t8))?(r=i.charAt(t8),t8++):(r=o,tN(tm)),r!==o)for(;r!==o;)n.push(r),tg.test(i.charAt(t8))?(r=i.charAt(t8),t8++):(r=o,tN(tm));else n=u;if(n!==o&&(n=i.substring(e,t8)),(e=n)!==o){for(n=t8,r=[],tw.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(t$));s!==o;)r.push(s),tw.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(t$));r!==o&&(r=i.substring(n,t8)),(n=r)!==o?(tx=t,t=e=tv(e,n)):(t8=t,t=u)}else t8=t,t=u;return t}function t3(){var t,e,n,r,s,l,h,c;if(t=t8,e=[],W.test(i.charAt(t8))?(n=i.charAt(t8),t8++):(n=o,tN(q)),n!==o)for(;n!==o;)e.push(n),W.test(i.charAt(t8))?(n=i.charAt(t8),t8++):(n=o,tN(q));else e=u;if(e!==o){if(46===i.charCodeAt(t8)?(n=".",t8++):(n=o,tN(t_)),n!==o){if(r=[],W.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(q)),s!==o)for(;s!==o;)r.push(s),W.test(i.charAt(t8))?(s=i.charAt(t8),t8++):(s=o,tN(q));else r=u;r!==o?(tx=t,t=e=(l=e,h=r,parseFloat(l.concat(".").concat(h).join(""),10))):(t8=t,t=u)}else t8=t,t=u}else t8=t,t=u;if(t===o){if(t=t8,e=[],W.test(i.charAt(t8))?(n=i.charAt(t8),t8++):(n=o,tN(q)),n!==o)for(;n!==o;)e.push(n),W.test(i.charAt(t8))?(n=i.charAt(t8),t8++):(n=o,tN(q));else e=u;e!==o&&(tx=t,e=parseInt((c=e).join(""),10)),t=e}return t}function tY(t){for(var e=1;e<arguments.length;e++)for(var i in arguments[e])t[i]=arguments[e][i];return t}if((n=l())!==o&&t8===i.length)return n;throw n!==o&&t8<i.length&&tN({type:"end",description:"end of input"}),tV(null,tS,tT)}}}(),c={HORIZONTAL:1,VERTICAL:2,ZINDEX:4};function p(t,e){t.equalSpacerIndex=t.equalSpacerIndex||1;var i="_~"+t.lineIndex+":"+t.equalSpacerIndex+"~";t.equalSpacerIndex>1&&t.constraints.push({view1:"_~"+t.lineIndex+":1~",attr1:t.horizontal?s.WIDTH:s.HEIGHT,relation:t.relation.relation||l.EQU,view2:i,attr2:t.horizontal?s.WIDTH:s.HEIGHT,priority:t.relation.priority}),t.equalSpacerIndex++,t.relation.view||t.relation.multiplier&&1!==t.relation.multiplier?(t.constraints.push({view1:i,attr1:t.horizontal?s.WIDTH:s.HEIGHT,relation:t.relation.relation||l.EQU,view2:t.relation.view,attr2:t.horizontal?s.WIDTH:s.HEIGHT,priority:t.relation.priority,multiplier:t.relation.multiplier}),t.relation.multiplier=void 0):t.relation.constant&&(t.constraints.push({view1:i,attr1:t.horizontal?s.WIDTH:s.HEIGHT,relation:l.EQU,view2:null,attr2:s.CONST,priority:t.relation.priority,constant:t.relation.constant}),t.relation.constant=void 0);for(var n=0;n<t.prevViews.length;n++){var r=t.prevViews[n];switch(t.orientation){case c.HORIZONTAL:t.prevAttr=r!==e?s.RIGHT:s.LEFT,t.curAttr=s.LEFT;break;case c.VERTICAL:t.prevAttr=r!==e?s.BOTTOM:s.TOP,t.curAttr=s.TOP;break;case c.ZINDEX:t.prevAttr=s.ZINDEX,t.curAttr=s.ZINDEX,t.relation.constant=r!==e?"default":0}t.constraints.push({view1:r,attr1:t.prevAttr,relation:t.relation.relation,view2:i,attr2:t.curAttr,priority:t.relation.priority})}t.prevViews=[i]}function d(t,e){t.proportionalSpacerIndex=t.proportionalSpacerIndex||1;var i="_-"+t.lineIndex+":"+t.proportionalSpacerIndex+"-";t.proportionalSpacerIndex++,t.constraints.push({view1:i,attr1:t.horizontal?s.WIDTH:s.HEIGHT,relation:t.relation.relation||l.EQU,view2:t.relation.view,attr2:t.horizontal?s.WIDTH:s.HEIGHT,priority:t.relation.priority,multiplier:t.relation.multiplier}),t.relation.multiplier=void 0;for(var n=0;n<t.prevViews.length;n++){var r=t.prevViews[n];switch(t.orientation){case c.HORIZONTAL:t.prevAttr=r!==e?s.RIGHT:s.LEFT,t.curAttr=s.LEFT;break;case c.VERTICAL:t.prevAttr=r!==e?s.BOTTOM:s.TOP,t.curAttr=s.TOP;break;case c.ZINDEX:t.prevAttr=s.ZINDEX,t.curAttr=s.ZINDEX,t.relation.constant=r!==e?"default":0}t.constraints.push({view1:r,attr1:t.prevAttr,relation:t.relation.relation,view2:i,attr2:t.curAttr,priority:t.relation.priority})}t.prevViews=[i]}function f(t,e,i){for(var n=void 0,r=1;r<=4;r*=2)if(i.orientations&r&&i.stack.orientation!==r&&!(i.stack.processedOrientations&r)){i.stack.processedOrientations=i.stack.processedOrientations|r,n=n||{name:e,type:"stack"};for(var o=0,u=i.stack.subViews.length;o<u;o++)r===c.ZINDEX?t.constraints.push({view1:n,attr1:s.ZINDEX,relation:l.EQU,view2:i.stack.subViews[o],attr2:s.ZINDEX}):(t.constraints.push({view1:n,attr1:r===c.VERTICAL?s.HEIGHT:s.WIDTH,relation:l.EQU,view2:i.stack.subViews[o],attr2:r===c.VERTICAL?s.HEIGHT:s.WIDTH}),t.constraints.push({view1:n,attr1:r===c.VERTICAL?s.TOP:s.LEFT,relation:l.EQU,view2:i.stack.subViews[o],attr2:r===c.VERTICAL?s.TOP:s.LEFT}))}}function g(t,e){if(!0===e&&(e=t.match(/\.\.\d+$/))&&(t=t.substring(0,t.length-e[0].length),e=parseInt(e[0].substring(2))),!e)return[t];var i,n=t.match(/\d+$/),r=[];if(n)for(t=t.substring(0,t.length-n[0].length),i=parseInt(n);i<=e;i++)r.push(t+i);else for(r.push(t),i=2;i<=e;i++)r.push(t+i);return r}function m(t,e,i){var n=i?i.view:null,r=[],o=[],l=void 0;n&&(e.push({view:n}),o.push(n));for(var u=0;u<e.length;u++){var h=e[u];if(!Array.isArray(h)&&h.hasOwnProperty("view")||Array.isArray(h)&&h[0].view&&!h[0].relation)for(var $=Array.isArray(h)?h:[h],v=0;v<$.length;v++)for(var _=","===(h=$[v])?[]:h.view?g(h.view,h.range):[null],E=0;E<_.length;E++){var A=_[E];if(o.push(A),A!==n&&(r.push(A),(l=t.subViews[A])||(l={orientations:0},t.subViews[A]=l),l.orientations=l.orientations|t.orientation,l.stack&&f(t,A,l)),void 0!==t.prevViews&&void 0!==A&&t.relation&&"none"!==t.relation.relation)for(var T=0;T<t.prevViews.length;T++){var S=t.prevViews[T];switch(t.orientation){case c.HORIZONTAL:t.prevAttr=S!==n?s.RIGHT:s.LEFT,t.curAttr=A!==n?s.LEFT:s.RIGHT;break;case c.VERTICAL:t.prevAttr=S!==n?s.BOTTOM:s.TOP,t.curAttr=A!==n?s.TOP:s.BOTTOM;break;case c.ZINDEX:t.prevAttr=s.ZINDEX,t.curAttr=s.ZINDEX,t.relation.constant=S?t.relation.constant||"default":0}t.constraints.push({view1:S,attr1:t.prevAttr,relation:t.relation.relation,view2:A,attr2:t.curAttr,multiplier:t.relation.multiplier,constant:"default"!==t.relation.constant&&t.relation.constant?-t.relation.constant:t.relation.constant,priority:t.relation.priority})}var C=h.constraints;if(C)for(var I=0;I<C.length;I++)t.prevAttr=t.horizontal?s.WIDTH:s.HEIGHT,t.curAttr=C[I].view||C[I].multiplier?C[I].attribute||t.prevAttr:C[I].variable?s.VARIABLE:s.CONST,t.constraints.push({view1:A,attr1:t.prevAttr,relation:C[I].relation,view2:C[I].view,attr2:t.curAttr,multiplier:C[I].multiplier,constant:C[I].constant,priority:C[I].priority});h.cascade&&m(t,h.cascade,h)}else","!==h&&(t.prevViews=o,o=[],t.relation=h[0],void 0!==t.prevViews&&(t.relation.equalSpacing&&p(t,n),t.relation.multiplier&&d(t,n)))}if(n){if(l=t.subViews[n]){if(l.stack){var R=Error('A stack named "'+n+'" has already been created');throw R.column=i.$parserOffset+1,R}}else l={orientations:t.orientation},t.subViews[n]=l;l.stack={orientation:t.orientation,processedOrientations:t.orientation,subViews:r},f(t,n,l)}}var $=["viewport","spacing","colors","shapes","widths","heights"],v=function(){function t(){r(this,t)}return n(t,null,[{key:"parseLine",value:function t(e,i){if(0===e.length||i&&i.extended&&0===e.indexOf("//"))return[];var n=i&&i.extended?h.parse(e):u.parse(e);if(i&&"raw"===i.outFormat)return[n];var r={constraints:[],lineIndex:(i?i.lineIndex:void 0)||1,subViews:(i?i.subViews:void 0)||{}};if("attribute"===n.type)for(var o=0;o<n.attributes.length;o++)for(var s=n.attributes[o],l=0;l<s.predicates.length;l++){var p=s.predicates[l];r.constraints.push({view1:n.view,attr1:s.attr,relation:p.relation,view2:p.view,attr2:p.attribute||s.attr,multiplier:p.multiplier,constant:p.constant,priority:p.priority})}else switch(n.orientation){case"horizontal":r.orientation=c.HORIZONTAL,r.horizontal=!0,m(r,n.cascade,null);break;case"vertical":r.orientation=c.VERTICAL,m(r,n.cascade,null);break;case"horzvert":r.orientation=c.HORIZONTAL,r.horizontal=!0,m(r,n.cascade,null),m(r={constraints:r.constraints,lineIndex:r.lineIndex,subViews:r.subViews,orientation:c.VERTICAL},n.cascade,null);break;case"zIndex":r.orientation=c.ZINDEX,m(r,n.cascade,null)}return r.constraints}},{key:"parse",value:function t(e,i){var n=i&&i.lineSeparator?i.lineSeparator:"\n";if(!Array.isArray(e)&&0>e.indexOf(n))try{return this.parseLine(e,i)}catch(r){throw r.source=e,r}e=Array.isArray(e)?e:[e];var o=void 0,s=[],l=0,u=void 0,h={lineIndex:l,extended:i&&i.extended,strict:!i||void 0===i.strict||i.strict,outFormat:i?i.outFormat:void 0,subViews:{}};try{for(var c=0;c<e.length;c++){o=e[c].split(n);for(var p=0;p<o.length;p++)u=o[p],l++,h.lineIndex=l,h.strict||(u=u.trim()),(h.strict||u.length)&&(s=s.concat(this.parseLine(u,h)))}}catch(d){throw d.source=u,d.line=l,d}return s}},{key:"parseMetaInfo",value:function t(e,i){var n,r=i&&i.lineSeparator?i.lineSeparator:"\n",o=i?i.prefix:void 0;e=Array.isArray(e)?e:[e];for(var s={},l=0;l<e.length;l++)for(var u=e[l].split(r),h=0;h<u.length;h++)for(var c=u[h],p=0;p<$.length;p++)for(var d=0;d<(o?2:1);d++){var f=$[p],m=(0===d?"":o)+f;if(0===c.indexOf("//"+m+" "))for(var v=c.substring(3+m.length).split(" "),_=0;_<v.length;_++){s[f]=s[f]||{};for(var E=v[_].split(":"),A=g(E[0],!0),T=0;T<A.length;T++)s[f][A[T]]=E.length>1?E[1]:""}else 0===c.indexOf("//"+m+":")&&(s[f]=c.substring(3+m.length))}if(s.viewport){var S=s.viewport,C=S["aspect-ratio"];C&&(C=C.split("/"),S["aspect-ratio"]=parseInt(C[0])/parseInt(C[1])),void 0!==S.height&&(S.height="intrinsic"===S.height||parseInt(S.height)),void 0!==S.width&&(S.width="intrinsic"===S.width||parseInt(S.width)),void 0!==S["max-height"]&&(S["max-height"]=parseInt(S["max-height"])),void 0!==S["max-width"]&&(S["max-width"]=parseInt(S["max-width"])),void 0!==S["min-height"]&&(S["min-height"]=parseInt(S["min-height"])),void 0!==S["min-width"]&&(S["min-width"]=parseInt(S["min-width"]))}if(s.widths)for(n in s.widths){var I="intrinsic"===s.widths[n]||parseInt(s.widths[n]);s.widths[n]=I,(void 0===I||isNaN(I))&&delete s.widths[n]}if(s.heights)for(n in s.heights){var R="intrinsic"===s.heights[n]||parseInt(s.heights[n]);s.heights[n]=R,(void 0===R||isNaN(R))&&delete s.heights[n]}if(s.spacing){var O=JSON.parse(s.spacing);if(s.spacing=O,Array.isArray(O)){for(var P=0,L=O.length;P<L;P++)if(isNaN(O[P])){delete s.spacing;break}}else(void 0===O||isNaN(O))&&delete s.spacing}return s}}]),t}(),_=function(){function t(e){r(this,t),this._name=e.name,this._type=e.type,this._solver=e.solver,this._attr={},e.name||(this._attr[s.LEFT]=new o.Variable,this._solver.addConstraint(new o.StayConstraint(this._attr[s.LEFT],o.Strength.required)),this._attr[s.TOP]=new o.Variable,this._solver.addConstraint(new o.StayConstraint(this._attr[s.TOP],o.Strength.required)),this._attr[s.ZINDEX]=new o.Variable,this._solver.addConstraint(new o.StayConstraint(this._attr[s.ZINDEX],o.Strength.required)))}return n(t,[{key:"toJSON",value:function t(){return{name:this.name,left:this.left,top:this.top,width:this.width,height:this.height}}},{key:"toString",value:function t(){JSON.stringify(this.toJSON(),void 0,2)}},{key:"getValue",value:function t(e){return this._attr[e]?this._attr[e].value():void 0}},{key:"_getAttr",value:function t(e){if(this._attr[e])return this._attr[e];switch(this._attr[e]=new o.Variable,e){case s.RIGHT:this._getAttr(s.LEFT),this._getAttr(s.WIDTH),this._solver.addConstraint(new o.Equation(this._attr[e],o.plus(this._attr[s.LEFT],this._attr[s.WIDTH])));break;case s.BOTTOM:this._getAttr(s.TOP),this._getAttr(s.HEIGHT),this._solver.addConstraint(new o.Equation(this._attr[e],o.plus(this._attr[s.TOP],this._attr[s.HEIGHT])));break;case s.CENTERX:this._getAttr(s.LEFT),this._getAttr(s.WIDTH),this._solver.addConstraint(new o.Equation(this._attr[e],o.plus(this._attr[s.LEFT],o.divide(this._attr[s.WIDTH],2))));break;case s.CENTERY:this._getAttr(s.TOP),this._getAttr(s.HEIGHT),this._solver.addConstraint(new o.Equation(this._attr[e],o.plus(this._attr[s.TOP],o.divide(this._attr[s.HEIGHT],2))))}return this._attr[e]}},{key:"_getAttrValue",value:function t(e){return this._getAttr(e).value}},{key:"name",get:function t(){return this._name}},{key:"left",get:function t(){return this._getAttrValue(s.LEFT)}},{key:"right",get:function t(){return this._getAttrValue(s.RIGHT)}},{key:"width",get:function t(){return this._getAttrValue(s.WIDTH)}},{key:"height",get:function t(){return this._getAttrValue(s.HEIGHT)}},{key:"intrinsicWidth",get:function t(){return this._intrinsicWidth},set:function t(e){if(void 0!==e&&e!==this._intrinsicWidth){var i=this._getAttr(s.WIDTH);void 0===this._intrinsicWidth&&this._solver.addEditVar(i,new o.Strength("required",this._name?998:999,1e3,1e3)),this._intrinsicWidth=e,this._solver.suggestValue(i,e),this._solver.resolve()}}},{key:"intrinsicHeight",get:function t(){return this._intrinsicHeight},set:function t(e){if(void 0!==e&&e!==this._intrinsicHeight){var i=this._getAttr(s.HEIGHT);void 0===this._intrinsicHeight&&this._solver.addEditVar(i,new o.Strength("required",this._name?998:999,1e3,1e3)),this._intrinsicHeight=e,this._solver.suggestValue(i,e),this._solver.resolve()}}},{key:"top",get:function t(){return this._getAttrValue(s.TOP)}},{key:"bottom",get:function t(){return this._getAttrValue(s.BOTTOM)}},{key:"centerX",get:function t(){return this._getAttrValue(s.CENTERX)}},{key:"centerY",get:function t(){return this._getAttrValue(s.CENTERY)}},{key:"zIndex",get:function t(){return this._getAttrValue(s.ZINDEX)}},{key:"type",get:function t(){return this._type}}]),t}(),E=new o.Strength("defaultPriority",0,1e3,1e3);function A(t,e){var i=new o.Variable({value:e});return this._solver.addConstraint(new o.StayConstraint(i,o.Strength.required,0)),i}function T(t){return t?t.name?(this._subViews[t.name]=this._subViews[t.name]||new _({name:t.name,solver:this._solver}),this._subViews[t.name]._type=this._subViews[t.name]._type||t.type,this._subViews[t.name]):(this._subViews[t]=this._subViews[t]||new _({name:t,solver:this._solver}),this._subViews[t]):this._parentSubView}function S(t){var e=4;if(t.view1||"left"!==t.attr1){if(t.view1||"top"!==t.attr1){if(t.view2||"right"!==t.attr2){if(t.view2||"bottom"!==t.attr2)switch(t.attr1){case"left":case"right":case"centerX":case"leading":case"trailing":e=4;break;case"zIndex":e=6;break;default:e=5}else e=2}else e=1}else e=0}else e=3;return this._spacingVars=this._spacingVars||Array(7),this._spacingExpr=this._spacingExpr||Array(7),this._spacingVars[e]||(this._spacingVars[e]=new o.Variable,this._solver.addEditVar(this._spacingVars[e]),this._spacingExpr[e]=o.minus(0,this._spacingVars[e]),this._solver.suggestValue(this._spacingVars[e],this._spacing[e])),this._spacingExpr[e]}function C(t){var e=void 0,i=void 0!==t.multiplier?t.multiplier:1,n=void 0!==t.constant?t.constant:0;"default"===n&&(n=S.call(this,t));var r=T.call(this,t.view1)._getAttr(t.attr1),u=void 0;t.attr2===s.CONST?u=A.call(this,void 0,t.constant):(u=T.call(this,t.view2)._getAttr(t.attr2),1!==i&&n?u=o.plus(o.times(u,i),n):n?u=o.plus(u,n):1!==i&&(u=o.times(u,i)));var h=void 0!==t.priority&&t.priority<1e3?new o.Strength("priority",0,t.priority,1e3):E;switch(t.relation){case l.EQU:e=new o.Equation(r,u,h);break;case l.GEQ:e=new o.Inequality(r,o.GEQ,u,h);break;case l.LEQ:e=new o.Inequality(r,o.LEQ,u,h);break;default:throw"Invalid relation specified: "+t.relation}this._solver.addConstraint(e)}var I=function(){function t(e){r(this,t),this._solver=new o.SimplexSolver,this._subViews={},this._parentSubView=new _({solver:this._solver}),this.setSpacing(e&&void 0!==e.spacing?e.spacing:8),e&&((void 0!==e.width||void 0!==e.height)&&this.setSize(e.width,e.height),e.constraints&&this.addConstraints(e.constraints))}return n(t,[{key:"setSize",value:function t(e,i){return this._parentSubView.intrinsicWidth=e,this._parentSubView.intrinsicHeight=i,this}},{key:"setSpacing",value:function t(e){switch(Array.isArray(e)?e.length:-1){case -1:e=[e,e,e,e,e,e,1];break;case 1:e=[e[0],e[0],e[0],e[0],e[0],e[0],1];break;case 2:e=[e[1],e[0],e[1],e[0],e[0],e[1],1];break;case 3:e=[e[1],e[0],e[1],e[0],e[0],e[1],e[2]];break;case 6:e=[e[0],e[1],e[2],e[3],e[4],e[5],1];break;case 7:break;default:throw"Invalid spacing syntax"}if(!function t(e,i){if(e===i)return!0;if(!e||!i)return!1;for(var n=0;n<7;n++)if(e[n]!==i[n])return!1;return!0}(this._spacing,e)&&(this._spacing=e,this._spacingVars)){for(var i=0;i<this._spacingVars.length;i++)this._spacingVars[i]&&this._solver.suggestValue(this._spacingVars[i],this._spacing[i]);this._solver.resolve()}return this}},{key:"addConstraint",value:function t(e){return C.call(this,e),this}},{key:"addConstraints",value:function t(e){for(var i=0;i<e.length;i++)C.call(this,e[i]);return this}},{key:"width",get:function t(){return this._parentSubView.intrinsicWidth}},{key:"height",get:function t(){return this._parentSubView.intrinsicHeight}},{key:"fittingWidth",get:function t(){return this._parentSubView.width}},{key:"fittingHeight",get:function t(){return this._parentSubView.height}},{key:"subViews",get:function t(){return this._subViews}}]),t}();e.exports={Attribute:s,Relation:l,Priority:{REQUIRED:1e3,DEFAULTHIGH:750,DEFAULTLOW:250},VisualFormat:v,View:I,SubView:_}},{"cassowary/bin/c":2}],2:[function(t,e,i){(function(){var i,n,r,o,s,l,u,h,c,p,d,f,g,m,$,v,_,E,A,T,S,C;(function(i){"use strict";try{(function(){}).bind(i)}catch(n){Object.defineProperty(Function.prototype,"bind",{value:function(t){var e=this;return function(){return e.apply(t,arguments)}},enumerable:!1,configurable:!0,writable:!0})}var r=0,o=void 0!==i.HTMLElement,s=function(t){for(var e=null;t&&t!=Object.prototype;){if(t.tagName){e=t.tagName;break}t=t.prototype}return e||"div"},l={},u=function(t,e){if(t&&e){if("function"==typeof t[e])return t[e];var i=t.prototype;if(i&&"function"==typeof i[e])return i[e];if(i!==Object.prototype&&i!==Function.prototype)return"function"==typeof t.__super__?u(t.__super__,e):void 0}},h=i.c={debug:!1,trace:!1,verbose:!1,traceAdded:!1,GC:!1,GEQ:1,LEQ:2,inherit:function(t){var e=null,n=null;t.extends&&(n=t.extends,delete t.extends),t.initialize&&(e=t.initialize,delete t.initialize);var r=e||function(){};Object.defineProperty(r,"__super__",{value:n||Object,enumerable:!1,configurable:!0,writable:!1}),t._t&&(l[t._t]=r);var u=r.prototype=Object.create(n?n.prototype:Object.prototype);if(this.extend(u,t),o&&n&&n.prototype instanceof i.HTMLElement){var h=r,c=s(u),p=function(t){return t.__proto__=u,h.apply(t,arguments),u.created&&t.created(),u.decorate&&t.decorate(),t};this.extend(u,{upgrade:p}),(r=function(){return p(i.document.createElement(c))}).prototype=u,this.extend(r,{ctor:h})}return r},extend:function(t,e){return this.own(e,function(i){var n=Object.getOwnPropertyDescriptor(e,i);try{"function"==typeof n.get||"function"==typeof n.set?Object.defineProperty(t,i,n):"function"==typeof n.value||"_"===i.charAt(0)?(n.writable=!0,n.configurable=!0,n.enumerable=!1,Object.defineProperty(t,i,n)):t[i]=e[i]}catch(r){}}),t},own:function(t,e,n){return Object.getOwnPropertyNames(t).forEach(e,n||i),t},traceprint:function(t){h.verbose&&console.log(t)},fnenterprint:function(t){console.log("* "+t)},fnexitprint:function(t){console.log("- "+t)},assert:function(t,e){if(!t)throw new h.InternalError("Assertion failed: "+e)},plus:function(t,e){return t instanceof h.Expression||(t=new h.Expression(t)),e instanceof h.Expression||(e=new h.Expression(e)),t.plus(e)},minus:function(t,e){return t instanceof h.Expression||(t=new h.Expression(t)),e instanceof h.Expression||(e=new h.Expression(e)),t.minus(e)},times:function(t,e){return("number"==typeof t||t instanceof h.Variable)&&(t=new h.Expression(t)),("number"==typeof e||e instanceof h.Variable)&&(e=new h.Expression(e)),t.times(e)},divide:function(t,e){return("number"==typeof t||t instanceof h.Variable)&&(t=new h.Expression(t)),("number"==typeof e||e instanceof h.Variable)&&(e=new h.Expression(e)),t.divide(e)},approx:function(t,e){var i,n;return t===e||(i=t instanceof h.Variable?t.value:t,n=e instanceof h.Variable?e.value:e,0==i?1e-8>Math.abs(n):0==n?1e-8>Math.abs(i):Math.abs(i-n)<1e-8*Math.abs(i))},_inc:function(){return r++},parseJSON:function(t){return JSON.parse(t,function(t,e){if("object"!=typeof e||"string"!=typeof e._t)return e;var i=e._t,n=l[i];if(i&&n){var r=u(n,"fromJSON");if(r)return r(e,n)}return e})}};"function"==typeof t&&void 0!==e&&"undefined"==typeof load&&(i.exports=h)})(this),i=this.c||e.parent.exports||{},n=function(t){return t.hashCode?t.hashCode:""+t},r=function(t,e){Object.keys(t).forEach(function(i){e[i]=t[i]})},o={},i.HashTable=i.inherit({initialize:function(){this.size=0,this._store={},this._keyStrMap={},this._deleted=0},set:function(t,e){var i=n(t);this._store.hasOwnProperty(i)||this.size++,this._store[i]=e,this._keyStrMap[i]=t},get:function(t){return this.size?(t=n(t),void 0!==this._store[t]?this._store[t]:null):null},clear:function(){this.size=0,this._store={},this._keyStrMap={}},_compact:function(){var t={};r(this._store,t),this._store=t},_compactThreshold:100,_perhapsCompact:function(){this._size>64||this._deleted>this._compactThreshold&&(this._compact(),this._deleted=0)},delete:function(t){t=n(t),this._store.hasOwnProperty(t)&&(this._deleted++,delete this._store[t],this.size>0&&this.size--)},each:function(t,e){if(this.size){this._perhapsCompact();var i=this._store,n=this._keyStrMap;Object.keys(this._store).forEach(function(r){t.call(e||null,n[r],i[r])},this)}},escapingEach:function(t,e){if(this.size){this._perhapsCompact();for(var i,n=this._store,r=this._keyStrMap,s=o,l=Object.keys(n),u=0;l.length>u;u++)if(i=l[u],this._store.hasOwnProperty(i)&&(s=t.call(e||null,r[i],n[i])),s){if(void 0!==s.retval)return s;if(s.brk)break}}},clone:function(){var t=new i.HashTable;return this.size&&(t.size=this.size,r(this._store,t._store),r(this._keyStrMap,t._keyStrMap)),t},equals:function(t){if(t===this)return!0;if(!(t instanceof i.HashTable)||t._size!==this._size)return!1;for(var e=Object.keys(this._store),n=0;e.length>n;n++){var r=e[n];if(this._keyStrMap[r]!==t._keyStrMap[r]||this._store[r]!==t._store[r])return!1}return!0},toString:function(){var t="";return this.each(function(e,i){t+=e+" => "+i+"\n"}),t}}),(s=this.c||e.parent.exports||{}).HashSet=s.inherit({_t:"c.HashSet",initialize:function(){this.storage=[],this.size=0},add:function(t){var e=this.storage;e.indexOf(t),-1==e.indexOf(t)&&e.push(t),this.size=this.storage.length},values:function(){return this.storage},has:function(t){return -1!=this.storage.indexOf(t)},delete:function(t){var e=this.storage.indexOf(t);return -1==e?null:(this.storage.splice(e,1)[0],void(this.size=this.storage.length))},clear:function(){this.storage.length=0},each:function(t,e){this.size&&this.storage.forEach(t,e)},escapingEach:function(t,e){this.size&&this.storage.forEach(t,e)},toString:function(){var t=this.size+" {",e=!0;return this.each(function(i){e?e=!1:t+=", ",t+=i}),t+="}\n"},toJSON:function(){var t=[];return this.each(function(e){t.push(e.toJSON())}),{_t:"c.HashSet",data:t}},fromJSON:function(t){var e=new s.HashSet;return t.data&&(e.size=t.data.length,e.storage=t.data),e}}),(l=this.c||e.parent.exports||{}).Error=l.inherit({initialize:function(t){t&&(this._description=t)},_name:"c.Error",_description:"An error has occured in Cassowary",set description(a){this._description=a},get description(){return"("+this._name+") "+this._description},get message(){return this.description},toString:function(){return this.description}}),u=function(t,e){return l.inherit({extends:l.Error,initialize:function(){l.Error.apply(this,arguments)},_name:t||"",_description:e||""})},l.ConstraintNotFound=u("c.ConstraintNotFound","Tried to remove a constraint never added to the tableu"),l.InternalError=u("c.InternalError"),l.NonExpression=u("c.NonExpression","The resulting expression would be non"),l.NotEnoughStays=u("c.NotEnoughStays","There are not enough stays to give specific values to every variable"),l.RequiredFailure=u("c.RequiredFailure","A required constraint cannot be satisfied"),l.TooDifficult=u("c.TooDifficult","The constraints are too difficult to solve"),(h=this.c||e.parent.exports||{}).SymbolicWeight=h.inherit({_t:"c.SymbolicWeight",initialize:function(){this.value=0;for(var t=1,e=arguments.length-1;e>=0;--e)this.value+=arguments[e]*t,t*=1e3},toJSON:function(){return{_t:this._t,value:this.value}}}),(c=this.c||(void 0!==e?e.parent.exports.c:{})).Strength=c.inherit({initialize:function(t,e,i,n){this.name=t,this.symbolicWeight=e instanceof c.SymbolicWeight?e:new c.SymbolicWeight(e,i,n)},get required(){return this===c.Strength.required},toString:function(){return this.name+(this.isRequired?"":":"+this.symbolicWeight)}}),c.Strength.required=new c.Strength("<Required>",1e3,1e3,1e3),c.Strength.strong=new c.Strength("strong",1,0,0),c.Strength.medium=new c.Strength("medium",0,1,0),c.Strength.weak=new c.Strength("weak",0,0,1),(p=this.c||e.parent.exports||{}).AbstractVariable=p.inherit({isDummy:!1,isExternal:!1,isPivotable:!1,isRestricted:!1,_init:function(t,e){this.hashCode=p._inc(),this.name=(e||"")+this.hashCode,t&&(void 0!==t.name&&(this.name=t.name),void 0!==t.value&&(this.value=t.value),void 0!==t.prefix&&(this._prefix=t.prefix))},_prefix:"",name:"",value:0,toJSON:function(){var t={};return this._t&&(t._t=this._t),this.name&&(t.name=this.name),void 0!==this.value&&(t.value=this.value),this._prefix&&(t._prefix=this._prefix),this._t&&(t._t=this._t),t},fromJSON:function(t,e){var i=new e;return p.extend(i,t),i},toString:function(){return this._prefix+"["+this.name+":"+this.value+"]"}}),p.Variable=p.inherit({_t:"c.Variable",extends:p.AbstractVariable,initialize:function(t){this._init(t,"v");var e=p.Variable._map;e&&(e[this.name]=this)},isExternal:!0}),p.DummyVariable=p.inherit({_t:"c.DummyVariable",extends:p.AbstractVariable,initialize:function(t){this._init(t,"d")},isDummy:!0,isRestricted:!0,value:"dummy"}),p.ObjectiveVariable=p.inherit({_t:"c.ObjectiveVariable",extends:p.AbstractVariable,initialize:function(t){this._init(t,"o")},value:"obj"}),p.SlackVariable=p.inherit({_t:"c.SlackVariable",extends:p.AbstractVariable,initialize:function(t){this._init(t,"s")},isPivotable:!0,isRestricted:!0,value:"slack"}),(d=this.c||e.parent.exports||{}).Point=d.inherit({initialize:function(t,e,i){if(t instanceof d.Variable)this._x=t;else{var n={value:t};i&&(n.name="x"+i),this._x=new d.Variable(n)}if(e instanceof d.Variable)this._y=e;else{var r={value:e};i&&(r.name="y"+i),this._y=new d.Variable(r)}},get x(){return this._x},set x(b){b instanceof d.Variable?this._x=b:this._x.value=b},get y(){return this._y},set y(b){b instanceof d.Variable?this._y=b:this._y.value=b},toString:function(){return"("+this.x+", "+this.y+")"}}),(f=this.c||e.parent.exports||{}).Expression=f.inherit({initialize:function(t,e,i){f.GC&&console.log("new c.Expression"),this.constant="number"!=typeof i||isNaN(i)?0:i,this.terms=new f.HashTable,t instanceof f.AbstractVariable?this.setVariable(t,"number"==typeof e?e:1):"number"==typeof t&&(isNaN(t)?console.trace():this.constant=t)},initializeFromHash:function(t,e){return f.verbose&&(console.log("*******************************"),console.log("clone c.initializeFromHash"),console.log("*******************************")),f.GC&&console.log("clone c.Expression"),this.constant=t,this.terms=e.clone(),this},multiplyMe:function(t){this.constant*=t;var e=this.terms;return e.each(function(i,n){e.set(i,n*t)}),this},clone:function(){f.verbose&&(console.log("*******************************"),console.log("clone c.Expression"),console.log("*******************************"));var t=new f.Expression;return t.initializeFromHash(this.constant,this.terms),t},times:function(t){if("number"==typeof t)return this.clone().multiplyMe(t);if(this.isConstant)return t.times(this.constant);if(t.isConstant)return this.times(t.constant);throw new f.NonExpression},plus:function(t){return t instanceof f.Expression?this.clone().addExpression(t,1):t instanceof f.Variable?this.clone().addVariable(t,1):void 0},minus:function(t){return t instanceof f.Expression?this.clone().addExpression(t,-1):t instanceof f.Variable?this.clone().addVariable(t,-1):void 0},divide:function(t){if("number"==typeof t){if(f.approx(t,0))throw new f.NonExpression;return this.times(1/t)}if(t instanceof f.Expression){if(!t.isConstant)throw new f.NonExpression;return this.times(1/t.constant)}},addExpression:function(t,e,i,n){return t instanceof f.AbstractVariable&&(t=new f.Expression(t),f.trace&&console.log("addExpression: Had to cast a var to an expression")),e=e||1,this.constant+=e*t.constant,t.terms.each(function(t,r){this.addVariable(t,r*e,i,n)},this),this},addVariable:function(t,e,i,n){null==e&&(e=1),f.trace&&console.log("c.Expression::addVariable():",t,e);var r=this.terms.get(t);if(r){var o=r+e;0==o||f.approx(o,0)?(n&&n.noteRemovedVariable(t,i),this.terms.delete(t)):this.setVariable(t,o)}else f.approx(e,0)||(this.setVariable(t,e),n&&n.noteAddedVariable(t,i));return this},setVariable:function(t,e){return this.terms.set(t,e),this},anyPivotableVariable:function(){if(this.isConstant)throw new f.InternalError("anyPivotableVariable called on a constant");var t=this.terms.escapingEach(function(t){return t.isPivotable?{retval:t}:void 0});return t&&void 0!==t.retval?t.retval:null},substituteOut:function(t,e,i,n){f.trace&&(f.fnenterprint("CLE:substituteOut: "+t+", "+e+", "+i+", ..."),f.traceprint("this = "+this));var r=this.setVariable.bind(this),o=this.terms,s=o.get(t);o.delete(t),this.constant+=s*e.constant,e.terms.each(function(t,e){var l=o.get(t);if(l){var u=l+s*e;f.approx(u,0)?(n.noteRemovedVariable(t,i),o.delete(t)):r(t,u)}else r(t,s*e),n&&n.noteAddedVariable(t,i)}),f.trace&&f.traceprint("Now this is "+this)},changeSubject:function(t,e){this.setVariable(t,this.newSubject(e))},newSubject:function(t){f.trace&&f.fnenterprint("newSubject:"+t);var e=1/this.terms.get(t);return this.terms.delete(t),this.multiplyMe(-e),e},coefficientFor:function(t){return this.terms.get(t)||0},get isConstant(){return 0==this.terms.size},toString:function(){var t="",e=!1;if(!f.approx(this.constant,0)||this.isConstant){if(t+=this.constant,this.isConstant)return t;e=!0}return this.terms.each(function(i,n){e&&(t+=" + "),t+=n+"*"+i,e=!0}),t},equals:function(t){return t===this||t instanceof f.Expression&&t.constant===this.constant&&t.terms.equals(this.terms)},Plus:function(t,e){return t.plus(e)},Minus:function(t,e){return t.minus(e)},Times:function(t,e){return t.times(e)},Divide:function(t,e){return t.divide(e)}}),(g=this.c||e.parent.exports||{}).AbstractConstraint=g.inherit({initialize:function(t,e){this.hashCode=g._inc(),this.strength=t||g.Strength.required,this.weight=e||1},isEditConstraint:!1,isInequality:!1,isStayConstraint:!1,get required(){return this.strength===g.Strength.required},toString:function(){return this.strength+" {"+this.weight+"} ("+this.expression+")"}}),m=g.AbstractConstraint.prototype.toString,$=function(t,e,i){g.AbstractConstraint.call(this,e||g.Strength.strong,i),this.variable=t,this.expression=new g.Expression(t,-1,t.value)},g.EditConstraint=g.inherit({extends:g.AbstractConstraint,initialize:function(){$.apply(this,arguments)},isEditConstraint:!0,toString:function(){return"edit:"+m.call(this)}}),g.StayConstraint=g.inherit({extends:g.AbstractConstraint,initialize:function(){$.apply(this,arguments)},isStayConstraint:!0,toString:function(){return"stay:"+m.call(this)}}),v=g.Constraint=g.inherit({extends:g.AbstractConstraint,initialize:function(t,e,i){g.AbstractConstraint.call(this,e,i),this.expression=t}}),g.Inequality=g.inherit({extends:g.Constraint,_cloneOrNewCle:function(t){return t.clone?t.clone():new g.Expression(t)},initialize:function(t,e,i,n,r){var o=t instanceof g.Expression,s=i instanceof g.Expression,l=t instanceof g.AbstractVariable,u=i instanceof g.AbstractVariable,h="number"==typeof t,c="number"==typeof i;if((o||h)&&u){var p=t,d=e,f=i,m=n,$=r;if(v.call(this,this._cloneOrNewCle(p),m,$),d==g.LEQ)this.expression.multiplyMe(-1),this.expression.addVariable(f);else{if(d!=g.GEQ)throw new g.InternalError("Invalid operator in c.Inequality constructor");this.expression.addVariable(f,-1)}}else if(l&&(s||c)){var p=i,d=e,f=t,m=n,$=r;if(v.call(this,this._cloneOrNewCle(p),m,$),d==g.GEQ)this.expression.multiplyMe(-1),this.expression.addVariable(f);else{if(d!=g.LEQ)throw new g.InternalError("Invalid operator in c.Inequality constructor");this.expression.addVariable(f,-1)}}else{if(o&&c){var _=t,d=e,E=i,m=n,$=r;if(v.call(this,this._cloneOrNewCle(_),m,$),d==g.LEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(E));else{if(d!=g.GEQ)throw new g.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(E),-1)}return this}if(h&&s){var _=i,d=e,E=t,m=n,$=r;if(v.call(this,this._cloneOrNewCle(_),m,$),d==g.GEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(E));else{if(d!=g.LEQ)throw new g.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(E),-1)}return this}if(o&&s){var _=t,d=e,E=i,m=n,$=r;if(v.call(this,this._cloneOrNewCle(E),m,$),d==g.GEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(_));else{if(d!=g.LEQ)throw new g.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(_),-1)}}else{if(o)return v.call(this,t,e,i);if(e==g.GEQ)v.call(this,new g.Expression(i),n,r),this.expression.multiplyMe(-1),this.expression.addVariable(t);else{if(e!=g.LEQ)throw new g.InternalError("Invalid operator in c.Inequality constructor");v.call(this,new g.Expression(i),n,r),this.expression.addVariable(t,-1)}}}},isInequality:!0,toString:function(){return v.prototype.toString.call(this)+" >= 0) id: "+this.hashCode}}),g.Equation=g.inherit({extends:g.Constraint,initialize:function(t,e,i,n){if(t instanceof g.Expression&&!e||e instanceof g.Strength)v.call(this,t,e,i);else if(t instanceof g.AbstractVariable&&e instanceof g.Expression){var r=t,o=e,s=i,l=n;v.call(this,o.clone(),s,l),this.expression.addVariable(r,-1)}else if(t instanceof g.AbstractVariable&&"number"==typeof e){var r=t,u=e,s=i,l=n;v.call(this,new g.Expression(u),s,l),this.expression.addVariable(r,-1)}else if(t instanceof g.Expression&&e instanceof g.AbstractVariable){var o=t,r=e,s=i,l=n;v.call(this,o.clone(),s,l),this.expression.addVariable(r,-1)}else{if(!(t instanceof g.Expression||t instanceof g.AbstractVariable||"number"==typeof t)||!(e instanceof g.Expression||e instanceof g.AbstractVariable||"number"==typeof e))throw"Bad initializer to c.Equation";t=t instanceof g.Expression?t.clone():new g.Expression(t),e=e instanceof g.Expression?e.clone():new g.Expression(e),v.call(this,t,i,n),this.expression.addExpression(e,-1)}g.assert(this.strength instanceof g.Strength,"_strength not set")},toString:function(){return v.prototype.toString.call(this)+" = 0)"}}),(_=this.c||e.parent.exports||{}).EditInfo=_.inherit({initialize:function(t,e,i,n,r){this.constraint=t,this.editPlus=e,this.editMinus=i,this.prevEditConstant=n,this.index=r},toString:function(){return"<cn="+this.constraint+", ep="+this.editPlus+", em="+this.editMinus+", pec="+this.prevEditConstant+", index="+this.index+">"}}),(E=this.c||e.parent.exports||{}).Tableau=E.inherit({initialize:function(){this.columns=new E.HashTable,this.rows=new E.HashTable,this._infeasibleRows=new E.HashSet,this._externalRows=new E.HashSet,this._externalParametricVars=new E.HashSet},noteRemovedVariable:function(t,e){E.trace&&console.log("c.Tableau::noteRemovedVariable: ",t,e);var i=this.columns.get(t);e&&i&&i.delete(e)},noteAddedVariable:function(t,e){e&&this.insertColVar(t,e)},getInternalInfo:function(){var t="Tableau Information:\n";return t+="Rows: "+this.rows.size,t+=" (= "+(this.rows.size-1)+" constraints)",t+="\nColumns: "+this.columns.size,t+="\nInfeasible Rows: "+this._infeasibleRows.size,t+="\nExternal basic variables: "+this._externalRows.size,t+="\nExternal parametric variables: ",t+=this._externalParametricVars.size,t+="\n"},toString:function(){var t="Tableau:\n";return this.rows.each(function(e,i){t+=e,t+=" <==> ",t+=i,t+="\n"}),t+="\nColumns:\n",t+=this.columns,t+="\nInfeasible rows: ",t+=this._infeasibleRows,t+="External basic variables: ",t+=this._externalRows,t+="External parametric variables: ",t+=this._externalParametricVars},insertColVar:function(t,e){var i=this.columns.get(t);i||(i=new E.HashSet,this.columns.set(t,i)),i.add(e)},addRow:function(t,e){E.trace&&E.fnenterprint("addRow: "+t+", "+e),this.rows.set(t,e),e.terms.each(function(e){this.insertColVar(e,t),e.isExternal&&this._externalParametricVars.add(e)},this),t.isExternal&&this._externalRows.add(t),E.trace&&E.traceprint(""+this)},removeColumn:function(t){E.trace&&E.fnenterprint("removeColumn:"+t);var e=this.columns.get(t);e?(this.columns.delete(t),e.each(function(e){this.rows.get(e).terms.delete(t)},this)):E.trace&&console.log("Could not find var",t,"in columns"),t.isExternal&&(this._externalRows.delete(t),this._externalParametricVars.delete(t))},removeRow:function(t){E.trace&&E.fnenterprint("removeRow:"+t);var e=this.rows.get(t);return E.assert(null!=e),e.terms.each(function(e){var i=this.columns.get(e);null!=i&&(E.trace&&console.log("removing from varset:",t),i.delete(t))},this),this._infeasibleRows.delete(t),t.isExternal&&this._externalRows.delete(t),this.rows.delete(t),E.trace&&E.fnexitprint("returning "+e),e},substituteOut:function(t,e){E.trace&&E.fnenterprint("substituteOut:"+t+", "+e),E.trace&&E.traceprint(""+this),this.columns.get(t).each(function(i){var n=this.rows.get(i);n.substituteOut(t,e,i,this),i.isRestricted&&0>n.constant&&this._infeasibleRows.add(i)},this),t.isExternal&&(this._externalRows.add(t),this._externalParametricVars.delete(t)),this.columns.delete(t)},columnsHasKey:function(t){return!!this.columns.get(t)}}),T=(A=this.c||e.parent.exports||{}).Tableau.prototype,S=A.Strength.weak,A.SimplexSolver=A.inherit({extends:A.Tableau,initialize:function(){A.Tableau.call(this),this._stayMinusErrorVars=[],this._stayPlusErrorVars=[],this._errorVars=new A.HashTable,this._markerVars=new A.HashTable,this._objective=new A.ObjectiveVariable({name:"Z"}),this._editVarMap=new A.HashTable,this._editVarList=[],this._slackCounter=0,this._artificialCounter=0,this._dummyCounter=0,this.autoSolve=!0,this._fNeedsSolving=!1,this._optimizeCount=0,this.rows.set(this._objective,new A.Expression),this._stkCedcns=[0],A.trace&&A.traceprint("objective expr == "+this.rows.get(this._objective))},addLowerBound:function(t,e){var i=new A.Inequality(t,A.GEQ,new A.Expression(e));return this.addConstraint(i)},addUpperBound:function(t,e){var i=new A.Inequality(t,A.LEQ,new A.Expression(e));return this.addConstraint(i)},addBounds:function(t,e,i){return this.addLowerBound(t,e),this.addUpperBound(t,i),this},add:function(){for(var t=0;arguments.length>t;t++)this.addConstraint(arguments[t]);return this},addConstraint:function(t){A.trace&&A.fnenterprint("addConstraint: "+t);var e=[,,],i=[,],n=this.newExpression(t,e,i);if(i=i[0],this.tryAddingDirectly(n)||this.addWithArtificialVariable(n),this._fNeedsSolving=!0,t.isEditConstraint){var r=this._editVarMap.size,o=e[0],s=e[1];!o instanceof A.SlackVariable&&console.warn("cvEplus not a slack variable =",o),!s instanceof A.SlackVariable&&console.warn("cvEminus not a slack variable =",s),A.debug&&console.log("new c.EditInfo("+t+", "+o+", "+s+", "+i+", "+r+")");var l=new A.EditInfo(t,o,s,i,r);this._editVarMap.set(t.variable,l),this._editVarList[r]={v:t.variable,info:l}}return this.autoSolve&&(this.optimize(this._objective),this._setExternalVariables()),this},addConstraintNoException:function(t){A.trace&&A.fnenterprint("addConstraintNoException: "+t);try{return this.addConstraint(t),!0}catch(e){return!1}},addEditVar:function(t,e){return A.trace&&A.fnenterprint("addEditVar: "+t+" @ "+e),this.addConstraint(new A.EditConstraint(t,e||A.Strength.strong))},beginEdit:function(){return A.assert(this._editVarMap.size>0,"_editVarMap.size > 0"),this._infeasibleRows.clear(),this._resetStayConstants(),this._stkCedcns.push(this._editVarMap.size),this},endEdit:function(){return A.assert(this._editVarMap.size>0,"_editVarMap.size > 0"),this.resolve(),this._stkCedcns.pop(),this.removeEditVarsTo(this._stkCedcns[this._stkCedcns.length-1]),this},removeAllEditVars:function(){return this.removeEditVarsTo(0)},removeEditVarsTo:function(t){try{for(var e=this._editVarList.length,i=t;e>i;i++)this._editVarList[i]&&this.removeConstraint(this._editVarMap.get(this._editVarList[i].v).constraint);return this._editVarList.length=t,A.assert(this._editVarMap.size==t,"_editVarMap.size == n"),this}catch(n){throw new A.InternalError("Constraint not found in removeEditVarsTo")}},addPointStays:function(t){return A.trace&&console.log("addPointStays",t),t.forEach(function(t,e){this.addStay(t.x,S,Math.pow(2,e)),this.addStay(t.y,S,Math.pow(2,e))},this),this},addStay:function(t,e,i){var n=new A.StayConstraint(t,e||S,i||1);return this.addConstraint(n)},removeConstraint:function(t){return this.removeConstraintInternal(t),this},removeConstraintInternal:function(t){A.trace&&A.fnenterprint("removeConstraintInternal: "+t),A.trace&&A.traceprint(""+this),this._fNeedsSolving=!0,this._resetStayConstants();var e=this.rows.get(this._objective),i=this._errorVars.get(t);A.trace&&A.traceprint("eVars == "+i),null!=i&&i.each(function(n){var r=this.rows.get(n);null==r?e.addVariable(n,-t.weight*t.strength.symbolicWeight.value,this._objective,this):e.addExpression(r,-t.weight*t.strength.symbolicWeight.value,this._objective,this),A.trace&&A.traceprint("now eVars == "+i)},this);var n=this._markerVars.get(t);if(this._markerVars.delete(t),null==n)throw new A.InternalError("Constraint not found in removeConstraintInternal");if(A.trace&&A.traceprint("Looking to remove var "+n),null==this.rows.get(n)){var r=this.columns.get(n);A.trace&&A.traceprint("Must pivot -- columns are "+r);var o=null,s=0;r.each(function(t){if(t.isRestricted){var e=this.rows.get(t),i=e.coefficientFor(n);if(A.trace&&A.traceprint("Marker "+n+"'s coefficient in "+e+" is "+i),0>i){var r=-e.constant/i;(null==o||s>r||A.approx(r,s)&&t.hashCode<o.hashCode)&&(s=r,o=t)}}},this),null==o&&(A.trace&&A.traceprint("exitVar is still null"),r.each(function(t){if(t.isRestricted){var e=this.rows.get(t),i=e.coefficientFor(n),r=e.constant/i;(null==o||s>r)&&(s=r,o=t)}},this)),null==o&&(0==r.size?this.removeColumn(n):r.escapingEach(function(t){return t!=this._objective?(o=t,{brk:!0}):void 0},this)),null!=o&&this.pivot(n,o)}if(null!=this.rows.get(n)&&this.removeRow(n),null!=i&&i.each(function(t){t!=n&&this.removeColumn(t)},this),t.isStayConstraint){if(null!=i)for(var l=0;this._stayPlusErrorVars.length>l;l++)i.delete(this._stayPlusErrorVars[l]),i.delete(this._stayMinusErrorVars[l])}else if(t.isEditConstraint){A.assert(null!=i,"eVars != null");var u=this._editVarMap.get(t.variable);this.removeColumn(u.editMinus),this._editVarMap.delete(t.variable)}return null!=i&&this._errorVars.delete(i),this.autoSolve&&(this.optimize(this._objective),this._setExternalVariables()),this},reset:function(){throw A.trace&&A.fnenterprint("reset"),new A.InternalError("reset not implemented")},resolveArray:function(t){A.trace&&A.fnenterprint("resolveArray"+t);var e=t.length;this._editVarMap.each(function(i,n){var r=n.index;e>r&&this.suggestValue(i,t[r])},this),this.resolve()},resolvePair:function(t,e){this.suggestValue(this._editVarList[0].v,t),this.suggestValue(this._editVarList[1].v,e),this.resolve()},resolve:function(){A.trace&&A.fnenterprint("resolve()"),this.dualOptimize(),this._setExternalVariables(),this._infeasibleRows.clear(),this._resetStayConstants()},suggestValue:function(t,e){A.trace&&console.log("suggestValue("+t+", "+e+")");var i=this._editVarMap.get(t);if(!i)throw new A.Error("suggestValue for variable "+t+", but var is not an edit variable");var n=e-i.prevEditConstant;return i.prevEditConstant=e,this.deltaEditConstant(n,i.editPlus,i.editMinus),this},solve:function(){return this._fNeedsSolving&&(this.optimize(this._objective),this._setExternalVariables()),this},setEditedValue:function(t,e){if(!this.columnsHasKey(t)&&null==this.rows.get(t))return t.value=e,this;if(!A.approx(e,t.value)){this.addEditVar(t),this.beginEdit();try{this.suggestValue(t,e)}catch(i){throw new A.InternalError("Error in setEditedValue")}this.endEdit()}return this},addVar:function(t){if(!this.columnsHasKey(t)&&null==this.rows.get(t)){try{this.addStay(t)}catch(e){throw new A.InternalError("Error in addVar -- required failure is impossible")}A.trace&&A.traceprint("added initial stay on "+t)}return this},getInternalInfo:function(){var t=T.getInternalInfo.call(this);return t+="\nSolver info:\n",t+="Stay Error Variables: ",t+=this._stayPlusErrorVars.length+this._stayMinusErrorVars.length,t+=" ("+this._stayPlusErrorVars.length+" +, ",t+=this._stayMinusErrorVars.length+" -)\n",t+="Edit Variables: "+this._editVarMap.size,t+="\n"},getDebugInfo:function(){return""+this+this.getInternalInfo()+"\n"},toString:function(){var t=T.getInternalInfo.call(this);return t+="\n_stayPlusErrorVars: ",t+="["+this._stayPlusErrorVars+"]",t+="\n_stayMinusErrorVars: ",t+="["+this._stayMinusErrorVars+"]",t+="\n",t+="_editVarMap:\n"+this._editVarMap,t+="\n"},getConstraintMap:function(){return this._markerVars},addWithArtificialVariable:function(t){A.trace&&A.fnenterprint("addWithArtificialVariable: "+t);var e=new A.SlackVariable({value:++this._artificialCounter,prefix:"a"}),i=new A.ObjectiveVariable({name:"az"}),n=t.clone();A.trace&&A.traceprint("before addRows:\n"+this),this.addRow(i,n),this.addRow(e,t),A.trace&&A.traceprint("after addRows:\n"+this),this.optimize(i);var r=this.rows.get(i);if(A.trace&&A.traceprint("azTableauRow.constant == "+r.constant),!A.approx(r.constant,0))throw this.removeRow(i),this.removeColumn(e),new A.RequiredFailure;var o=this.rows.get(e);if(null!=o){if(o.isConstant)return this.removeRow(e),void this.removeRow(i);var s=o.anyPivotableVariable();this.pivot(s,e)}A.assert(null==this.rows.get(e),"rowExpression(av) == null"),this.removeColumn(e),this.removeRow(i)},tryAddingDirectly:function(t){A.trace&&A.fnenterprint("tryAddingDirectly: "+t);var e=this.chooseSubject(t);return null==e?(A.trace&&A.fnexitprint("returning false"),!1):(t.newSubject(e),this.columnsHasKey(e)&&this.substituteOut(e,t),this.addRow(e,t),A.trace&&A.fnexitprint("returning true"),!0)},chooseSubject:function(t){A.trace&&A.fnenterprint("chooseSubject: "+t);var e=null,i=!1,n=!1,r=t.terms,o=r.escapingEach(function(t,r){if(i){if(!t.isRestricted&&!this.columnsHasKey(t))return{retval:t}}else if(t.isRestricted){if(!n&&!t.isDummy&&0>r){var o=this.columns.get(t);(null==o||1==o.size&&this.columnsHasKey(this._objective))&&(e=t,n=!0)}}else e=t,i=!0},this);if(o&&void 0!==o.retval)return o.retval;if(null!=e)return e;var s=0,o=r.escapingEach(function(t,i){return t.isDummy?void(this.columnsHasKey(t)||(e=t,s=i)):{retval:null}},this);if(o&&void 0!==o.retval)return o.retval;if(!A.approx(t.constant,0))throw new A.RequiredFailure;return s>0&&t.multiplyMe(-1),e},deltaEditConstant:function(t,e,i){A.trace&&A.fnenterprint("deltaEditConstant :"+t+", "+e+", "+i);var n=this.rows.get(e);if(null!=n)return n.constant+=t,void(0>n.constant&&this._infeasibleRows.add(e));var r=this.rows.get(i);if(null!=r)return r.constant+=-t,void(0>r.constant&&this._infeasibleRows.add(i));var o=this.columns.get(i);o||console.log("columnVars is null -- tableau is:\n"+this),o.each(function(e){var n=this.rows.get(e),r=n.coefficientFor(i);n.constant+=r*t,e.isRestricted&&0>n.constant&&this._infeasibleRows.add(e)},this)},dualOptimize:function(){A.trace&&A.fnenterprint("dualOptimize:");for(var t=this.rows.get(this._objective);this._infeasibleRows.size;){var e=this._infeasibleRows.values()[0];this._infeasibleRows.delete(e);var i=null,n=this.rows.get(e);if(n&&0>n.constant){var r,o=Number.MAX_VALUE;if(n.terms.each(function(e,n){n>0&&e.isPivotable&&(o>(r=t.coefficientFor(e)/n)||A.approx(r,o)&&e.hashCode<i.hashCode)&&(i=e,o=r)}),o==Number.MAX_VALUE)throw new A.InternalError("ratio == nil (MAX_VALUE) in dualOptimize");this.pivot(i,e)}}},newExpression:function(t,e,i){A.trace&&(A.fnenterprint("newExpression: "+t),A.traceprint("cn.isInequality == "+t.isInequality),A.traceprint("cn.required == "+t.required));var n=t.expression,r=new A.Expression(n.constant),o=new A.SlackVariable,s=new A.DummyVariable,l=new A.SlackVariable,u=new A.SlackVariable;if(n.terms.each(function(t,e){var i=this.rows.get(t);i?r.addExpression(i,e):r.addVariable(t,e)},this),t.isInequality){if(A.trace&&A.traceprint("Inequality, adding slack"),++this._slackCounter,o=new A.SlackVariable({value:this._slackCounter,prefix:"s"}),r.setVariable(o,-1),this._markerVars.set(t,o),!t.required){++this._slackCounter,l=new A.SlackVariable({value:this._slackCounter,prefix:"em"}),r.setVariable(l,1);var h=this.rows.get(this._objective);h.setVariable(l,t.strength.symbolicWeight.value*t.weight),this.insertErrorVar(t,l),this.noteAddedVariable(l,this._objective)}}else if(t.required)A.trace&&A.traceprint("Equality, required"),++this._dummyCounter,s=new A.DummyVariable({value:this._dummyCounter,prefix:"d"}),r.setVariable(s,1),this._markerVars.set(t,s),A.trace&&A.traceprint("Adding dummyVar == d"+this._dummyCounter);else{A.trace&&A.traceprint("Equality, not required"),++this._slackCounter,u=new A.SlackVariable({value:this._slackCounter,prefix:"ep"}),l=new A.SlackVariable({value:this._slackCounter,prefix:"em"}),r.setVariable(u,-1),r.setVariable(l,1),this._markerVars.set(t,u);var h=this.rows.get(this._objective);A.trace&&console.log(h);var c=t.strength.symbolicWeight.value*t.weight;0==c&&(A.trace&&A.traceprint("cn == "+t),A.trace&&A.traceprint("adding "+u+" and "+l+" with swCoeff == "+c)),h.setVariable(u,c),this.noteAddedVariable(u,this._objective),h.setVariable(l,c),this.noteAddedVariable(l,this._objective),this.insertErrorVar(t,l),this.insertErrorVar(t,u),t.isStayConstraint?(this._stayPlusErrorVars.push(u),this._stayMinusErrorVars.push(l)):t.isEditConstraint&&(e[0]=u,e[1]=l,i[0]=n.constant)}return 0>r.constant&&r.multiplyMe(-1),A.trace&&A.fnexitprint("returning "+r),r},optimize:function(t){A.trace&&A.fnenterprint("optimize: "+t),A.trace&&A.traceprint(""+this),this._optimizeCount++;var e=this.rows.get(t);A.assert(null!=e,"zRow != null");for(var i,n,r=null,o=null;;){if(i=0,(n=e.terms).escapingEach(function(t,e){return t.isPivotable&&i>e?(i=e,r=t,{brk:1}):void 0},this),i>=-.00000001)return;A.trace&&console.log("entryVar:",r,"objectiveCoeff:",i);var s=Number.MAX_VALUE,l=this.columns.get(r),u=0;if(l.each(function(t){if(A.trace&&A.traceprint("Checking "+t),t.isPivotable){var e=this.rows.get(t),i=e.coefficientFor(r);A.trace&&A.traceprint("pivotable, coeff = "+i),0>i&&(s>(u=-e.constant/i)||A.approx(u,s)&&t.hashCode<o.hashCode)&&(s=u,o=t)}},this),s==Number.MAX_VALUE)throw new A.InternalError("Objective function is unbounded in optimize");this.pivot(r,o),A.trace&&A.traceprint(""+this)}},pivot:function(t,e){A.trace&&console.log("pivot: ",t,e),null==t&&console.warn("pivot: entryVar == null"),null==e&&console.warn("pivot: exitVar == null");var i=this.removeRow(e);i.changeSubject(e,t),this.substituteOut(t,i),this.addRow(t,i)},_resetStayConstants:function(){A.trace&&console.log("_resetStayConstants");for(var t=0;this._stayPlusErrorVars.length>t;t++){var e=this.rows.get(this._stayPlusErrorVars[t]);null==e&&(e=this.rows.get(this._stayMinusErrorVars[t])),null!=e&&(e.constant=0)}},_setExternalVariables:function(){A.trace&&A.fnenterprint("_setExternalVariables:"),A.trace&&A.traceprint(""+this),this._externalParametricVars.each(function(t){null!=this.rows.get(t)?A.trace&&console.log("Error: variable"+t+" in _externalParametricVars is basic"):t.value=0},this),this._externalRows.each(function(t){var e=this.rows.get(t);t.value!=e.constant&&(t.value=e.constant)},this),this._fNeedsSolving=!1,this.onsolved()},onsolved:function(){},insertErrorVar:function(t,e){A.trace&&A.fnenterprint("insertErrorVar:"+t+", "+e);var i=this._errorVars.get(e);i||(i=new A.HashSet,this._errorVars.set(t,i)),i.add(e)}}),(C=this.c||e.parent.exports||{}).Timer=C.inherit({initialize:function(){this.isRunning=!1,this._elapsedMs=0},start:function(){return this.isRunning=!0,this._startReading=new Date,this},stop:function(){return this.isRunning=!1,this._elapsedMs+=new Date-this._startReading,this},reset:function(){return this.isRunning=!1,this._elapsedMs=0,this},elapsedTime:function(){return this.isRunning?(this._elapsedMs+(new Date-this._startReading))/1e3:this._elapsedMs/1e3}}),__cassowary_parser=function(){function t(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var e={parse:function(e,i){function n(t){k>q||(q>k&&(k=q,H=[]),H.push(t))}function r(){var t,e,i,n,r,o;return i=q,n=q,null!==(t=D())&&null!==(e=c())?t=[t,e]:(t=null,q=n),null!==t&&(t=o=t[0]),null===t&&(q=i),t}function o(){var t;return e.length>q?(t=e.charAt(q),q++):(t=null,0===M&&n("any character")),t}function s(){var t;return/^[a-zA-Z]/.test(e.charAt(q))?(t=e.charAt(q),q++):(t=null,0===M&&n("[a-zA-Z]")),null===t&&(36===e.charCodeAt(q)?(t="$",q++):(t=null,0===M&&n('"$"')),null===t&&(95===e.charCodeAt(q)?(t="_",q++):(t=null,0===M&&n('"_"')))),t}function l(){var t;return M++,/^[\t\x0B\f \xA0\uFEFF]/.test(e.charAt(q))?(t=e.charAt(q),q++):(t=null,0===M&&n("[\\t\\x0B\\f \\xA0\\uFEFF]")),0==--M&&null===t&&n("whitespace"),t}function u(){var t;return/^[\n\r\u2028\u2029]/.test(e.charAt(q))?(t=e.charAt(q),q++):(t=null,0===M&&n("[\\n\\r\\u2028\\u2029]")),t}function h(){var t;return M++,10===e.charCodeAt(q)?(t="\n",q++):(t=null,0===M&&n('"\\n"')),null===t&&("\r\n"===e.substr(q,2)?(t="\r\n",q+=2):(t=null,0===M&&n('"\\r\\n"')),null===t&&(13===e.charCodeAt(q)?(t="\r",q++):(t=null,0===M&&n('"\\r"')),null===t&&(8232===e.charCodeAt(q)?(t="\u2028",q++):(t=null,0===M&&n('"\\u2028"')),null===t&&(8233===e.charCodeAt(q)?(t="\u2029",q++):(t=null,0===M&&n('"\\u2029"')))))),0==--M&&null===t&&n("end of line"),t}function c(){var t,i,r;return r=q,null!==(t=v())?(59===e.charCodeAt(q)?(i=";",q++):(i=null,0===M&&n('";"')),null!==i?t=[t,i]:(t=null,q=r)):(t=null,q=r),null===t&&(r=q,null!==(t=$())&&null!==(i=h())?t=[t,i]:(t=null,q=r),null===t&&(r=q,null!==(t=v())&&null!==(i=p())?t=[t,i]:(t=null,q=r))),t}function p(){var t,i;return i=q,M++,e.length>q?(t=e.charAt(q),q++):(t=null,0===M&&n("any character")),M--,null===t?t="":(t=null,q=i),t}function d(){var t;return M++,null===(t=f())&&(t=m()),0==--M&&null===t&&n("comment"),t}function f(){var t,i,r,s,l,u,h;if(l=q,"/*"===e.substr(q,2)?(t="/*",q+=2):(t=null,0===M&&n('"/*"')),null!==t){for(i=[],u=q,h=q,M++,"*/"===e.substr(q,2)?(r="*/",q+=2):(r=null,0===M&&n('"*/"')),M--,null===r?r="":(r=null,q=h),null!==r&&null!==(s=o())?r=[r,s]:(r=null,q=u);null!==r;)i.push(r),u=q,h=q,M++,"*/"===e.substr(q,2)?(r="*/",q+=2):(r=null,0===M&&n('"*/"')),M--,null===r?r="":(r=null,q=h),null!==r&&null!==(s=o())?r=[r,s]:(r=null,q=u);null!==i?("*/"===e.substr(q,2)?(r="*/",q+=2):(r=null,0===M&&n('"*/"')),null!==r?t=[t,i,r]:(t=null,q=l)):(t=null,q=l)}else t=null,q=l;return t}function g(){var t,i,r,s,l,h,c;if(l=q,"/*"===e.substr(q,2)?(t="/*",q+=2):(t=null,0===M&&n('"/*"')),null!==t){for(i=[],h=q,c=q,M++,"*/"===e.substr(q,2)?(r="*/",q+=2):(r=null,0===M&&n('"*/"')),null===r&&(r=u()),M--,null===r?r="":(r=null,q=c),null!==r&&null!==(s=o())?r=[r,s]:(r=null,q=h);null!==r;)i.push(r),h=q,c=q,M++,"*/"===e.substr(q,2)?(r="*/",q+=2):(r=null,0===M&&n('"*/"')),null===r&&(r=u()),M--,null===r?r="":(r=null,q=c),null!==r&&null!==(s=o())?r=[r,s]:(r=null,q=h);null!==i?("*/"===e.substr(q,2)?(r="*/",q+=2):(r=null,0===M&&n('"*/"')),null!==r?t=[t,i,r]:(t=null,q=l)):(t=null,q=l)}else t=null,q=l;return t}function m(){var t,i,r,s,l,h,c;if(l=q,"//"===e.substr(q,2)?(t="//",q+=2):(t=null,0===M&&n('"//"')),null!==t){for(i=[],h=q,c=q,M++,r=u(),M--,null===r?r="":(r=null,q=c),null!==r&&null!==(s=o())?r=[r,s]:(r=null,q=h);null!==r;)i.push(r),h=q,c=q,M++,r=u(),M--,null===r?r="":(r=null,q=c),null!==r&&null!==(s=o())?r=[r,s]:(r=null,q=h);null!==i?t=[t,i]:(t=null,q=l)}else t=null,q=l;return t}function $(){var t,e;for(t=[],null===(e=l())&&null===(e=g())&&(e=m());null!==e;)t.push(e),null===(e=l())&&null===(e=g())&&(e=m());return t}function v(){var t,e;for(t=[],null===(e=l())&&null===(e=h())&&(e=d());null!==e;)t.push(e),null===(e=l())&&null===(e=h())&&(e=d());return t}function _(){var t,e,i,n;return e=q,null===(t=A())&&(t=E()),null!==t&&(t={type:"NumericLiteral",value:n=t}),null===t&&(q=e),t}function E(){var t,i,r,o,s;if(r=q,/^[0-9]/.test(e.charAt(q))?(i=e.charAt(q),q++):(i=null,0===M&&n("[0-9]")),null!==i)for(t=[];null!==i;)t.push(i),/^[0-9]/.test(e.charAt(q))?(i=e.charAt(q),q++):(i=null,0===M&&n("[0-9]"));else t=null;return null!==t&&(t=parseInt((s=t).join(""))),null===t&&(q=r),t}function A(){var t,i,r,o,s,l,u;return o=q,s=q,null!==(t=E())?(46===e.charCodeAt(q)?(i=".",q++):(i=null,0===M&&n('"."')),null!==i&&null!==(r=E())?t=[t,i,r]:(t=null,q=s)):(t=null,q=s),null!==t&&(t=parseFloat((u=t).join(""))),null===t&&(q=o),t}function T(){var t,e,i,r;return M++,e=q,null!==(t=S())&&(t=r=t),null===t&&(q=e),0==--M&&null===t&&n("identifier"),t}function S(){var t,e,i,r,o,l,u,h;if(M++,r=q,o=q,null!==(t=s())){for(e=[],i=s();null!==i;)e.push(i),i=s();null!==e?t=[t,e]:(t=null,q=o)}else t=null,q=o;return null!==t&&(t=(u=t[0],u+(h=t[1]).join(""))),null===t&&(q=r),0==--M&&null===t&&n("identifier"),t}function C(){var t,i,r,o,s,l,u,h,c,p,d;return l=q,null!==(t=T())&&(t={type:"Variable",name:c=t}),null===t&&(q=l),null===t&&null===(t=_())&&(l=q,u=q,40===e.charCodeAt(q)?(t="(",q++):(t=null,0===M&&n('"("')),null!==t&&null!==(i=v())&&null!==(r=D())&&null!==(o=v())?(41===e.charCodeAt(q)?(s=")",q++):(s=null,0===M&&n('")"')),null!==s?t=[t,i,r,o,s]:(t=null,q=u)):(t=null,q=u),null!==t&&(t=d=t[2]),null===t&&(q=l)),t}function I(){var t,e,i,n,r,o,s,l;return null===(t=C())&&(n=q,r=q,null!==(t=R())&&null!==(e=v())&&null!==(i=I())?t=[t,e,i]:(t=null,q=r),null!==t&&(t=(s=t[0],{type:"UnaryExpression",operator:s,expression:l=t[2]})),null===t&&(q=n)),t}function R(){var t;return 43===e.charCodeAt(q)?(t="+",q++):(t=null,0===M&&n('"+"')),null===t&&(45===e.charCodeAt(q)?(t="-",q++):(t=null,0===M&&n('"-"')),null===t&&(33===e.charCodeAt(q)?(t="!",q++):(t=null,0===M&&n('"!"')))),t}function O(){var t,e,i,n,r,o,s,l,u;if(s=q,l=q,null!==(t=I())){for(e=[],u=q,null!==(i=v())&&null!==(n=P())&&null!==(r=v())&&null!==(o=I())?i=[i,n,r,o]:(i=null,q=u);null!==i;)e.push(i),u=q,null!==(i=v())&&null!==(n=P())&&null!==(r=v())&&null!==(o=I())?i=[i,n,r,o]:(i=null,q=u);null!==e?t=[t,e]:(t=null,q=l)}else t=null,q=l;return null!==t&&(t=function(t,e,i){for(var n=e,r=0;i.length>r;r++)n={type:"MultiplicativeExpression",operator:i[r][1],left:n,right:i[r][3]};return n}(s,t[0],t[1])),null===t&&(q=s),t}function P(){var t;return 42===e.charCodeAt(q)?(t="*",q++):(t=null,0===M&&n('"*"')),null===t&&(47===e.charCodeAt(q)?(t="/",q++):(t=null,0===M&&n('"/"'))),t}function L(){var t,e,i,n,r,o,s,l,u;if(s=q,l=q,null!==(t=O())){for(e=[],u=q,null!==(i=v())&&null!==(n=N())&&null!==(r=v())&&null!==(o=O())?i=[i,n,r,o]:(i=null,q=u);null!==i;)e.push(i),u=q,null!==(i=v())&&null!==(n=N())&&null!==(r=v())&&null!==(o=O())?i=[i,n,r,o]:(i=null,q=u);null!==e?t=[t,e]:(t=null,q=l)}else t=null,q=l;return null!==t&&(t=function(t,e,i){for(var n=e,r=0;i.length>r;r++)n={type:"AdditiveExpression",operator:i[r][1],left:n,right:i[r][3]};return n}(s,t[0],t[1])),null===t&&(q=s),t}function N(){var t;return 43===e.charCodeAt(q)?(t="+",q++):(t=null,0===M&&n('"+"')),null===t&&(45===e.charCodeAt(q)?(t="-",q++):(t=null,0===M&&n('"-"'))),t}function V(){var t,e,i,n,r,o,s,l,u;if(s=q,l=q,null!==(t=L())){for(e=[],u=q,null!==(i=v())&&null!==(n=B())&&null!==(r=v())&&null!==(o=L())?i=[i,n,r,o]:(i=null,q=u);null!==i;)e.push(i),u=q,null!==(i=v())&&null!==(n=B())&&null!==(r=v())&&null!==(o=L())?i=[i,n,r,o]:(i=null,q=u);null!==e?t=[t,e]:(t=null,q=l)}else t=null,q=l;return null!==t&&(t=function(t,e,i){for(var n=e,r=0;i.length>r;r++)n={type:"Inequality",operator:i[r][1],left:n,right:i[r][3]};return n}(s,t[0],t[1])),null===t&&(q=s),t}function B(){var t;return"<="===e.substr(q,2)?(t="<=",q+=2):(t=null,0===M&&n('"<="')),null===t&&(">="===e.substr(q,2)?(t=">=",q+=2):(t=null,0===M&&n('">="')),null===t&&(60===e.charCodeAt(q)?(t="<",q++):(t=null,0===M&&n('"<"')),null===t&&(62===e.charCodeAt(q)?(t=">",q++):(t=null,0===M&&n('">"'))))),t}function D(){var t,i,r,o,s,l,u,h,c;if(u=q,h=q,null!==(t=V())){for(i=[],c=q,null!==(r=v())?("=="===e.substr(q,2)?(o="==",q+=2):(o=null,0===M&&n('"=="')),null!==o&&null!==(s=v())&&null!==(l=V())?r=[r,o,s,l]:(r=null,q=c)):(r=null,q=c);null!==r;)i.push(r),c=q,null!==(r=v())?("=="===e.substr(q,2)?(o="==",q+=2):(o=null,0===M&&n('"=="')),null!==o&&null!==(s=v())&&null!==(l=V())?r=[r,o,s,l]:(r=null,q=c)):(r=null,q=c);null!==i?t=[t,i]:(t=null,q=h)}else t=null,q=h;return null!==t&&(t=function(t,e,i){for(var n=e,r=0;i.length>r;r++)n={type:"Equality",operator:i[r][1],left:n,right:i[r][3]};return n}(u,t[0],t[1])),null===t&&(q=u),t}var W={start:function t(){var e,i,n,o,s,l,u;if(o=q,s=q,null!==(e=v())){if(null!==(n=r()))for(i=[];null!==n;)i.push(n),n=r();else i=null;null!==i&&null!==(n=v())?e=[e,i,n]:(e=null,q=s)}else e=null,q=s;return null!==e&&(e=u=e[1]),null===e&&(q=o),e},Statement:r,SourceCharacter:o,IdentifierStart:s,WhiteSpace:l,LineTerminator:u,LineTerminatorSequence:h,EOS:c,EOF:p,Comment:d,MultiLineComment:f,MultiLineCommentNoLineTerminator:g,SingleLineComment:m,_:$,__:v,Literal:_,Integer:E,Real:A,SignedInteger:function t(){var i,r,o,s;if(s=q,/^[\-+]/.test(e.charAt(q))?(i=e.charAt(q),q++):(i=null,0===M&&n("[\\-+]")),null!==(i=null!==i?i:"")){if(/^[0-9]/.test(e.charAt(q))?(o=e.charAt(q),q++):(o=null,0===M&&n("[0-9]")),null!==o)for(r=[];null!==o;)r.push(o),/^[0-9]/.test(e.charAt(q))?(o=e.charAt(q),q++):(o=null,0===M&&n("[0-9]"));else r=null;null!==r?i=[i,r]:(i=null,q=s)}else i=null,q=s;return i},Identifier:T,IdentifierName:S,PrimaryExpression:C,UnaryExpression:I,UnaryOperator:R,MultiplicativeExpression:O,MultiplicativeOperator:P,AdditiveExpression:L,AdditiveOperator:N,InequalityExpression:V,InequalityOperator:B,LinearExpression:D};if(void 0!==i){if(void 0===W[i])throw Error("Invalid rule name: "+t(i)+".")}else i="start";var q=0,M=0,k=0,H=[],U=W[i]();if(null===U||q!==e.length){var F=Math.max(q,k),G=e.length>F?e.charAt(F):null,X=function t(){for(var i=1,n=1,r=!1,o=0;Math.max(q,k)>o;o++){var s=e.charAt(o);"\n"===s?(r||i++,n=1,r=!1):"\r"===s||"\u2028"===s||"\u2029"===s?(i++,n=1,r=!0):(n++,r=!1)}return{line:i,column:n}}();throw new this.SyntaxError(function t(e){e.sort();for(var i=null,n=[],r=0;e.length>r;r++)e[r]!==i&&(n.push(e[r]),i=e[r]);return n}(H),G,F,X.line,X.column)}return U},toSource:function(){return this._source}};return e.SyntaxError=function(e,i,n,r,o){this.name="SyntaxError",this.expected=e,this.found=i,this.message=function e(i,n){var r,o;switch(i.length){case 0:r="end of input";break;case 1:r=i[0];break;default:r=i.slice(0,i.length-1).join(", ")+" or "+i[i.length-1]}return o=n?t(n):"end of input","Expected "+r+" but "+o+" found."}(e,i),this.offset=n,this.line=r,this.column=o},e.SyntaxError.prototype=Error.prototype,e}()}).call(void 0!==e?e.compiled=e:this)},{}]},{},[1])(1)}),"undefined"!=typeof Map&&Map.prototype.keys&&"undefined"!=typeof Set&&Set.prototype.keys||function(){function t(t,e){if(e==e)return t.indexOf(e);for(i=0,n=t.length;t[i]==t[i]&&++i!==n;);return i}var e,i,n,r,o,s,l={delete:function(i){return!!~(e=t(this.k,i))&&(this.k.splice(e,1),this.v.splice(e,1),--this.size,!0)},get:function(e){return this.v[t(this.k,e)]},set:function(i,n){return~(e=t(this.k,i))||(this.k[e=this.size++]=i),this.v[e]=n,this},has:function(e){return t(this.k,e)>-1},clear:function(){this.k.length=this.v.length=this.size=0},forEach:function(t,e){e&&(t=t.bind(e));for(var i=-1,n=this.size;++i!==n;)t(this.v[i],this.k[i],this)},entries:function(){var t=0,e=this;return{next:function(){return t!==e.size?{value:[e.k[t++],e.v[t]],done:!1}:{done:!0}}}},keys:function(){var t=0,e=this;return{next:function(){return t!==e.size?{value:e.k[t++],done:!1}:{done:!0}}}},values:function(){var t=0,e=this;return{next:function(){return t!==e.size?{value:e.v[t++],done:!1}:{done:!0}}}},toString:function(){return"[object Map]"}};WeakMap=Map=function(e){if(r=this.k=[],o=this.v=[],n=0,null!=e){if((i=+(s=Object(e)).length)!=i)throw TypeError("("+(e.toString||s.toString)()+") is not iterable");for(;i--;){if(!(s[i]instanceof Object))throw TypeError("Iterator value "+s[i]+" is not an entry object");~t(r,s[i][0])||(r[n]=s[i][0],o[n++]=s[i][1])}r.reverse(),o.reverse()}this.size=n},Map.prototype=l,WeakSet=Set=function(e){if(r=this.k=this.v=[],n=0,null!=e){if((i=+(s=Object(e)).length)!=i)throw TypeError("("+(e.toString||s.toString)()+") is not iterable");for(;i--;)~t(r,s[i])||(r[n++]=s[i]);r.reverse()}this.size=n},Set.prototype={delete:function(i){return!!~(e=t(this.k,i))&&(this.k.splice(e,1),--this.size,!0)},add:function(i){return~(e=t(this.k,i))||(e=this.size++),this.k[e]=i,this},has:l.has,clear:l.clear,forEach:l.forEach,entries:l.entries,keys:l.keys,values:l.keys,toString:function(){return"[object Set]"}}}(),function(t,e){void 0==t&&(t=e("canvas").Context2d),void 0==t.prototype.ellipse&&(t.prototype.ellipse=function(t,e,i,n,r,o,s,l){this.save(),this.translate(t,e),this.rotate(r),this.scale(i,n),this.arc(0,0,1,o,s,l),this.restore()}),("function"!=typeof Path2D||"function"!=typeof new Path2D().addPath)&&function(){function e(t){if(this.ops_=[],void 0!=t){if("string"==typeof t)try{this.ops_=parser.parse(t)}catch(e){}else if(t.hasOwnProperty("ops_"))this.ops_=t.ops_.slice(0);else throw"Error: "+typeof t+"is not a valid argument to Path"}}parser=function(){function t(t,e,i,n,r,o){this.message=t,this.expected=e,this.found=i,this.offset=n,this.line=r,this.column=o,this.name="SyntaxError"}return function t(e,i){function n(){this.constructor=e}n.prototype=i.prototype,e.prototype=new n}(t,Error),{SyntaxError:t,parse:function e(i){var n,r=arguments.length>1?arguments[1]:{},o={},s={svg_path:tv},l=tv,u=o,h=/^[Mm]/,c={type:"class",value:"[Mm]",description:"[Mm]"},p=function(t,e){var i=t;tB&&(i="M",tB=!1),tV.push({type:"moveTo",args:tq(i,e[0])});for(var n=1;n<e.length;n++)tV.push({type:"lineTo",args:tq(t,e[n])})},d=function(t,e){return function t(e,i){var n=[e];if(i&&i.length>1)for(var r=i[1],o=0;o<r.length;o++)n.push(r[o]);return n}(t,e)},f=/^[Zz]/,g={type:"class",value:"[Zz]",description:"[Zz]"},m=function(){tV.push({type:"closePath",args:[]})},$=/^[Ll]/,v={type:"class",value:"[Ll]",description:"[Ll]"},_=function(t,e){for(var i=0;i<e.length;i++)tV.push({type:"lineTo",args:tq(t,e[i])})},E=/^[Hh]/,A={type:"class",value:"[Hh]",description:"[Hh]"},T=function(t,e){for(var i=0;i<e.length;i++)tV.push({type:"lineTo",args:tk(t,e[i])})},S=/^[Vv]/,C={type:"class",value:"[Vv]",description:"[Vv]"},I=function(t,e){for(var i=0;i<e.length;i++)tV.push({type:"lineTo",args:tH(t,e[i])})},R=/^[Cc]/,O={type:"class",value:"[Cc]",description:"[Cc]"},P=function(t,e){for(var i=0;i<e.length;i++)tV.push({type:"bezierCurveTo",args:tM(t,e[i])})},L=/^[Ss]/,N={type:"class",value:"[Ss]",description:"[Ss]"},V=function(t,e){for(var i=0;i<e.length;i++)tV.push({type:"bezierCurveTo",args:tz().concat(tM(t,e[i]))})},B=function(t,e){return t.concat(e)},D=/^[Qq]/,W={type:"class",value:"[Qq]",description:"[Qq]"},q=function(t,e){for(var i=0;i<e.length;i++)tV.push({type:"quadraticCurveTo",args:tM(t,e[i])})},M=/^[Tt]/,k={type:"class",value:"[Tt]",description:"[Tt]"},H=function(t,e){for(var i=0;i<e.length;i++){var n=tz();tV.push({type:"quadraticCurveTo",args:n.concat(tM(t,e[i]))}),tN=n.slice(0)}},U=/^[Aa]/,F={type:"class",value:"[Aa]",description:"[Aa]"},G=function(t,e){for(var i=0;i<e.length;i++){var n=[tL.slice()],r=[tq(t,e[i].slice(-2))];absArgs=n.concat(e[i].slice(0,-2),r),tG.apply(this,absArgs)}},X={type:"literal",value:"0",description:'"0"'},j={type:"literal",value:"1",description:'"1"'},K={type:"literal",value:",",description:'","'},Y={type:"literal",value:".",description:'"."'},Q=/^[eE]/,Z={type:"class",value:"[eE]",description:"[eE]"},J={type:"literal",value:"+",description:'"+"'},tt={type:"literal",value:"-",description:'"-"'},te=/^[0-9]/,ti={type:"class",value:"[0-9]",description:"[0-9]"},tn=/^[ \t\n\r]/,tr={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},to=0,ts=0,ta=0,tl={line:1,column:1,seenCR:!1},tu=0,th=[];if("startRule"in r){if(!(r.startRule in s))throw Error("Can't start parsing from rule \""+r.startRule+'".');l=s[r.startRule]}function tc(){return i.substring(ts,to)}function tp(){return ts}function td(){return tm(ts).line}function tf(){return tm(ts).column}function ty(t){throw t$(null,[{type:"other",description:t}],ts)}function tg(t){throw t$(t,null,ts)}function tm(t){return ta!==t&&(ta>t&&(ta=0,tl={line:1,column:1,seenCR:!1}),function t(e,n,r){var o,s;for(o=n;o<r;o++)"\n"===(s=i.charAt(o))?(!e.seenCR&&e.line++,e.column=1,e.seenCR=!1):"\r"===s||"\u2028"===s||"\u2029"===s?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(tl,ta,t),ta=t),tl}function tw(t){!(to<tu)&&(to>tu&&(tu=to,th=[]),th.push(t))}function t$(e,n,r){var o=tm(r),s=r<i.length?i.charAt(r):null;return null!==n&&function t(e){var i=1;for(e.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});i<e.length;)e[i-1]===e[i]?e.splice(i,1):i++}(n),new t(null!==e?e:function t(e,i){var n,r,o,s=Array(e.length);for(o=0;o<e.length;o++)s[o]=e[o].description;return"Expected "+(n=e.length>1?s.slice(0,-1).join(", ")+" or "+s[e.length-1]:s[0])+" but "+(r=i?'"'+function t(e){function i(t){return t.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+i(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+i(t)}).replace(/[\u0180-\u0FFF]/g,function(t){return"\\u0"+i(t)}).replace(/[\u1080-\uFFFF]/g,function(t){return"\\u"+i(t)})}(i)+'"':"end of input")+" found."}(n,s),n,s,r,o.line,o.column)}function tv(){var t,e,n,r,s,l;for(t=to,e=[],n=tP();n!==o;)e.push(n),n=tP();if(e!==o){if((n=function t(){var e,n,r,s,l;if(e=to,(n=function t(){var e,n,r,s,l;if(e=to,(n=function t(){var e,n,r,s,l,f,g,m,$;if(e=to,h.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(c)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=(l=to,(f=t8())!==o?(g=to,(m=tS())===o&&(m=null),m!==o&&($=tb())!==o?g=m=[m,$]:(to=g,g=u),g===o&&(g=null),g!==o?(ts=l,l=f=d(f,g)):(to=l,l=u)):(to=l,l=u),l))!==o?(ts=e,e=n=p(n,s)):(to=e,e=u)}else to=e,e=u;return e}())!==o){for(r=to,s=[],l=tP();l!==o;)s.push(l),l=tP();s!==o&&(l=function t(){var e,n,r,s,l,h,c,p;if(e=to,(n=((h=(c=to,f.test(i.charAt(to))?(p=i.charAt(to),to++):(p=o,tw(g)),p!==o&&(ts=c,p=m()),c=p))===o&&(h=function t(){var e,n,r,s;if(e=to,$.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(v)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=tb())!==o?(ts=e,e=n=_(n,s)):(to=e,e=u)}else to=e,e=u;return e}())===o&&(h=function t(){var e,n,r,s;if(e=to,E.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(A)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=t_())!==o?(ts=e,e=n=T(n,s)):(to=e,e=u)}else to=e,e=u;return e}())===o&&(h=function t(){var e,n,r,s;if(e=to,S.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(C)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=t_())!==o?(ts=e,e=n=I(n,s)):(to=e,e=u)}else to=e,e=u;return e}())===o&&(h=function t(){var e,n,r,s;if(e=to,R.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(O)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=function t(){var e,i,n,r,s,l,h,c,p,f,g,m,$,v;return e=to,(i=((l=to,(h=t8())!==o&&((c=tS())===o&&(c=null),c!==o&&(p=t8())!==o&&((f=tS())===o&&(f=null),f!==o&&(g=t8())!==o)))?(ts=l,l=h=(m=h,$=p,v=g,m.concat($,v))):(to=l,l=u),l))!==o?(n=to,(r=tS())===o&&(r=null),r!==o&&(s=t())!==o?n=r=[r,s]:(to=n,n=u),n===o&&(n=null),n!==o?(ts=e,e=i=d(i,n)):(to=e,e=u)):(to=e,e=u),e}())!==o?(ts=e,e=n=P(n,s)):(to=e,e=u)}else to=e,e=u;return e}())===o&&(h=function t(){var e,n,r,s;if(e=to,L.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(N)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=function t(){var e,i,n,r,s,l,h,c,p;return e=to,(i=(l=to,(h=t8())!==o?((c=tS())===o&&(c=null),c!==o&&(p=t8())!==o?(ts=l,l=h=B(h,p)):(to=l,l=u)):(to=l,l=u),l))!==o?(n=to,(r=tS())===o&&(r=null),r!==o&&(s=t())!==o?n=r=[r,s]:(to=n,n=u),n===o&&(n=null),n!==o?(ts=e,e=i=d(i,n)):(to=e,e=u)):(to=e,e=u),e}())!==o?(ts=e,e=n=V(n,s)):(to=e,e=u)}else to=e,e=u;return e}())===o&&(h=function t(){var e,n,r,s;if(e=to,D.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(W)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=function t(){var e,i,n,r,s,l,h,c,p;return e=to,(i=(l=to,(h=t8())!==o?((c=tS())===o&&(c=null),c!==o&&(p=t8())!==o?(ts=l,l=h=B(h,p)):(to=l,l=u)):(to=l,l=u),l))!==o?(n=to,(r=tS())===o&&(r=null),r!==o&&(s=t())!==o?n=r=[r,s]:(to=n,n=u),n===o&&(n=null),n!==o?(ts=e,e=i=d(i,n)):(to=e,e=u)):(to=e,e=u),e}())!==o?(ts=e,e=n=q(n,s)):(to=e,e=u)}else to=e,e=u;return e}())===o&&(h=function t(){var e,n,r,s;if(e=to,M.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(k)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=function t(){var e,i,n,r,s;return e=to,(i=t8())!==o?(n=to,(r=tS())===o&&(r=null),r!==o&&(s=t())!==o?n=r=[r,s]:(to=n,n=u),n===o&&(n=null),n!==o?(ts=e,e=i=d(i,n)):(to=e,e=u)):(to=e,e=u),e}())!==o?(ts=e,e=n=H(n,s)):(to=e,e=u)}else to=e,e=u;return e}())===o&&(h=function t(){var e,n,r,s;if(e=to,U.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(F)),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o&&(s=function t(){var e,i,n,r,s,l,h,c,p,f,g,m,$,v,_,E,A,T,S,C,I,R,O;return e=to,(i=((l=to,(h=tE())!==o&&((c=tS())===o&&(c=null),c!==o&&(p=tE())!==o&&((f=tS())===o&&(f=null),f!==o&&(g=tA())!==o&&(m=tS())!==o&&($=tT())!==o&&((v=tS())===o&&(v=null),v!==o&&(_=tT())!==o&&((E=tS())===o&&(E=null),E!==o&&(A=t8())!==o)))))?(ts=l,l=h=(T=h,S=p,C=g,I=$,R=_,O=A,[parseFloat(T),parseFloat(S),parseFloat(tW(C).join("")),parseInt(I),parseInt(R),O[0],O[1]])):(to=l,l=u),l))!==o?(n=to,(r=tS())===o&&(r=null),r!==o&&(s=t())!==o?n=r=[r,s]:(to=n,n=u),n===o&&(n=null),n!==o?(ts=e,e=i=d(i,n)):(to=e,e=u)):(to=e,e=u),e}())!==o?(ts=e,e=n=G(n,s)):(to=e,e=u)}else to=e,e=u;return e}()),h))!==o){for(r=to,s=[],l=tP();l!==o;)s.push(l),l=tP();s!==o&&(l=t())!==o?r=s=[s,l]:(to=r,r=u),r===o&&(r=null),r!==o?e=n=[n,r]:(to=e,e=u)}else to=e,e=u;return e}())!==o?r=s=[s,l]:(to=r,r=u),r===o&&(r=null),r!==o?e=n=[n,r]:(to=e,e=u)}else to=e,e=u;return e}())!==o){for(r=to,s=[],l=tP();l!==o;)s.push(l),l=tP();s!==o&&(l=t())!==o?r=s=[s,l]:(to=r,r=u),r===o&&(r=null),r!==o?e=n=[n,r]:(to=e,e=u)}else to=e,e=u;return e}())===o&&(n=null),n!==o){for(r=[],s=tP();s!==o;)r.push(s),s=tP();r!==o?(ts=t,t=e=tV):(to=t,t=u)}else to=t,t=u}else to=t,t=u;return t}function tb(){var t,e,i,n,r;return t=to,(e=t8())!==o?(i=to,(n=tS())===o&&(n=null),n!==o&&(r=tb())!==o?i=n=[n,r]:(to=i,i=u),i===o&&(i=null),i!==o?(ts=t,t=e=d(e,i)):(to=t,t=u)):(to=t,t=u),t}function t_(){var t,e,i,n,r;return t=to,(e=tx())!==o?(i=to,(n=tS())===o&&(n=null),n!==o&&(r=t_())!==o?i=n=[n,r]:(to=i,i=u),i===o&&(i=null),i!==o?(ts=t,t=e=d(e,i)):(to=t,t=u)):(to=t,t=u),t}function t8(){var t,e,i,n,r,s;return(t=to,(e=tx())!==o&&((i=tS())===o&&(i=null),i!==o&&(n=tx())!==o))?(ts=t,t=e=(r=e,[r,s=n])):(to=t,t=u),t}function tx(){var t,e,i;return t=to,(e=tA())!==o&&(ts=t,e=parseFloat(tW(i=e).join(""))),e}function tE(){var t;return(t=t0())===o&&(t=tO()),t}function tA(){var t,e,i;return t=to,(e=tR())===o&&(e=null),e!==o&&(i=t0())!==o?t=e=[e,i]:(to=t,t=u),t===o&&(t=to,(e=tR())===o&&(e=null),e!==o&&(i=tO())!==o?t=e=[e,i]:(to=t,t=u)),t}function tT(){var t;return 48===i.charCodeAt(to)?(t="0",to++):(t=o,tw(X)),t===o&&(49===i.charCodeAt(to)?(t="1",to++):(t=o,tw(j))),t}function tS(){var t,e,i,n,r;if(t=to,e=[],(i=tP())!==o)for(;i!==o;)e.push(i),i=tP();else e=u;if(e!==o){if((i=tC())===o&&(i=null),i!==o){for(n=[],r=tP();r!==o;)n.push(r),r=tP();n!==o?t=e=[e,i,n]:(to=t,t=u)}else to=t,t=u}else to=t,t=u;if(t===o){if(t=to,(e=tC())!==o){for(i=[],n=tP();n!==o;)i.push(n),n=tP();i!==o?t=e=[e,i]:(to=t,t=u)}else to=t,t=u}return t}function tC(){var t;return 44===i.charCodeAt(to)?(t=",",to++):(t=o,tw(K)),t}function t0(){var t,e,n,r,s,l,h;return t=to,(e=(r=to,(s=tO())===o&&(s=null),s!==o?(46===i.charCodeAt(to)?(l=".",to++):(l=o,tw(Y)),l!==o&&(h=tO())!==o?r=s=[s,l,h]:(to=r,r=u)):(to=r,r=u),r===o&&(r=to,(s=tO())!==o?(46===i.charCodeAt(to)?(l=".",to++):(l=o,tw(Y)),l!==o?r=s=[s,l]:(to=r,r=u)):(to=r,r=u)),r))!==o?((n=tI())===o&&(n=null),n!==o?t=e=[e,n]:(to=t,t=u)):(to=t,t=u),t===o&&(t=to,(e=tO())!==o&&(n=tI())!==o?t=e=[e,n]:(to=t,t=u)),t}function tI(){var t,e,n,r;return t=to,Q.test(i.charAt(to))?(e=i.charAt(to),to++):(e=o,tw(Z)),e!==o?((n=tR())===o&&(n=null),n!==o&&(r=tO())!==o?t=e=[e,n,r]:(to=t,t=u)):(to=t,t=u),t}function tR(){var t;return 43===i.charCodeAt(to)?(t="+",to++):(t=o,tw(J)),t===o&&(45===i.charCodeAt(to)?(t="-",to++):(t=o,tw(tt))),t}function tO(){var t,e,n,r;if(t=to,e=[],te.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(ti)),n!==o)for(;n!==o;)e.push(n),te.test(i.charAt(to))?(n=i.charAt(to),to++):(n=o,tw(ti));else e=u;return e!==o&&(ts=t,e=(r=e).join("")),e}function tP(){var t;return tn.test(i.charAt(to))?(t=i.charAt(to),to++):(t=o,tw(tr)),t}var tL=[0,0],tN=[0,0],tV=[],tB=!0,tD="";function tW(t){for(var e=[],i=0;i<t.length;i++)t[i]instanceof Array?e.push.apply(e,tW(t[i])):e.push(t[i]);return e}function tq(t,e){return -1==="mlazhvcsqt".indexOf(t)?tL=e:(tL[0]+=e[0],tL[1]+=e[1]),tD=t,tL.slice(0)}function tM(t,e){for(var i=[],n=tL.slice(0),r=0;r<e.length;r+=2){tL=n.slice(0);var o=tq(t,e.slice(r,r+2));i=i.concat(o),r==e.length-4&&(tN=o.slice(0))}return i}function tz(){-1=="CcSsQqTt".indexOf(tD)&&(tN=tL.slice(0));var t=[0,0];return t[0]=2*tL[0]-tN[0],t[1]=2*tL[1]-tN[1],t}function tk(t,e){var i=[e,0];return"H"==t&&(i[1]=tL[1]),tq(t,i)}function tH(t,e){var i=[0,e];return"V"==t&&(i[0]=tL[0]),tq(t,i)}function tU(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function tF(t,e){var i,n,r,o,s,l=1;return t[0]*e[1]-t[1]*e[0]<0&&(l=-1),l*Math.acos((i=t,n=e,r=i,o=n,r[0],o[0],r[1],o[1],tU(i),tU(n),Math.min(Math.max(val,void 0),void 0)),-1,1)}function tG(t,e,i,n,r,o,s){if(0==e||0==i){tV.push({type:"lineTo",args:s});return}var l,u,h,c,p,d,n=n*(Math.PI/180);e=Math.abs(e),i=Math.abs(i);var f,g,m=(h=(l=t,u=s,[(l[0]-u[0])/2,(l[1]-u[1])/2]),p=Math.cos(c=n),d=Math.sin(c),[p*h[0]+d*h[1],-1*d*h[0]+p*h[1]]),$=(f=m,g=m,[f[0]*g[0],f[1]*g[1]]),v=Math.pow(e,2),_=Math.pow(i,2),E=Math.sqrt($[0]/v+$[1]/_);E>1&&(e*=E,i*=E,v=Math.pow(e,2),_=Math.pow(i,2));var A,T,S=Math.sqrt(Math.abs(v*_-v*$[1]-_*$[0])/(v*$[1]+_*$[0]));r==o&&(S*=-1);var C,I,R,O,P,L,N,V,B=(A=S,[A*(T=[e*m[1]/i,-i*m[0]/e])[0],A*T[1]]),D=(N=(C=B,R=Math.cos(I=n),O=Math.sin(I),[R*C[0]-O*C[1],O*C[0]+R*C[1]]),V=(P=t,L=s,[(P[0]+L[0])/2,(P[1]+L[1])/2]),[N[0]+V[0],N[1]+V[1]]),W=[(m[0]-B[0])/e,(m[1]-B[1])/i],q=[(-1*m[0]-B[0])/e,(-1*m[1]-B[1])/i],M=tF([1,0],W),k=tF(W,q);tV.push({type:"save",args:[]},{type:"translate",args:[D[0],D[1]]},{type:"rotate",args:[n]},{type:"scale",args:[e,i]},{type:"arc",args:[0,0,1,M,M+k,1-o]},{type:"restore",args:[]})}if((n=l())!==o&&to===i.length)return n;throw n!==o&&to<i.length&&tw({type:"end",description:"end of input"}),t$(null,th,tu)}}}();var i=["closePath","moveTo","lineTo","quadraticCurveTo","bezierCurveTo","rect","arc","arcTo","ellipse","isPointInPath","isPointInStroke",];function n(t){return function(){this.ops_.push({type:t,args:Array.prototype.slice.call(arguments,0)})}}for(var r=0;r<i.length;r++){var o=i[r];e.prototype[o]=n(o)}e.prototype.addPath=function(t,e){var i=!1;e&&void 0!=e.a&&void 0!=e.b&&void 0!=e.c&&void 0!=e.d&&void 0!=e.e&&void 0!=e.f&&(i=!0,this.ops_.push({type:"save",args:[]}),this.ops_.push({type:"transform",args:[e.a,e.b,e.c,e.d,e.e,e.f]})),this.ops_=this.ops_.concat(t.ops_),i&&this.ops_.push({type:"restore",args:[]})},original_fill=t.prototype.fill,original_stroke=t.prototype.stroke,original_clip=t.prototype.clip,original_is_point_in_path=t.prototype.isPointInPath,original_is_point_in_stroke=t.prototype.isPointInStroke,t.prototype.fill=function(i){if(i instanceof e){this.beginPath();for(var n=0,r=i.ops_.length;n<r;n++){var o=i.ops_[n];t.prototype[o.type].apply(this,o.args)}original_fill.apply(this,Array.prototype.slice.call(arguments,1))}else original_fill.apply(this,arguments)},t.prototype.stroke=function(i){if(i instanceof e){this.beginPath();for(var n=0,r=i.ops_.length;n<r;n++){var o=i.ops_[n];t.prototype[o.type].apply(this,o.args)}original_stroke.call(this)}else original_stroke.call(this)},t.prototype.clip=function(i){if(i instanceof e){this.beginPath();for(var n=0,r=i.ops_.length;n<r;n++){var o=i.ops_[n];t.prototype[o.type].apply(this,o.args)}original_clip.apply(this,Array.prototype.slice.call(arguments,1))}else original_clip.apply(this,arguments)},t.prototype.isPointInPath=function(i){if(!(i instanceof e))return original_is_point_in_path.apply(this,arguments);this.beginPath();for(var n=0,r=i.ops_.length;n<r;n++){var o=i.ops_[n];t.prototype[o.type].apply(this,o.args)}return original_is_point_in_path.apply(this,Array.prototype.slice.call(arguments,1))},t.prototype.isPointInStroke=function(i){if(!(i instanceof e))return original_is_point_in_stroke.apply(this,arguments);this.beginPath();for(var n=0,r=i.ops_.length;n<r;n++){var o=i.ops_[n];t.prototype[o.type].apply(this,o.args)}return original_is_point_in_stroke.apply(this,Array.prototype.slice.call(arguments,1))},Path2D=e}()}("undefined"==typeof CanvasRenderingContext2D?void 0:CanvasRenderingContext2D,"undefined"==typeof require?void 0:require),function(t){"use strict";var e=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,i=t.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),n=i&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),r=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,s=(i||r)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(t){var e,s,l,u,h,c,p,d,f;if(!(e=t.match(o)))throw Error("invalid data URI");for(d=0,s=e[2]?e[1]:"text/plain"+(e[3]||";charset=US-ASCII"),l=!!e[4],u=t.slice(e[0].length),h=l?atob(u):decodeURIComponent(u),c=new ArrayBuffer(h.length),p=new Uint8Array(c);d<h.length;d+=1)p[d]=h.charCodeAt(d);return i?new Blob([n?p:c],{type:s}):((f=new r).append(c),f.getBlob(s))};t.HTMLCanvasElement&&!e.toBlob&&(e.mozGetAsFile?e.toBlob=function(t,i,n){var r=this;setTimeout(function(){n&&e.toDataURL&&s?t(s(r.toDataURL(i,n))):t(r.mozGetAsFile("blob",i))})}:e.toDataURL&&s&&(e.msToBlob?e.toBlob=function(t,i,n){var r=this;setTimeout(function(){(i&&"image/png"!==i||n)&&e.toDataURL&&s?t(s(r.toDataURL(i,n))):t(r.msToBlob(i))})}:e.toBlob=function(t,e,i){var n=this;setTimeout(function(){t(s(n.toDataURL(e,i)))})})),"function"==typeof define&&define.amd?define(function(){return s}):"object"==typeof module&&module.exports?module.exports=s:t.dataURLtoBlob=s}(window),Point.prototype.move=function(t,e){this.x=t,this.y=e},Point.prototype.translate=function(t,e){this.x+=t,this.y+=e},Point.prototype.calcDistanceTo=function(t){return t&&"Point"===t.constructor.name?Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)):Number.NaN},Point.prototype.equals=function(t){return!!t&&"Point"===t.constructor.name&&t.x===this.x&&t.y===this.y},FloatPoint.prototype.constructor=FloatPoint,FloatPoint.prototype=Object.create(Point.prototype),FloatPoint.prototype.move=function(t,e,i){Object.getPrototypeOf(FloatPoint.prototype).move.call(this,t,e),this.z=i},FloatPoint.prototype.translate=function(t,e,i){Object.getPrototypeOf(FloatPoint.prototype).translate.call(this,t,e),this.z+=i},FloatPoint.prototype.calcDistanceTo=function(t){return t&&"FloatPoint"===t.constructor.name?Math.sqrt(pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)+Math.pow(this.z-t.z,2)):Number.NaN},FloatPoint.prototype.toPoint=function(){return new Point(this.x,this.y)},FloatPoint.prototype.equals=function(t){return!!t&&"FloatPoint"===t.constructor.name&&t.x===this.x&&t.y===this.y&&t.z===this.z},FloatPoint.prototype.findXYGrad=function(t){return t&&"FloatPoint"===t.constructor.name?(this.y-t.y)/(this.x-t.x):Number.NaN},FloatPoint.prototype.findXZGrad=function(t){return t&&"FloatPoint"===t.constructor.name?(this.z-t.z)/(this.x-t.x):Number.NaN},FloatPoint.prototype.findYZGrad=function(t){return t&&"FloatPoint"===t.constructor.name?(this.z-t.z)/(this.y-t.y):Number.NaN},FloatPoint.prototype.liesBetween=function(t,e){if(t&&"FloatPoint"===t.constructor.name&&e&&"FloatPoint"===e.constructor.name){var i=t.x<=x&&e.x>=this.x||e.x<=x&&t.x>=this.x,n=t.y<=y&&e.y>=this.y||e.y<=y&&t.y>=this.y,r=t.z<=z&&e.z>=this.z||e.z<=z&&t.z>=this.z;return i&&n&&r&&isCollinearWith(t,e)}return!1},Line.prototype.getX=function(t){return"number"==typeof t?(t-this.c)/this.m:Number.NaN},Line.prototype.getY=function(t){return"number"==typeof t?this.m*t+this.c:Number.NaN},Line.prototype.distance=function(t,e){return t&&"Point"===t.constructor.name&&e&&"Point"===e.constructor.name&&this.passesThroughPoint(t)&&this.passesThroughPoint(e)?e.calcDistanceTo(t):Number.NaN},Line.prototype.distanceF=function(t,e){return t&&"FloatPoint"===t.constructor.name&&e&&"FloatPoint"===e.constructor.name&&this.passesThroughPoint(t)&&this.passesThroughPoint(e)?e.calcDistanceTo(t):Number.NaN},Line.prototype.distanceSquared=function(t,e){if(t&&"FloatPoint"===t.constructor.name&&e&&"FloatPoint"===e.constructor.name&&this.passesThroughPoint(t)&&this.passesThroughPoint(e)){var i=e.calcDistanceTo(t);return i*i}return Number.NaN},Line.prototype.intersectsLine=function(t){return!this.isParallelTo(t)},Line.prototype.isParallelTo=function(t){return approxEquals(this.m,t.m)},Line.prototype.passesThroughPoint=function(t){return!!t&&"Point"===t.constructor.name&&approxEquals(t.y,this.m*t.x+this.c)},Line.prototype.passesThroughPointF=function(t){if(t&&"FloatPoint"===t.constructor.name)return approxEquals(t.y,this.m*t.x+this.c)},Line.prototype.intersectionWithLine=function(t){if(t&&"Line"===t.constructor.name){var e=-1*(this.c-t.c)/(this.m-t.m),i=this.m*e+this.c;return new FloatPoint(e,i)}return null},Line.prototype.draw=function(t,e,i,n,r){if("string"==typeof t&&"number"==typeof e&&"number"==typeof i&&"string"==typeof n&&"number"==typeof r){var o=document.getElementById(t),s=o.getContext("2d");o.width,o.height;let l=this.getY(e),u=this.getY(i);s.beginPath(),s.strokeStyle=n,s.lineWidth=r,s.moveTo(e,l),s.lineTo(i,u),s.stroke()}else logger("Invalid Line draw args")},Dimension.prototype.scale=function(t){"number"==typeof t&&(this.width*=t,this.height*=t)},Dimension.prototype.getScaledInstance=function(t){if("number"==typeof t){var e=this.width*t,i=this.height*t;return new Dimension(e,i)}return null},Quadratic.prototype.solve=function(){var t=this.a,e=this.b,i=this.c;return Math.pow(e,2)-4*t*i>=0?-e/(2*t)+Math.sqrt(Math.pow(e,2)-4*t*i)/(2*t)+" , "+(-e/(2*t)-Math.sqrt(Math.pow(e,2)-4*t*i)/(2*t)):pow(e,2)-4*t*i<0?-e/(2*t)+" + "+Math.sqrt(4*t*i-Math.pow(e,2))/(2*t)+" i , "+-e/(2*t)+" - "+Math.sqrt(4*t*i-Math.pow(e,2))/(2*t)+" i":void 0},Quadratic.prototype.solutionArray=function(){var t=this.a,e=this.b,i=this.c,n=[];return Math.pow(e,2)-4*t*i>=0?(n.push(-e/(2*t)+Math.sqrt(Math.pow(e,2)-4*t*i)/(2*t)),n.push(-e/(2*t)-Math.sqrt(Math.pow(e,2)-4*t*i)/(2*t))):pow(e,2)-4*t*i<0&&(n.push(-e/(2*t)+" + "+Math.sqrt(4*t*i-Math.pow(e,2))/(2*t)+" i"),n.push(-e/(2*t)+" - "+Math.sqrt(4*t*i-Math.pow(e,2))/(2*t)+" i")),n},Rectangle.prototype.right=function(){return this.left+this.width},Rectangle.prototype.bottom=function(){return this.top+this.height},Rectangle.prototype.centerX=function(){return this.left+this.width/2},Rectangle.prototype.centerY=function(){return this.top+this.height/2},Rectangle.prototype.setLocation=function(t,e){"number"==typeof t&&"number"==typeof e&&(this.left=t,this.top=e)},Rectangle.prototype.getLocation=function(){return new Point(this.left,this.top)},Rectangle.prototype.translate=function(t,e){var i=this.left,n=i+t;t<0?n>i&&(this.width>=0&&(this.width+=n-Number.MIN_VALUE),n=Number.MIN_VALUE):n<i&&(this.width>=0&&(this.width+=n-Number.MAX_VALUE,this.width<0&&(this.width=Number.MAX_VALUE)),n=Number.MAX_VALUE),this.left=n,n=(i=this.top)+e,e<0?n>i&&(this.height>=0&&(this.height+=n-Number.MIN_VALUE),n=Number.MIN_VALUE):n<i&&(this.height>=0&&(this.height+=n-Number.MAX_VALUE,this.height<0&&(this.height=Number.MAX_VALUE)),n=Number.MAX_VALUE),this.top=n},Rectangle.prototype.getSize=function(){return new Dimension(this.width,this.height)},Rectangle.prototype.setSize=function(t){"Dimension"===t.constructor.name&&(this.width=t.width,this.height=t.height)},Rectangle.prototype.containsPoint=function(t,e){if("number"==typeof t&&"number"==typeof e){var i=this.width,n=this.height;if((i|n)<0)return!1;var r=this.left,o=this.top;return!(t<r)&&!(e<o)&&(i+=r,n+=o,(i<r||i>t)&&(n<o||n>e))}return!1},Rectangle.prototype.contains=function(t){if("Rectangle"===t.constructor.name){var e=t.left,i=t.top,n=t.width,r=t.height,o=this.width,s=this.height;if((o|s|n|r)<0)return!1;var l=this.left,u=this.top;if(e<l||i<u)return!1;if(o+=l,(n+=e)<=e){if(o>=l||n>o)return!1}else if(o>=l&&n>o)return!1;if(s+=u,(r+=i)<=i){if(s>=u||r>s)return!1}else if(s>=u&&r>s)return!1;return!0}return!1},Rectangle.prototype.intersects=function(t){if("Rectangle"===t.constructor.name){let e=t.left,i=t.right(),n=t.top,r=t.bottom();if(this.left<i&&e<this.right&&this.top<r&&n<this.bottom)return this.left<e&&(this.left=e),this.top<n&&(this.top=n),this.right>i&&(this.right=i),this.bottom>r&&(this.bottom=r),!0}return!1},Rectangle.prototype.intersection=function(t){if("Rectangle"===t.constructor.name){var e=this.left,i=this.top,n=t.left,r=t.top,o=e;o+=this.width;var s=i;s+=this.height;var l=n;l+=t.width;var u=r;return u+=t.height,e<n&&(e=n),i<r&&(i=r),o>l&&(o=l),s>u&&(s=u),o-=e,s-=i,o<Number.MIN_VALUE&&(o=Number.MIN_VALUE),s<Number.MIN_VALUE&&(s=Number.MIN_VALUE),new Rectangle(e,i,o,s)}return null},Rectangle.prototype.union=function(t){if("Rectangle"===t.constructor.name){var e=this.width,i=this.height;if((e|i)<0)return new Rectangle(t);var n=t.width,r=t.height;if((n|r)<0)return new Rectangle(this);var o=this.left,s=this.top;e+=o,i+=s;var l=t.left,u=t.top;return n+=l,r+=u,o>l&&(o=l),s>u&&(s=u),e<n&&(e=n),i<r&&(i=r),e-=o,i-=s,e>Number.MAX_VALUE&&(e=Number.MAX_VALUE),i>Number.MAX_VALUE&&(i=Number.MAX_VALUE),new Rectangle(o,s,e,i)}return null},Rectangle.prototype.draw=function(t,e,i){if("string"==typeof t&&"string"==typeof e&&"number"==typeof i){var n=document.getElementById(t).getContext("2d");n.beginPath(),n.lineWidth=i,n.strokeStyle=e,n.rect(this.left,this.top,this.width,this.height),n.stroke()}else logger("Invalid Rectangle draw args")},Rectangle.prototype.fill=function(t,e,i){if("string"==typeof t&&"string"==typeof e&&"number"==typeof i){var n=document.getElementById(t).getContext("2d");n.beginPath(),n.lineWidth=i,n.strokeStyle=e,n.fillRect(this.left,this.top,this.width,this.height),n.stroke()}else logger("Invalid Rectangle draw args")},EllipseModel.prototype.getBiggestRectangle=function(){var t=new Rectangle;return t.x=this.center.x-.5*this.size.width*Math.sqrt(2),t.y=this.center.y-.5*this.size.height*Math.sqrt(2),t.width=this.size.width*Math.sqrt(2),t.height=this.size.height*Math.sqrt(2),t},EllipseModel.prototype.area=function(){return Math.PI*this.size.width*this.size.height},EllipseModel.prototype.getX=function(t){var e=[],i=Math.pow((t-this.center.y)/this.size.height,2);return e.push(this.center.x+this.size.width*sqrt(1-i)),e.push(this.center.x-this.size.width*sqrt(1-i)),e},EllipseModel.prototype.getY=function(t){var e=[],i=pow((t-this.center.x)/this.size.width,2);return e.push(this.center.y+this.size.height*sqrt(1-i)),e.push(this.center.y-this.size.height*sqrt(1-i)),e},EllipseModel.prototype.isOnEllipse=function(t){return approxEquals(Math.pow((t.x-this.center.x)/this.size.width,2)+Math.pow((t.y-this.center.y)/this.size.height,2),1)},EllipseModel.prototype.contains=function(t){if("FloatPoint"!==t.constructor.name)return!1;var e=new Line(t,this.center),i=0,n=0,r=0,o=0,s=lineIntersection(e);i=parseFloat(s[0]),n=parseFloat(s[1]),r=parseFloat(s[2]),o=parseFloat(s[3]);var l=i<=t.x&&r>=t.x||r<=t.x&&i>=t.x,u=n<=t.y&&o>=t.y||o<=t.y&&n>=t.y;return l&&u},EllipseModel.prototype.lineIntersection=function(t){if("Line"===t.constructor.name){var e=[],i=t.m,n=t.c,r=pow(this.size.height,2)+pow(this.size.width*i,2),o=2*(pow(this.size.width,2)*i*(n-this.center.y)-pow(this.size.height,2)*this.center.x),s=pow(this.center.x*this.size.height,2)+pow(this.size.width,2)*(pow(n-this.center.y,2)-pow(this.size.height,2)),l=new Quadratic(r,o,s).solutionArray();try{e[0]=l[0],e[1]=l[1],e[2]=String.valueOf(i*parseFloat(l[0])+n),e[3]=String.valueOf(i*parseFloat(l[1])+n);var l=[];l[0].push(e[0]),l[1].push(e[2]),l[2].push(e[1]),l[3].push(e[3])}catch(u){l=null,e=null}return l}return null},EllipseModel.prototype.intersectsWithLine=function(t){if("Line"===t.constructor.name){var e=!1;try{for(var i=lineIntersection(t),n=0;n<i.length;n++)i[n],e=!0}catch(r){e=!1}return e}return!1},EllipseModel.prototype.isBiggerThan=function(t){return this.area()>t.area()},EllipseModel.prototype.isSmallerThan=function(t){return this.area()<t.area()},EllipseModel.prototype.hasAlmostSameSizeAs=function(t){return approxEquals(this.area(),t.area())},EllipseModel.prototype.hasSameSizeAs=function(t){return this.area()===t.area()},EllipseModel.prototype.intersection=function(t){var e=new FloatPoint(t.x,t.y),i=t.getSize(),n=e.x,r=e.y,o=this.center.x,s=this.center.y,l=i.width,u=i.height,h=getWidth(),c=getHeight(),p=[],d=[new FloatPoint,new FloatPoint],f=[new FloatPoint,new FloatPoint],g=[new FloatPoint,new FloatPoint],m=[new FloatPoint,new FloatPoint],$=0;try{$=h*sqrt(1-pow((r-s)/c,2)),d[0].x=o+$,d[0].y=r,d[1].x=o-$,d[1].y=r,null===d[0]||Number.isNaN(d[0].x)||Number.isNaN(d[0].y)||p.add(d[0]),null===d[1]||Number.isNaN(d[1].x)||Number.isNaN(d[1].y)||p.add(d[1])}catch(v){}try{$=h*Math.sqrt(1-pow((r+u-s)/c,2)),f[0].x=o+$,f[0].y=r+u,f[1].x=o-$,f[1].y=r+u,null===f[0]||Number.isNaN(f[0].x)||Number.isNaN(f[0].y)||p.add(f[0]),null===f[1]||Number.isNaN(f[1].x)||Number.isNaN(f[1].y)||p.add(f[1])}catch(_){}try{$=c*Math.sqrt(1-pow((n-o)/h,2)),g[0].x=n,g[0].y=s+$,g[1].x=n,g[1].y=s-$,null===g[0]||Number.isNaN(g[0].x)||Number.isNaN(g[0].y)||p.add(g[0]),null===g[1]||Number.isNaN(g[1].x)||Number.isNaN(g[1].y)||p.add(g[1])}catch(E){}try{$=c*sqrt(1-pow((n+l-o)/h,2)),m[0].x=n+l,m[0].y=s+$,m[1].x=n+l,m[1].y=s-$,null===m[0]||Number.isNaN(m[0].x)||Number.isNaN(m[0].y)||p.add(m[0]),null===m[1]||Number.isNaN(m[1].x)||Number.isNaN(m[1].y)||p.add(m[1])}catch(A){}return p},EllipseModel.prototype.intersectsWithRect=function(t){var e=new FloatPoint(t.x,t.y),i=t.getSize(),n=e.x,r=e.y,o=getXCenter(),s=getYCenter(),l=i.getWidth(),u=i.height,h=getWidth(),c=getHeight(),p=[new FloatPoint,new FloatPoint],d=[new FloatPoint,new FloatPoint],f=[new FloatPoint,new FloatPoint],g=[new FloatPoint,new FloatPoint],m=0,$=!1,v=!1,_=!1,E=!1;try{m=h*Math.sqrt(1-pow((r-s)/c,2)),p[0].x=o+m,p[0].y=r,p[1].x=o-m,p[1].y=r,(t.containsPoint(p[0].x,p[0].y)&&this.contains(p[0])||t.containsPoint(p[1].x,p[1].y)&&this.contains(p[1]))&&($=!0)}catch(A){}try{m=h*Math.sqrt(1-pow((r+u-s)/c,2)),d[0].x=o+m,d[0].y=r+u,d[1].x=o-m,d[1].y=r+u,(t.containsPoint(d[0].x,d[0].y)&&this.contains(d[0])||t.containsPoint(d[1].x,d[1].y)&&this.contains(d[1]))&&(v=!0)}catch(T){}try{m=c*Math.sqrt(1-pow((n-o)/h,2)),f[0].x=n,f[0].y=s+m,f[1].x=n,f[1].y=s-m,(t.containsPoint(f[0].x,f[0].y)&&this.contains(f[0])||t.containsPoint(f[1].x,f[1].y)&&this.contains(f[1]))&&(_=!0)}catch(S){}try{m=c*Math.sqrt(1-pow((n+l-o)/h,2)),g[0].x=n+l,g[0].y=s+m,g[1].x=n+l,g[1].y=s-m,(t.containsPoint(g[0].x,g[0].y)&&this.contains(g[0])||t.containsPoint(g[1].x,g[1].y)&&this.contains(g[1]))&&(E=!0)}catch(C){}return $||v||_||E},EllipseModel.prototype.intersectsWith=function(t){var e=new Line(this.center,t.center);if(this.center.equals(t.center))return!0;var i=t.lineIntersection(e);try{var n=new FloatPoint(parseFloat(i[0]),parseFloat(i[1])),r=new FloatPoint(parseFloat(i[2]),parseFloat(i[3]));if(this.contains(n)||this.contains(r))return!0;return!1}catch(o){return!1}},Random.prototype.nextInt=function(t){return randomInt(0,t-1)},Random.prototype.nextBool=function(){return 1===randomInt(0,1)},Random.prototype.generateUUID=function(){var t=new Date().getTime(),e=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var n=16*Math.random();return t>0?(n=(t+n)%16|0,t=Math.floor(t/16)):(n=(e+n)%16|0,e=Math.floor(e/16)),("x"===i?n:3&n|8).toString(16)})};const PIXEL_RATIO=function(){let t=document.createElement("canvas").getContext("2d"),e;return(window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}(),Gravity={LEFT:"left",RIGHT:"right",CENTER:"center"},FontStyle={REGULAR:"normal",OBLIQUE:"oblique",ITALIC:"italic",BOLD:"bold",BOLDER:"bolder",LIGHTER:"lighter",REGULAR_100:"100",REGULAR_200:"200",REGULAR_300:"300",REGULAR_400:"400",REGULAR_500:"500",REGULAR_600:"600",REGULAR_700:"700",REGULAR_800:"800",REGULAR_900:"900",ITALIC_100:"italic 100",ITALIC_200:"italic 200",ITALIC_300:"italic 300",ITALIC_400:"italic 400",ITALIC_500:"italic 500",ITALIC_600:"italic 600",ITALIC_700:"italic 700",ITALIC_800:"italic 800",ITALIC_900:"italic 900",OBLIQUE_100:"oblique 100",OBLIQUE_200:"oblique 200",OBLIQUE_300:"oblique 300",OBLIQUE_400:"oblique 400",OBLIQUE_500:"oblique 500",OBLIQUE_600:"oblique 600",OBLIQUE_700:"oblique 700",OBLIQUE_800:"oblique 800",OBLIQUE_900:"oblique 900",BOLD_ITALIC:"italic bold",BOLDER_ITALIC:"italic bolder",LIGHTER_ITALIC:"italic lighter",BOLD_OBLIQUE:"oblique bold",BOLDER_OBLIQUE:"oblique bolder",LIGHTER_OBLIQUE:"oblique lighter"},FontStyleValues=getObjectValues(FontStyle).sort(function(t,e){return e.length-t.length});function Polygon(t,e,i){if(this.bounds=new Rectangle,t&&e&&t.length!==e.length){logger("xpoints and ypoints must have the same size.");return}"[object Array]"!==Object.prototype.toString.call(t)?(logger("xpoints must be an array of integer numbers"),this.xpoints=[]):this.xpoints=t,"[object Array]"!==Object.prototype.toString.call(e)?(logger("ypoints must be an array of integer numbers"),this.ypoints=[]):this.ypoints=e,"number"!=typeof i?(logger("npoints must be an integer number"),i=this.xpoints.length):this.npoints=i}function Font(t,e,i,n,r){this.style=t,this.size=e,this.name=i,this.variant=r||null,void 0===n?this.sizeUnits=CssSizeUnits.EM:this.sizeUnits=n}function Graphics(t,e){let i,n=PIXEL_RATIO;if(2===arguments.length){if(("number"!=typeof t||"number"!=typeof e)&&("string"!=typeof t||"string"!=typeof e||isNaN(t=parseInt(t))||isNaN(t=parseInt(e))))throw"Supply the width and height in css pixels!";(i=document.createElement("canvas")).style.width=t+"px",i.style.height=e+"px",i.width=t*n,i.height=e*n,i.style.visibility="hidden",i.setAttribute("id","canvas-"+ULID.ulid()),document.body.appendChild(i)}else if("canvas"===t.nodeName.toLowerCase()){let r=(i=t).getBoundingClientRect();i.width=Math.round(r.right*n)-Math.round(r.left*n),i.height=Math.round(r.bottom*n)-Math.round(r.top*n),i.style.width=r.width+"px",i.style.height=r.height+"px"}else throw"Supply either the width and height(in css pixels), or supply a canvas element to build the graphics on!";this.ctx=i.getContext("2d"),this.ctx.scale(n,n),this.ctx.strokeStyle="#000",this.ctx.lineWidth=1,this.ctx.globalAlpha=1,this.ctx.fillStyle="#FFF",this.ctx.font="bold 0.9em Arial",this.width=i.width,this.height=i.height,this.imageCacheUnitPx=this.createImageData(1,1),this.imageCacheQuadPx=this.createImageData(2,2)}function LineAndWidth(t,e){if("string"!=typeof t||"number"!=typeof e){this.text="",this.width=0;return}this.text=t,this.width=e}Polygon.prototype.addPoint=function(t,e){if("number"!=typeof t)throw"x must be an integer number";if("number"!=typeof e)throw"y must be an integer number";this.xpoints.push(t),this.ypoints.push(e),this.npoints+=1},Polygon.prototype.addPoints=function(t,e){if("[object Array]"!==Object.prototype.toString.call(t)){logger("xpts must be an array of integer numbers");return}if("[object Array]"!==Object.prototype.toString.call(e)){logger("ypts must be an array of integer numbers");return}t.length===e.length?(Array.prototype.push.apply(this.xpoints,t),Array.prototype.push.apply(this.ypoints,e),this.npoints+=t.length):logger("xpts and ypts must have the same length")},Polygon.prototype.contains=function(t,e){if(this.npoints<=2||!this.getBoundingBox().contains(t,e))return!1;for(var i,n,r,o,s,l=0,u=xpoints[npoints-1],h=ypoints[npoints-1],c=0;c<npoints;c++)if(i=xpoints[c],(n=ypoints[c])!==h){if(i<u){if(t>=u)continue;r=i}else{if(t>=i)continue;r=u}if(n<h){if(e<n||e>=h)continue;if(t<r){l++;continue}o=t-i,s=e-n}else{if(e<h||e>=n)continue;if(t<r){l++;continue}o=t-u,s=e-h}o<s/(h-n)*(u-i)&&l++}return u=i,h=n,(1&l)!=0},Polygon.prototype.getBoundingBox=function(){return 0===this.npoints?new Rectangle:(null===bounds&&this.calculateBounds(this.xpoints,this.ypoints,this.npoints),this.bounds.getBounds())},Polygon.prototype.calculateBounds=function(t,e,i){if("[object Array]"!==Object.prototype.toString.call(t)){logger("xpts must be an array of integer numbers");return}if("[object Array]"!==Object.prototype.toString.call(e)){logger("ypts must be an array of integer numbers");return}"number"!=typeof i&&logger("npts must be an integer number");for(var n=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MIN_VALUE,s=Number.MIN_VALUE,l=0;l<npoints;l++){var u=t[l];n=Math.min(n,u),o=Math.max(o,u);var h=e[l];r=Math.min(r,h),s=Math.max(s,h)}this.bounds=new Rectangle(n,r,o,s)},Polygon.prototype.updateBounds=function(t,e){t<this.bounds.x?(this.bounds.width=this.bounds.width+(this.bounds.x-t),this.bounds.x=t):this.bounds.width=Math.max(this.bounds.width,t-this.bounds.x),e<this.bounds.y?(this.bounds.height=this.bounds.height+(this.bounds.y-e),this.bounds.y=e):this.bounds.height=Math.max(this.bounds.height,e-this.bounds.y)},Font.prototype.string=function(){return this.variant&&"normal"!==this.variant?this.variant+" "+this.style+" "+this.size*PIXEL_RATIO+this.sizeUnits+" "+this.name:this.style+" "+this.size*PIXEL_RATIO+this.sizeUnits+" "+this.name},Font.prototype.getSize=function(){return this.size},createHiDPICanvas=function(t,e,i,n){return n||(n=PIXEL_RATIO),t.width=e*n,t.height=i*n,t.style.width=e+"px",t.style.height=i+"px",t.getContext("2d").setTransform(n,0,0,n,0,0),t},Graphics.prototype.destroy=function(){this.ctx.canvas=null,this.ctx=null,this.width=this.height=null},Graphics.prototype.clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},Graphics.prototype.getCanvas=function(){return this.ctx.canvas},Graphics.prototype.reloadCanvas=function(t,e){this.ctx.scale(1/PIXEL_RATIO,1/PIXEL_RATIO);let i=this.getCanvas();if(t){if("number"!=typeof t)throw"The width must be a number in pixels";i.style.width=t+"px"}else t=i.getBoundingClientRect().width;if(e){if("number"!=typeof e)throw"The height must be a number in pixels";i.style.height=e+"px"}else e=i.getBoundingClientRect().height;i.width=t*PIXEL_RATIO,i.height=e*PIXEL_RATIO,this.width=i.width,this.height=i.height,this.ctx.scale(PIXEL_RATIO,PIXEL_RATIO)},Graphics.prototype.scale=function(t,e){this.ctx.scale(t,e)},Graphics.prototype.setFont=function(t){"Font"===t.constructor.name&&(this.ctx.font=t.string())},Graphics.prototype.getFont=function(){return this.ctx.font},Graphics.prototype.scaleFontUpByDPR=function(){this.ctx.font=this.ctx.font.replace(/(\d+)(px|em|rem|pt)/g,function(t,e,i){return e*PIXEL_RATIO+i})},Graphics.prototype.scaleFontDownByDPR=function(){this.ctx.font=this.ctx.font.replace(/(\d+)(px|em|rem|pt)/g,function(t,e,i){return e/PIXEL_RATIO+i})},Graphics.prototype.rotate=function(t){if(t){if("number"==typeof t)this.ctx.rotate(t);else throw"Invalid angle specified!"}else throw"No angle specified!"},Graphics.prototype.rotateDegs=function(t){this.rotate(t*Math.PI/180)},Graphics.prototype.rotateAt=function(t,e,i,n){if("number"==typeof t){if(this.ctx.save(),this.ctx.translate(e,i),this.ctx.rotate(t),"function"==typeof n&&n(),this.ctx.restore(),"function"!=typeof n)throw"`task` should be a function!"}else throw"Invalid angle specified!"},Graphics.prototype.rotateDegsAt=function(t,e,i,n){if(0===t){n();return}this.rotateAt(t*Math.PI/180,e,i,n)},Graphics.prototype.setColor=function(t){"string"==typeof t&&(this.ctx.strokeStyle=t)},Graphics.prototype.setBackground=function(t){"string"==typeof t&&(this.ctx.fillStyle=t)},Graphics.prototype.setTextBaseLine=function(t){this.ctx.textBaseline=t},Graphics.prototype.setTextAlign=function(t){this.ctx.textAlign=t},Graphics.prototype.setStrokeWidth=function(t){"number"==typeof t&&(this.ctx.lineWidth=t)},Graphics.prototype.getStrokeWidth=function(){return this.ctx.lineWidth},Graphics.prototype.getStrokeColor=function(){return this.ctx.strokeStyle},Graphics.prototype.getFillColor=function(){return this.ctx.fillStyle},Graphics.prototype.setAlpha=function(t){"number"==typeof t&&(this.ctx.globalAlpha=t)},Graphics.prototype.getAlpha=function(){return this.ctx.globalAlpha},Graphics.prototype.lineJoinStyle=function(t){"string"==typeof t&&(this.ctx.lineJoin=t)},Graphics.prototype.lineCapStyle=function(t){"string"==typeof t&&(this.ctx.lineCap=t)},Graphics.prototype.normalizeQuantity=function(t){if("number"==typeof t)return t*PIXEL_RATIO;throw Error("Only numbers can be normalized")},Graphics.prototype.drawRect=function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&this.ctx.strokeRect(t,e,PIXEL_RATIO*i,PIXEL_RATIO*n)},Graphics.prototype.fillRect=function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&this.ctx.fillRect(t,e,PIXEL_RATIO*i,PIXEL_RATIO*n)},Graphics.prototype.drawPoint=function(t,e){"number"==typeof t&&"number"==typeof e&&(this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(t+.1,e),this.ctx.closePath(),this.ctx.stroke())},Graphics.prototype.beginPath=function(){this.ctx.beginPath()},Graphics.prototype.moveTo=function(t,e){"number"==typeof t&&"number"==typeof e&&this.ctx.moveTo(t,e)},Graphics.prototype.lineTo=function(t,e){"number"==typeof t&&"number"==typeof e&&this.ctx.lineTo(t,e)},Graphics.prototype.closePath=function(){this.ctx.closePath()},Graphics.prototype.stroke=function(){this.ctx.stroke()},Graphics.prototype.fill=function(){this.ctx.fill()},Graphics.prototype.drawRoundRect=function(t,e,i,n,r){if("number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r){if(void 0===r&&(r=5),"number"==typeof r)r={tl:r,tr:r,br:r,bl:r};else{var o={tl:0,tr:0,br:0,bl:0};for(var s in o)r[s]=r[s]||o[s]}this.ctx.beginPath(),this.ctx.moveTo(t+r.tl,e),this.ctx.lineTo(t+i-r.tr,e),this.ctx.quadraticCurveTo(t+i,e,t+i,e+r.tr),this.ctx.lineTo(t+i,e+n-r.br),this.ctx.quadraticCurveTo(t+i,e+n,t+i-r.br,e+n),this.ctx.lineTo(t+r.bl,e+n),this.ctx.quadraticCurveTo(t,e+n,t,e+n-r.bl),this.ctx.lineTo(t,e+r.tl),this.ctx.quadraticCurveTo(t,e,t+r.tl,e),this.ctx.closePath(),this.ctx.stroke()}},Graphics.prototype.fillRoundRect=function(t,e,i,n,r){if("number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r){if("undefined"==typeof stroke&&(stroke=!0),void 0===r&&(r=5),"number"==typeof r)r={tl:r,tr:r,br:r,bl:r};else{var o={tl:0,tr:0,br:0,bl:0};for(var s in o)r[s]=r[s]||o[s]}this.ctx.beginPath(),this.ctx.moveTo(t+r.tl,e),this.ctx.lineTo(t+i-r.tr,e),this.ctx.quadraticCurveTo(t+i,e,t+i,e+r.tr),this.ctx.lineTo(t+i,e+n-r.br),this.ctx.quadraticCurveTo(t+i,e+n,t+i-r.br,e+n),this.ctx.lineTo(t+r.bl,e+n),this.ctx.quadraticCurveTo(t,e+n,t,e+n-r.bl),this.ctx.lineTo(t,e+r.tl),this.ctx.quadraticCurveTo(t,e,t+r.tl,e),this.ctx.fill()}},Graphics.prototype.fillRoundRectLeftSide=function(t,e,i,n,r){if("number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r){if("undefined"==typeof stroke&&(stroke=!0),void 0===r&&(r=5),"number"==typeof r)r={tl:r,tr:0,br:0,bl:r};else{var o={tl:0,tr:0,br:0,bl:0};for(var s in o)r[s]=r[s]||o[s]}this.ctx.beginPath(),this.ctx.moveTo(t+r.tl,e),this.ctx.lineTo(t+i-r.tr,e),this.ctx.quadraticCurveTo(t+i,e,t+i,e+r.tr),this.ctx.lineTo(t+i,e+n-r.br),this.ctx.quadraticCurveTo(t+i,e+n,t+i-r.br,e+n),this.ctx.lineTo(t+r.bl,e+n),this.ctx.quadraticCurveTo(t,e+n,t,e+n-r.bl),this.ctx.lineTo(t,e+r.tl),this.ctx.quadraticCurveTo(t,e,t+r.tl,e),this.ctx.fill()}},Graphics.prototype.fillRoundRectRightSide=function(t,e,i,n,r){if("number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r){if("undefined"==typeof stroke&&(stroke=!0),void 0===r&&(r=5),"number"==typeof r)r={tl:0,tr:r,br:r,bl:0};else{var o={tl:0,tr:0,br:0,bl:0};for(var s in o)r[s]=r[s]||o[s]}this.ctx.beginPath(),this.ctx.moveTo(t+r.tl,e),this.ctx.lineTo(t+i-r.tr,e),this.ctx.quadraticCurveTo(t+i,e,t+i,e+r.tr),this.ctx.lineTo(t+i,e+n-r.br),this.ctx.quadraticCurveTo(t+i,e+n,t+i-r.br,e+n),this.ctx.lineTo(t+r.bl,e+n),this.ctx.quadraticCurveTo(t,e+n,t,e+n-r.bl),this.ctx.lineTo(t,e+r.tl),this.ctx.quadraticCurveTo(t,e,t+r.tl,e),this.ctx.fill()}},Graphics.prototype.fillRoundRectTopSide=function(t,e,i,n,r){if("number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r){if("undefined"==typeof stroke&&(stroke=!0),void 0===r&&(r=5),"number"==typeof r)r={tl:r,tr:r,br:0,bl:0};else{var o={tl:0,tr:0,br:0,bl:0};for(var s in o)r[s]=r[s]||o[s]}this.ctx.beginPath(),this.ctx.moveTo(t+r.tl,e),this.ctx.lineTo(t+i-r.tr,e),this.ctx.quadraticCurveTo(t+i,e,t+i,e+r.tr),this.ctx.lineTo(t+i,e+n-r.br),this.ctx.quadraticCurveTo(t+i,e+n,t+i-r.br,e+n),this.ctx.lineTo(t+r.bl,e+n),this.ctx.quadraticCurveTo(t,e+n,t,e+n-r.bl),this.ctx.lineTo(t,e+r.tl),this.ctx.quadraticCurveTo(t,e,t+r.tl,e),this.ctx.fill()}},Graphics.prototype.fillRoundRectBottomSide=function(t,e,i,n,r){if("number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r){if("undefined"==typeof stroke&&(stroke=!0),void 0===r&&(r=5),"number"==typeof r)r={tl:0,tr:0,br:r,bl:r};else{var o={tl:0,tr:0,br:0,bl:0};for(var s in o)r[s]=r[s]||o[s]}this.ctx.beginPath(),this.ctx.moveTo(t+r.tl,e),this.ctx.lineTo(t+i-r.tr,e),this.ctx.quadraticCurveTo(t+i,e,t+i,e+r.tr),this.ctx.lineTo(t+i,e+n-r.br),this.ctx.quadraticCurveTo(t+i,e+n,t+i-r.br,e+n),this.ctx.lineTo(t+r.bl,e+n),this.ctx.quadraticCurveTo(t,e+n,t,e+n-r.bl),this.ctx.lineTo(t,e+r.tl),this.ctx.quadraticCurveTo(t,e,t+r.tl,e),this.ctx.fill()}},Graphics.prototype.drawEllipse=function(t,e,i,n,r,o,s,l){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r&&"number"==typeof o&&"number"==typeof s&&"boolean"==typeof l&&(this.ctx.beginPath(),this.ctx.ellipse(t,e,i,n,r,o,s,l),this.ctx.closePath(),this.ctx.stroke())},Graphics.prototype.fillEllipse=function(t,e,i,n,r,o,s,l){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r&&"number"==typeof o&&"number"==typeof s&&"boolean"==typeof l&&(this.ctx.beginPath(),this.ctx.ellipse(t,e,i,n,r,o,s,l),this.ctx.fill())},Graphics.prototype.drawOval=function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&(this.ctx.beginPath(),this.ctx.ellipse(t,e,i,n,0,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.stroke())},Graphics.prototype.drawOvalFromTopLeft=function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&(this.ctx.beginPath(),this.ctx.ellipse(t+i,e+n,i,n,0,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.stroke())},Graphics.prototype.fillOval=function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&(this.ctx.beginPath(),this.ctx.ellipse(t,e,i,n,0,0,2*Math.PI,!1),this.ctx.fill())},Graphics.prototype.fillOvalFromTopLeft=function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&(this.ctx.beginPath(),this.ctx.ellipse(t+i,e+n,i,n,0,0,2*Math.PI,!1),this.ctx.fill())},Graphics.prototype.drawCircle=function(t,e,i){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&this.drawOval(t,e,i,i)},Graphics.prototype.drawCircleFromTopLeft=function(t,e,i){"number"==typeof cenX&&"number"==typeof cenY&&"number"==typeof i&&this.drawOvalFromTopLeft(t,e,i,i)},Graphics.prototype.fillCircle=function(t,e,i){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&this.fillOval(t,e,i,i)},Graphics.prototype.fillCircleFromTopLeft=function(t,e,i){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&this.fillOvalFromTopLeft(t,e,i,i)},Graphics.prototype.drawArc=function(t,e,i,n,r,o){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r&&"boolean"==typeof o&&(this.ctx.beginPath(),this.ctx.arc(t,e,i,n,r,o),this.ctx.stroke())},Graphics.prototype.drawArcFromTopLeft=function(t,e,i,n,r,o){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r&&"boolean"==typeof o&&(this.ctx.beginPath(),this.ctx.arc(t+i,e+i,i,n,r,o),this.ctx.stroke())},Graphics.prototype.drawLine=function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&(this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,n),this.ctx.stroke())},Graphics.prototype.drawPolygon=function(t){if("Polygon"===t.constructor.name){var e=0,i=0;this.ctx.beginPath();for(var n=0;n<t.xpoints.length;n++)e=t.xpoints[n],i=t.ypoints[n],0===n?this.ctx.moveTo(e,i):this.ctx.lineTo(e,i);this.ctx.lineTo(e,i),this.ctx.closePath(),this.ctx.stroke()}},Graphics.prototype.fillPolygon=function(t){if(t&&"Polygon"===t.constructor.name){let e=0,i=0;this.ctx.beginPath();for(let n=0;n<t.xpoints.length;n++)e=t.xpoints[n],i=t.ypoints[n],0===n?this.ctx.moveTo(e,i):this.ctx.lineTo(e,i);this.ctx.lineTo(e,i),this.ctx.closePath(),this.ctx.fill()}},Graphics.prototype.drawPolygonFromVertices=function(t,e,i){if("[object Array]"!==Object.prototype.toString.call(t)){logger("xpoints must be an array of integer numbers");return}if("[object Array]"!==Object.prototype.toString.call(e)){logger("ypoints must be an array of integer numbers");return}if("number"!=typeof i){logger("npoints must be an integer number");return}if(t.length!==e.length){logger("xpoints and ypoints must have the same size.");return}var n=0,r=0;this.ctx.beginPath();for(var o=0;o<t.length;o++){var n=t[o],r=e[o];0===o?this.ctx.moveTo(n,r):this.ctx.lineTo(n,r)}this.ctx.lineTo(n,r),this.ctx.closePath(),this.ctx.stroke()},Graphics.prototype.fillPolygonFromVertices=function(t,e,i){if("[object Array]"!==Object.prototype.toString.call(t)){logger("xpoints must be an array of integer numbers");return}if("[object Array]"!==Object.prototype.toString.call(e)){logger("ypoints must be an array of integer numbers");return}if("number"!=typeof i){logger("npoints must be an integer number");return}if(t.length!==e.length){logger("xpoints and ypoints must have the same size.");return}var n=0,r=0;this.ctx.beginPath();for(var o=0;o<t.length;o++){var n=t[o],r=e[o];0===o?this.ctx.moveTo(n,r):this.ctx.lineTo(n,r)}this.ctx.lineTo(n,r),this.ctx.closePath(),this.fill()},Graphics.prototype.save=function(){this.ctx.save()},Graphics.prototype.getBlobFromCanvas=function(t,e,i){t.toBlob(function(t){i(t)},e)},Graphics.prototype.getHorizontalExtent=function(){let t={left:0,top:0,right:0,bottom:0,width:0,height:0},e=this.getImageData(0,0,this.width,this.height).data,i=!1,n=!1,r=this.width,o=this.height,s=o,l=r;for(l=r;!i&&l;)for(l--,s=0;s<o;s++)if(e[s*r*4+4*l+3]){i=l+1,t.right=l+1;break}for(l=0;!n&&l<i;){for(s=0;s<o;s++)if(e[s*r*4+4*l+3]){n=l,t.left=l,t.width=i-n-1;break}if(l++,n)return{left:t.left,right:t.right}}return null},Graphics.prototype.getVerticalExtent=function(){let t={left:0,top:0,right:0,bottom:0,width:0,height:0},e=this.getImageData(0,0,this.width,this.height).data,i=!1,n=!1,r=this.width,o=this.height,s=0;for(;!n&&o;)for(o--,s=0;s<r;s++)if(e[o*r*4+4*s+3]){n=o+1,t.bottom=o+1;break}for(o=0;!i&&o<n;){for(s=0;s<r;s++)if(e[o*r*4+4*s+3]){i=o-1,t.top=o-1,t.height=n-i-1;break}if(o++,i)return{top:t.top,bottom:t.bottom}}return null},Graphics.prototype.getBoundingBox=function(){let t={left:0,top:0,right:0,bottom:0,width:0,height:0},e=this.getImageData(0,0,this.width,this.height).data,i=!1,n=!1,r=!1,o=!1,s=this.width,l=this.height,u=l,h=0;for(;!n&&u;)for(u--,h=0;h<s;h++)if(e[u*s*4+4*h+3]){n=u+1,t.bottom=u+1;break}for(u=0;!i&&u<n;){for(h=0;h<s;h++)if(e[u*s*4+4*h+3]){i=u-1,t.top=u-1,t.height=n-i-1;break}u++}for(h=s;!r&&h;)for(h--,u=0;u<l;u++)if(e[u*s*4+4*h+3]){r=h+1,t.right=h+1;break}for(h=0;!o&&h<r;){for(u=0;u<l;u++)if(e[u*s*4+4*h+3]){o=h,t.left=h,t.width=r-o-1;break}if(h++,o)return new Rectangle(t.left,t.top,t.right,t.bottom)}return null},Graphics.prototype.getFittedPNG=function(t,e){if(e){if("function"!=typeof e)throw Error("If you are supplying a callback, then it has to be a function!");if(1!==e.length)throw Error("Your callback function should have only 1 parameter, this is a blob that contains the fitted PNG image")}t=this.normalizeQuantity(t);let i=this.getBoundingBox(),n=i.left,r=i.top,o=i.right,s=i.bottom,l=document.createElement("canvas");return l.width=o-n,l.height=s-r,l.width+=2*t,l.height+=2*t,l.getContext("2d").drawImage(this.getCanvas(),n-t,r-t,l.width,l.height,0,0,l.width,l.height),this.getBlobFromCanvas(l,"image/png",e)},Graphics.prototype.drawHollowString=function(t,e,i){this.ctx.strokeText(t,e,i)},Graphics.prototype.drawString=function(t,e,i){this.ctx.fillText(t,e,i)},Graphics.prototype.drawImageAt=function(t,e,i){"number"==typeof e&&"number"==typeof i&&this.ctx.drawImage(t,e,i)},Graphics.prototype.drawImageAtLocWithSize=function(t,e,i,n,r){"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r&&this.ctx.drawImage(t,e,i,n,r)},Graphics.prototype.drawImage=function(t,e,i,n,r,o,s,l,u){"number"==typeof e&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r&&"number"==typeof o&&"number"==typeof s&&"number"==typeof l&&"number"==typeof u&&this.ctx.drawImage(t,e,i,n,r,o,s,l,u)},Graphics.prototype.createImageData=function(t,e){return"number"==typeof t&&"number"==typeof e?this.ctx.createImageData(t,e):1===arguments.length?this.ctx.createImageData(t):void 0},Graphics.prototype.getImageData=function(t,e,i,n){if("number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n)return this.ctx.getImageData(t,e,i,n)},Graphics.prototype.putImageData=function(t,e,i,n,r,o,s){if("number"==typeof e&&"number"==typeof i)return this.ctx.putImageData(t,e,i,n,r,o,s)},Graphics.prototype.drawPixel=function(t,e,i,n,r,o){if("number"==typeof t&&"number"==typeof e){i="number"==typeof i&&i>=0&&i<256?i:0,n="number"==typeof n&&n>=0&&n<256?n:0,r="number"==typeof r&&r>=0&&r<256?r:0,o="number"==typeof o&&o>=0&&o<256?o:255;let s=this.imageCacheUnitPx.data;s[0]=i,s[1]=n,s[2]=r,s[3]=o,this.ctx.putImageData(this.imageCacheUnitPx,t,e)}},Graphics.prototype.drawDoublePixel=function(t,e,i,n,r,o){if("number"==typeof t&&"number"==typeof e){i="number"==typeof i&&i>=0&&i<256?i:0,n="number"==typeof n&&n>=0&&n<256?n:0,r="number"==typeof r&&r>=0&&r<256?r:0,o="number"==typeof o&&o>=0&&o<256?o:255;let s=this.imageCacheQuadPx.data;s[0]=i,s[1]=n,s[2]=r,s[3]=o,s[4]=i,s[5]=n,s[6]=r,s[7]=o,s[8]=i,s[9]=n,s[10]=r,s[11]=o,s[12]=i,s[13]=n,s[14]=r,s[15]=o,this.ctx.putImageData(this.imageCacheQuadPx,t,e)}},Graphics.prototype.stringWidth=function(t){return"string"==typeof t?this.ctx.measureText(t).width:0},Graphics.prototype.getTextWidth=function(t){if("string"==typeof t){if(0===t.length)return 0;let e=document.createElement("canvas");e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",document.body.appendChild(e);let i=new Graphics(e);i.ctx.font=this.ctx.font,i.setBackground("#000"),i.drawString(t,10,e.height/2);let n=i.getHorizontalExtent();if(e.remove(),i.clear(),i.destroy(),i=null,n)return n.right-n.left}return null},Graphics.prototype.getTextHeight=function(t){if("string"==typeof t){if(0===t.length)return 0;let e=document.createElement("canvas");e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",document.body.appendChild(e);let i=new Graphics(e);i.ctx.font=this.ctx.font,i.setBackground("#000"),i.drawString(t,10,e.height/2);let n=i.getVerticalExtent();if(e.remove(),i.clear(),i.destroy(),i=null,n)return n.bottom-n.top}return null},Graphics.prototype.getTextSize=function(t){if("string"==typeof t){if(0===t.length)return new Rectangle(0,0,0,0);let e=document.createElement("canvas");e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",document.body.appendChild(e);let i=new Graphics(e);i.ctx.font=this.ctx.font,i.setBackground("#000"),i.drawString(t,10,e.height/2);let n=i.getBoundingBox();return e.remove(),i.clear(),i.destroy(),i=null,n}return null},Graphics.prototype.getTextSizes=function(t){if(isOneDimArray(t)){if(0===t.length)return new Rectangle(0,0,0,0);let e=document.createElement("canvas");e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",document.body.appendChild(e);let i=new Graphics(e);i.ctx.font=this.ctx.font,i.setBackground("#000");let n=[];for(let r=0;r<t.length;r++){i.drawString(t[r],10,e.height/2);let o=i.getBoundingBox();i.clear(),n.push(o)}return e.remove(),i.destroy(),i=null,rect}return null},Graphics.prototype.textHeight=function(t){return"string"==typeof t?this.ctx.measureText("M").width:0},Graphics.prototype.scanLines=function(t,e){let i=[],n=this.ctx,r=new StringBuffer;for(var o=0;o<t.length;o++)if(n.measureText(r.toString()).width<e)r.append(t.substring(o,o+1));else{let s=r.toString(),l={width:n.measureText(s).width,text:s};i.push(l),(r=new StringBuffer).append(t.substring(o,o+1))}if(r.toString().length>0){let u=r.toString(),h={width:n.measureText(u).width,text:u};i.push(h)}return i},Graphics.prototype.draw3DRect=function(t,e,i,n,r,o,s,l){let u=this.ctx;if("string"!=typeof r)throw"The shadow color must be a string and a valid color";if("number"!=typeof o)throw"The shadow blur must be a number, say 5";if("number"!=typeof s)throw"The shadow offset along x must be a number, say 2";if("number"!=typeof l)throw"The shadow offset along y must be a number, say 2";u.shadowColor=r,u.shadowBlur=o,u.shadowOffsetX=s,u.shadowOffsetY=l,this.drawRect(t,e,i,n)},Graphics.prototype.fill3DRect=function(t,e,i,n,r,o,s,l){let u=this.ctx;if("string"!=typeof r)throw"The shadow color must be a string and a valid color";if("number"!=typeof o)throw"The shadow blur must be a number, say 5";if("number"!=typeof s)throw"The shadow offset along x must be a number, say 2";if("number"!=typeof l)throw"The shadow offset along y must be a number, say 2";u.shadowColor=r,u.shadowBlur=o,u.shadowOffsetX=s,u.shadowOffsetY=l,this.fillRect(t,e,i,n)},Graphics.prototype.getLinesByMaxWidthAlgorithm=function(t,e){let i=[],n=this.ctx,r=new Scanner(t,!0,["\r\n","	","\r"," ","\n"]).scan(),o=r.length,s=new StringBuffer,l=0;for(let u=0;u<o;u++){let h=r[u],c=n.measureText(s.toString()+h).width;c<e?s.append(h):c===e||"\r\n"===h||"\r"===h||"\n"===h?(s.append(h),i.push(new LineAndWidth(s.toString(),c)),s.reset()):c>e&&(""!==s.toString()&&i.push(new LineAndWidth(s.toString(),l)),s.reset(),s.append(h)),l=c}let p=s.toString();return p.length>0&&i.push(new LineAndWidth(p,n.measureText(p).width)),i};const MysteryConstants={DRAW_SQUARE:1,DRAW_RECT:2,DRAW_CIRCLE:3,DRAW_OVAL:4,DRAW_DOT:5,DRAW_DOT2:6,DRAW_LINE:7,DRAW_STAR:8,DRAW_LETTER:9,DRAW_TRIANGLE:10,DRAW_TEXT:11,DRAW_ROTATED_SQUARE:12,DRAW_ROTATED_RECT:13,DRAW_ROTATED_TRIANGLE:14,DRAW_ROTATED_STAR:15,DRAW_ROTATED_OVAL:16,DRAW_POLYGON:17,DRAW_ROTATED_TEXT:18,DENSITY_SCALE:1e-5,DEF_ALPHA:1},MysteryModes={ALL:"all",STAR:"star",LINE:"line",DOT:"dot",DOT2:"dot2",TEXT:"text",TRIANGLE:"triangle",SQUARE:"square",OVAL:"oval",CIRCLE:"circle",POLYGON:"polygon",COMBO:"combo"};function MysteryImage(t){if(!t)throw"No initializing options specified!";if(this.rnd=new Random,this.mode=MysteryModes.ALL,this.comboArray=[],this.state=MysteryConstants.DRAW_ROTATED_TEXT,this.id="mystery_"+this.rnd.generateUUID(),this.width=100,t.width){if("number"==typeof t.width)this.width=t.width;else if("string"==typeof t.width)try{this.width=parseInt(t.width)}catch(e){throw e}else throw"Invalid value specified for `width`"}if(this.height=100,t.height){if("number"==typeof t.height)this.height=t.height;else if("string"==typeof t.height)try{this.height=parseInt(t.height)}catch(i){throw i}else throw"Invalid value specified for `height`"}if(t.mode){if("string"==typeof t.mode){let n=this;if(-1===t.mode.indexOf(",")){let r=!1;if(Object.keys(MysteryModes).forEach(function(e){t.mode===e.toLowerCase()&&(n.mode=e,r=!0)}),!r)throw"invalid mi-mode: `"+t.mode+"`"}else{let o=t.mode.replace(/\s/g,"").split(",");for(let s=0;s<o.length;s++){let l=!1,u=o[s];if(Object.keys(MysteryModes).forEach(function(t){u===t.toLowerCase()&&(n.comboArray.push(t),l=!0)}),!l)throw"invalid mi-mode: `"+t.mode+"`"}this.mode=MysteryModes.COMBO}}else throw"Invalid value specified for `mode`"}if(this.numShapes=20,t.numShapes){if("number"==typeof t.numShapes)this.numShapes=t.numShapes;else if("string"==typeof t.numShapes)try{this.numShapes=parseInt(t.numShapes)}catch(h){throw h}else throw"Invalid value specified for `numShapes`"}if(this.fontName="Segoe UI",t.fontName){if("string"==typeof t.fontName)this.fontName=t.fontName;else throw"Bad value specified for `fontName`"}if(this.strokeWidth=1,t.strokeWidth){if("number"==typeof t.strokeWidth)this.strokeWidth=t.strokeWidth;else if("string"==typeof t.strokeWidth)try{this.strokeWidth=parseInt(t.strokeWidth)}catch(c){throw c}else throw"Invalid value specified for `strokeWidth`"}if(this.fontSize=12,t.fontSize){if("number"==typeof t.fontSize)this.fontSize=t.fontSize;else if("string"==typeof t.fontSize)this.fontSize=parseInt(t.fontSize);else throw"Invalid value specified for `fontSize`"}if(this.fontStyle=FontStyle.REGULAR,t.fontStyle){if("string"==typeof t.fontStyle){if(-1===FontStyleValues.indexOf(t.fontStyle))throw"Invalid value specified for font size";this.fontStyle=t.fontStyle}else throw"Invalid value specified for `fontStyle`"}if(this.sizeUnits=CssSizeUnits.PX,t.sizeUnits){if("string"==typeof t.sizeUnits){if(-1===CssSizeUnitsValues.indexOf(t.sizeUnits))throw"Invalid size unit specified for font size";this.sizeUnits=t.sizeUnits}else this.sizeUnits=CssSizeUnits.PX}if(this.minSize=12,t.minSize){if("number"==typeof t.minSize)this.minSize=t.minSize;else if("string"==typeof t.minSize)try{this.minSize=parseInt(t.minSize)}catch(p){throw p}else throw"Invalid value specified for `minSize`"}if(this.shapesDensity=0,t.shapesDensity){if("number"==typeof t.shapesDensity)this.shapesDensity=t.shapesDensity;else if("string"==typeof t.shapesDensity)try{this.shapesDensity=parseInt(t.shapesDensity)}catch(d){throw d}else throw"Invalid value specified for `shapesDensity`"}if(this.opacity=MysteryConstants.DEF_ALPHA,t.opacity){if("number"==typeof t.opacity)this.opacity=t.opacity;else if("string"==typeof t.opacity)try{this.opacity=parseFloat(t.opacity)}catch(f){throw f}else throw"Invalid value specified for `opacity`"}if(this.fgColor="#000",t.fgColor){if("string"==typeof t.fgColor)this.fgColor=t.fgColor;else throw"Invalid value specified for `fgColor`"}if(this.bgColor="#FFF",t.bgColor){if("string"==typeof t.bgColor)this.bgColor=t.bgColor;else throw"Invalid value specified for `bgColor`"}if(this.cacheAfterDraw=!0,"boolean"==typeof t.cacheAfterDraw&&(this.cacheAfterDraw=t.cacheAfterDraw),this.bgOpacityEnabled=!1,"boolean"==typeof t.bgOpacityEnabled&&(this.bgOpacityEnabled=t.bgOpacityEnabled),this.textOnly=!1,t.textOnly){if("boolean"==typeof t.textOnly)this.textOnly=t.textOnly;else throw"Invalid value specified for `textOnly`"}if(this.textArray=[],t.textArray){if(isOneDimArray(t.textArray))this.textArray=t.textArray;else throw"Invalid value specified for `textArray`"}this.imageCache=null,this.g=new Graphics(this.width,this.height),this.font=new Font(this.fontStyle,this.fontSize,this.fontName,this.sizeUnits),this.g.setFont(this.font),this.g.setStrokeWidth(this.strokeWidth),this.g.setBackground(this.bgColor),this.g.setColor(this.fgColor),this.g.setAlpha(this.opacity),this.fgColor=this.g.ctx.strokeStyle,this.bgColor=this.g.ctx.fillStyle}function makeCanvas(t,e,i){let n=document.createElement("canvas");return t&&(n.id=t),n.width=e,n.height=i,n.style.border="0px solid",document.body.appendChild(n),n}function invertColor(t){if(0===t.indexOf("#")&&(t=t.slice(1)),3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),6!==t.length)throw Error("Invalid HEX color.");var e=(255-parseInt(t.slice(0,2),16)).toString(16),i=(255-parseInt(t.slice(2,4),16)).toString(16),n=(255-parseInt(t.slice(4,6),16)).toString(16);return"#"+padZero(e)+padZero(i)+padZero(n)}function padZero(t,e){return(Array(e=e||2).join("0")+t).slice(-e)}function calibrate(t,e,i,n){let r=t.getAlpha();t.setAlpha(1),t.setColor("pink"),t.setBackground("white");let o=new Font(FontStyle.REGULAR,8,"Kartika",CssSizeUnits.PX,"normal");for(let s=0;s<e;s+=50)t.drawLine(s,0,s,20),t.setFont(o),t.drawString(""+s,s,30),t.setFont(n);t.setColor("pink"),t.setBackground("white");for(let l=0;l<i;l+=50)t.setFont(n),t.drawLine(0,l,20,l),t.setFont(o),t.drawString(""+l,30,l);t.setAlpha(r)}function drawBus(t,e,i){let n=new BusView(sz,e,i,t);n.draw();let r=n.imageCache;return n.cleanup(),r}function drawStar(t,e,i){let n=new Graphics(t,t);n.setBackground(e);let r=.5*thickness,o=.5*size,s=new Point(x+o,y+o),l=s.x-r,u=s.y-r,h=l+thickness,c=u+thickness,p=new Rectangle(l,u,h,c),d=[x,p.left,x+o,p.right(),x+size,p.right(),x+o,p.left,x],f=[y+o,p.top,y,p.top,y+o,p.bottom(),y+size,p.bottom(),y+o];i?n.fillPolygonFromVertices(d,f,9):n.drawPolygonFromVertices(d,f,9),n.getCanvas(),n.clear(),n.getCanvas().remove()}function BusView(t,e,i,n){this.mainColor=e,this.minorColor=i,this.busRadius=n,this.imageCache=null;let r=this.makeCanvas(t,t);this.g=new Graphics(r),this.alphaRange={MIN_ALPHA:80,MAX_ALPHA:255},this.opacityValue=this.alphaRange.MIN_ALPHA,this.busArchitecture=new BusArchitecture(t)}function BusArchitecture(t){if(!t||"number"!=typeof t)throw"invalid argument for bus width";this.busWidth=t,this.busHeight=0,this.busWheelWidth=0,this.busWheelsSpan=0,this.busWheelsY=0,this.busSemiCircularHollowForWheelWidth=0,this.busSemiCircularHollowForWheelY=0,this.busSemiCircularHollowSpan=0,this.busRimWidth=0,this.busLowerRectWidth=0,this.busLowerRectHeight=0,this.busLowerRectX=0,this.busLowerRectY=0,this.busWindowX=0,this.busWindowY=0,this.busWindowWidth=0,this.busWindowHeight=0,this.busWindowGap=0,this.busLowerRodBetweenTiresWidth=0,this.busLowerRodBetweenTiresHeight=0,this.busLowerRodBetweenTiresX=0,this.busLowerRodBetweenTiresY=0,this.busFenderWidth=0,this.busFenderHeight=0,this.fenderDisplacementBehindBus=0,this.fenderY=0,this.structure={STD_BUS_WIDTH:920,STD_BUS_HEIGHT:572,STD_BUS_WHEEL_WIDTH:176,STD_BUS_WHEEL_Y:490,STD_BUS_SEMI_CIRCLE_HOLLOW_FOR_WHEEL_Y:485,STD_BUS_SEMI_CIRCLE_HOLLOW_FOR_WHEEL_WIDTH:188,STD_BUS_SEMI_CIRCLE_HOLLOW_SPAN:690,STD_BUS_RIM_WIDTH:90,STD_BUS_LOWER_RECT_WIDTH:665,STD_BUS_LOWER_RECT_HEIGHT:203,STD_BUS_LOWER_RECT_X:124,STD_BUS_LOWER_RECT_Y:266,STD_BUS_LOWER_ROD_BETWEEN_TIRES_WIDTH:320,STD_BUS_LOWER_ROD_BETWEEN_TIRES_HEIGHT:20,STD_BUS_LOWER_ROD_BETWEEN_TIRES_X:296,STD_BUS_LOWER_ROD_BETWEEN_TIRES_Y:508,STD_BUS_WINDOW_X:123,STD_BUS_WINDOW_Y:100,STD_BUS_WHEELS_SPAN:682,STD_BUS_WINDOW_WIDTH:160,STD_BUS_WINDOW_HEIGHT:130,STD_BUS_WINDOW_GAP:92.5,STD_BUS_FENDER_WIDTH:969,STD_BUS_FENDER_HEIGHT:85,STD_BUS_FENDER_DISPLACEMENT_BEHIND_BUS:12,STD_BUS_FENDER_Y:485},this.init()}MysteryImage.prototype.cleanup=function(){this.imageCache=null,this.g.clear(),this.g.getCanvas().remove()},MysteryImage.prototype.getImage=function(){return this.g.getCanvas().toDataURL()},MysteryImage.prototype.drawSquare=function(t,e,i,n){let r=this.g;n?r.fillRect(t,e,i,i):r.drawRect(t,e,i,i)},MysteryImage.prototype.drawDot=function(t,e,i){let n=this.g,r=i/2,o=getRGB(this.fgColor),s=o.r,l=o.g,u=o.b,h=255*o.a;n.drawPixel(t+r,e+r,s,l,u,h)},MysteryImage.prototype.drawDoubleDot=function(t,e,i){let n=this.g,r=i/2,o=getRGB(this.fgColor),s=o.r,l=o.g,u=o.b,h=255*o.a;n.drawDoublePixel(t+r,e+r,s,l,u,h)},MysteryImage.prototype.drawRotatedSquare=function(t,e,i,n,r){let o=this.g;o.rotateDegsAt(n,t+i/2,e+i/2,function(){r?o.fillRect(-i/2,-i/2,i,i):o.drawRect(-i/2,-i/2,i,i)})},MysteryImage.prototype.drawRect=function(t,e,i,n){let r=this.g,o=i,s=i/2,l=s+this.rnd.nextInt(s+1),u=[o=this.rnd.nextBool()?l:o,l],h=this.rnd.nextInt(2);o=u[h],l=0===h?u[1]:u[0],n?r.fillRect(t,e,o,l):r.drawRect(t,e,o,l)},MysteryImage.prototype.drawPolygon=function(t,e,i,n){let r=this.g,o=this,s=[function n(){let r=new Polygon([],[],0);return r.addPoint(t,e),r.addPoint(t+i/4,e),r.addPoint(t+i/4,e+3*i/4),r.addPoint(t+i,e+3*i/4),r.addPoint(t+i,e+i),r.addPoint(t,e+i),r.addPoint(t,e),r},function n(){let r=new Polygon([],[],0);return r.addPoint(t+3*i/4,e),r.addPoint(t+i,e),r.addPoint(t+i,e+i),r.addPoint(t,e+i),r.addPoint(t,e+3*i/4),r.addPoint(t+3*i/4,e+3*i/4),r.addPoint(t+3*i/4,e),r},function n(){let r=new Polygon([],[],0);return r.addPoint(t,e),r.addPoint(t+i,e),r.addPoint(t+i,e+i/4),r.addPoint(t+i/4,e+i/4),r.addPoint(t+i/4,e+i),r.addPoint(t,e+i),r.addPoint(t,e),r},function n(){let r=new Polygon([],[],0);return r.addPoint(t,e),r.addPoint(t+i,e),r.addPoint(t+i,e+i),r.addPoint(t+3*i/4,e+i),r.addPoint(t+3*i/4,e+i/4),r.addPoint(t,e+i/4),r.addPoint(t,e),r},function n(){let r=new Polygon([],[],0);return r.addPoint(t,e),r.addPoint(t+i/4,e),r.addPoint(t+i/4,e+3*i/4),r.addPoint(t+3*i/4,e+3*i/4),r.addPoint(t+3*i/4,e),r.addPoint(t+i,e),r.addPoint(t+i,e+i),r.addPoint(t,e+i),r.addPoint(t,e),r},function n(){let r=new Polygon([],[],0);return r.addPoint(t,e),r.addPoint(t+i,e),r.addPoint(t+i,e+i),r.addPoint(t+3*i/4,e+i),r.addPoint(t+3*i/4,e+i/4),r.addPoint(t+i/4,e+i/4),r.addPoint(t+i/4,e+i),r.addPoint(t,e+i),r.addPoint(t,e),r},function n(){let r=new Polygon([],[],0);return r.addPoint(t+3*i/8,e),r.addPoint(t+3*i/8,e+3*i/8),r.addPoint(t,e+3*i/8),r.addPoint(t,e+5*i/8),r.addPoint(t+3*i/8,e+5*i/8),r.addPoint(t+3*i/8,e+i),r.addPoint(t+5*i/8,e+i),r.addPoint(t+5*i/8,e+5*i/8),r.addPoint(t+i,e+5*i/8),r.addPoint(t+i,e+3*i/8),r.addPoint(t+5*i/8,e+3*i/8),r.addPoint(t+5*i/8,e),r},function n(){let r=new Polygon([],[],0);return r.addPoint(t+i/4,e),r.addPoint(t+3*i/4,e),r.addPoint(t+i,e+i/2),r.addPoint(t+3*i/4,e+i),r.addPoint(t+i/4,e+i),r.addPoint(t,e+i/2),r.addPoint(t+i/4,e),r},function n(){let r=new Polygon([],[],0),s=[],l=4+o.rnd.nextInt(5),u=[e,e+i/4,e+3*i/4,e+i];for(let h=0;h<l;h++){let c=t+o.rnd.nextInt(i),p=u[o.rnd.nextInt(u.length)];s.push(new Point(c,p))}s.sort(function(t,e){return t.x-e.x});for(let d=0;d<s.length;d++)r.addPoint(s[d].x,s[d].y);return r}],l=s[this.rnd.nextInt(s.length)]();n||(n=this.rnd.nextInt(4)>0),n?r.fillPolygon(l):r.drawPolygon(l)},MysteryImage.prototype.drawRotatedRect=function(t,e,i,n,r){let o=this.g,s=i,l=i/2,u=l+this.rnd.nextInt(l+1),h=[s=this.rnd.nextBool()?u:s,u],c=this.rnd.nextInt(2);s=h[c],u=0===c?h[1]:h[0],o.rotateDegsAt(n,t+s/2,e+u/2,function(){r?o.fillRect(-s/2,-u/2,s,u):o.drawRect(-s/2,-u/2,s,u)})},MysteryImage.prototype.drawCircle=function(t,e,i,n){let r=this.g,o=i/2;n?r.fillCircle(t,e,o):r.drawCircle(t,e,o)},MysteryImage.prototype.drawOval=function(t,e,i,n){let r=this.g,o=i,s=i/2,l=s+this.rnd.nextInt(s+1),u=[o=this.rnd.nextBool()?l:o,l],h=this.rnd.nextInt(2);o=u[h],l=0===h?u[1]:u[0],n?r.fillOval(t,e,o,l):r.drawOval(t,e,o,l)},MysteryImage.prototype.drawRotatedOval=function(t,e,i,n,r){let o=this.g,s=i,l=i/2,u=l+this.rnd.nextInt(l+1),h=[s=this.rnd.nextBool()?u:s,u],c=this.rnd.nextInt(2);s=h[c],u=0===c?h[1]:h[0],o.rotateDegsAt(n,t,e,function(){r?o.fillOval(0,0,s,u):o.drawOval(0,0,s,u)})},MysteryImage.prototype.drawLine=function(t,e,i,n){let r=this.g,o=i/2;r.rotateDegsAt(n,t+o,e+o,function(){r.drawLine(-o,-o,-o+i,-o)})},MysteryImage.prototype.drawStar=function(t,e,i,n,r){let o=this.g,s=.5*n,l=.5*i,u=new Point(t+l,e+l),h=u.x-s,c=u.y-s,p=new Rectangle(h,c,h+n,c+n),d=[t,p.left,t+l,p.right(),t+i,p.right(),t+l,p.left,t],f=[e+l,p.top,e,p.top,e+l,p.bottom(),e+i,p.bottom(),e+l];r?o.fillPolygonFromVertices(d,f,9):o.drawPolygonFromVertices(d,f,9)},MysteryImage.prototype.drawRotatedStar=function(t,e,i,n,r,o){let s=this.g,l=this,u=i/2;s.rotateDegsAt(r,t+u,e+u,function(){l.drawStar(-u,-u,i,n,o)})},MysteryImage.prototype.drawTriangle=function(t,e,i,n){let r=this.g,o=.5*i,s=[t+o,t,t+i,t+o],l=[e,e+i,e+i,e];n?r.fillPolygonFromVertices(s,l,s.length):r.drawPolygonFromVertices(s,l,s.length)},MysteryImage.prototype.drawRotatedTriangle=function(t,e,i,n,r){let o=this.g,s=this,l=i/2;o.rotateDegsAt(n,t+l,e+l,function(){s.drawTriangle(-l,-l,i,r)})},MysteryImage.prototype.drawText=function(t,e){if(this.textArray&&this.textArray.length>0){let i=this.g,n=this.textArray.length,r=this.rnd.nextInt(n),o=this.textArray[r],s=i.stringWidth(o),l=i.textHeight(o);return i.drawString(o,t,e+l),{width:s,height:l}}},MysteryImage.prototype.drawRotatedText=function(t,e,i,n){if(this.textArray&&this.textArray.length>0){let r=this.g,o=this,s=this.rnd.nextInt(this.textArray.length),l=this.textArray[s],u=i/2,h=r.textHeight(l);r.rotateDegsAt(n,t+u,e+u,function(){o.drawText(-u,h-u)})}},MysteryImage.prototype.drawBus=function(t,e,i){let n=this.g,r=new BusView(i,this.fgColor,invertColor(this.fgColor),16);r.draw(),n.drawImageAtLocWithSize(r.imageCache,t,e,i,i),r.cleanup()},MysteryImage.prototype.drawRotatedBus=function(t,e,i,n){let r=this.g,o=new BusView(i,this.fgColor,invertColor(this.fgColor),16);o.draw();let s=o.imageCache,l=i/2;r.rotateDegsAt(n,t+l,e+l,function(){r.drawImage(s,-l,-l),o.cleanup()})},MysteryImage.prototype.generateRect=function(t,e){let i=t/PIXEL_RATIO,n=e/PIXEL_RATIO,r=this.minSize/PIXEL_RATIO,o=r+this.rnd.nextInt(r+1),s=this.rnd.nextInt(i),l=this.rnd.nextInt(n);return s+o>=i&&(s=i-2*o),l+o>=n&&(l=n-2*o),new Rectangle(s,l,s+o,l+o)},MysteryImage.prototype.maxIterations=function(){return 12*this.numShapes},MysteryImage.prototype.baseDraw=function(t,e){let i=this.g,n=this.rnd;i.setAlpha(!0===this.bgOpacityEnabled?this.opacity:1),i.setBackground(this.bgColor),i.fillRect(0,0,t,e);let r=this.maxIterations();i.setAlpha(this.opacity),this.shapesDensity>0&&(this.numShapes=this.shapesDensity*(t*e)*MysteryConstants.DENSITY_SCALE);let o=0,s=[];for(;s.length<this.numShapes&&o<r;){this.mode.toLowerCase()===MysteryModes.ALL.toLowerCase()?this.textOnly?this.state=n.nextBool()?MysteryConstants.DRAW_TEXT:MysteryConstants.DRAW_ROTATED_TEXT:this.state=1+n.nextInt(0===this.textArray.length?MysteryConstants.DRAW_POLYGON:MysteryConstants.DRAW_ROTATED_TEXT):this.selectStateFromMode(this.mode);let l=n.nextBool(),u=1+n.nextInt(360),h=this.generateRect(t,e);h.angle=u;let c=!1;for(let p=0;p<s.length;p++){let d=s[p];if(h.intersects(d)){c=!0;break}}if(i.setBackground(this.fgColor),c)o++;else{switch(s.push(h),i.setColor(this.fgColor),i.setBackground(this.fgColor),this.state){case MysteryConstants.DRAW_SQUARE:this.drawSquare(h.left,h.top,h.width,l);break;case MysteryConstants.DRAW_RECT:this.drawRect(h.left,h.top,h.width,l);break;case MysteryConstants.DRAW_CIRCLE:this.drawCircle(h.left,h.top,h.width,this.mode.toLowerCase()===MysteryModes.CIRCLE||l);break;case MysteryConstants.DRAW_OVAL:this.drawOval(h.left,h.top,h.width,l);break;case MysteryConstants.DRAW_LINE:this.drawLine(h.left,h.top,h.width,u);break;case MysteryConstants.DRAW_STAR:this.drawStar(h.left,h.top,h.width,h.width/4,l);break;case MysteryConstants.DRAW_ROTATED_STAR:this.drawRotatedStar(h.left,h.top,h.width,h.width/4,u,l);break;case MysteryConstants.DRAW_TRIANGLE:this.drawTriangle(h.left,h.top,h.width,l);break;case MysteryConstants.DRAW_ROTATED_SQUARE:this.drawRotatedSquare(h.left,h.top,h.width,u,l);break;case MysteryConstants.DRAW_ROTATED_RECT:this.drawRotatedRect(h.left,h.top,h.width,u,l);break;case MysteryConstants.DRAW_ROTATED_TRIANGLE:this.drawRotatedTriangle(h.left,h.top,h.width,u,l);break;case MysteryConstants.DRAW_TEXT:this.drawText(h.left,h.top,h.width);break;case MysteryConstants.DRAW_ROTATED_TEXT:this.drawRotatedText(h.left,h.top,h.width,u);break;case MysteryConstants.DRAW_ROTATED_OVAL:this.drawRotatedOval(h.centerX(),h.centerY(),h.width,u);break;case MysteryConstants.DRAW_POLYGON:this.drawPolygon(h.left,h.top,h.width,l);break;case MysteryConstants.DRAW_DOT:this.drawDot(h.left,h.top,4);break;case MysteryConstants.DRAW_DOT2:this.drawDoubleDot(h.left,h.top,8)}h.state=this.state}}},MysteryImage.prototype.selectStateFromMode=function(t){let e=this.rnd;switch(t.toLowerCase()){case MysteryModes.OVAL:this.state=e.nextBool()?MysteryConstants.DRAW_OVAL:MysteryConstants.DRAW_ROTATED_OVAL;break;case MysteryModes.DOT:this.state=MysteryConstants.DRAW_DOT;break;case MysteryModes.DOT2:this.state=MysteryConstants.DRAW_DOT2;break;case MysteryModes.CIRCLE:this.state=MysteryConstants.DRAW_CIRCLE;break;case MysteryModes.TEXT:this.state=e.nextBool()?MysteryConstants.DRAW_TEXT:MysteryConstants.DRAW_ROTATED_TEXT;break;case MysteryModes.TRIANGLE:this.state=e.nextBool()?MysteryConstants.DRAW_TRIANGLE:MysteryConstants.DRAW_ROTATED_TRIANGLE;break;case MysteryModes.STAR:this.state=e.nextBool()?MysteryConstants.DRAW_STAR:MysteryConstants.DRAW_ROTATED_STAR;break;case MysteryModes.LINE:this.state=MysteryConstants.DRAW_LINE;break;case MysteryModes.SQUARE:this.state=e.nextBool()?MysteryConstants.DRAW_SQUARE:MysteryConstants.DRAW_ROTATED_SQUARE;break;case MysteryModes.POLYGON:this.state=MysteryConstants.DRAW_POLYGON;break;case MysteryModes.COMBO:let i=this.comboArray[e.nextInt(this.comboArray.length)];this.selectStateFromMode(i)}},MysteryImage.prototype.draw=function(){let t=this.g,e=t.width,i=t.height;return this.cacheAfterDraw&&null!==this.imageCache?t.drawImageAtLocWithSize(this.imageCache,0,0,e,i):(this.baseDraw(e,i),this.imageCache=t.getImageData(0,0,e,i)),this.imageCache},BusView.prototype.makeCanvas=function(t,e){let i=document.createElement("canvas");return i.id="bus-canv-"+new Date().getTime(),i.width=t,i.height=e,i.style.border="0px solid",document.body.appendChild(i),i},BusView.prototype.cleanup=function(){this.imageCache=null,this.g.clear(),this.g.getCanvas().remove()},BusArchitecture.prototype.init=function(){let t=this.busWidth/this.structure.STD_BUS_WIDTH;this.busHeight=t*this.structure.STD_BUS_HEIGHT,this.busWheelWidth=t*this.structure.STD_BUS_WHEEL_WIDTH,this.busWheelsY=t*this.structure.STD_BUS_WHEEL_Y,this.busSemiCircularHollowForWheelWidth=t*this.structure.STD_BUS_SEMI_CIRCLE_HOLLOW_FOR_WHEEL_WIDTH,this.busSemiCircularHollowForWheelY=t*this.structure.STD_BUS_SEMI_CIRCLE_HOLLOW_FOR_WHEEL_Y,this.busSemiCircularHollowSpan=t*this.structure.STD_BUS_SEMI_CIRCLE_HOLLOW_SPAN,this.busRimWidth=t*this.structure.STD_BUS_RIM_WIDTH,this.busLowerRectWidth=t*this.structure.STD_BUS_LOWER_RECT_WIDTH,this.busLowerRectHeight=t*this.structure.STD_BUS_LOWER_RECT_HEIGHT,this.busLowerRectX=t*this.structure.STD_BUS_LOWER_RECT_X,this.busLowerRectY=t*this.structure.STD_BUS_LOWER_RECT_Y,this.busWheelsSpan=t*this.structure.STD_BUS_WHEELS_SPAN,this.busLowerRodBetweenTiresWidth=t*this.structure.STD_BUS_LOWER_ROD_BETWEEN_TIRES_WIDTH,this.busLowerRodBetweenTiresHeight=t*this.structure.STD_BUS_LOWER_ROD_BETWEEN_TIRES_HEIGHT,this.busLowerRodBetweenTiresX=t*this.structure.STD_BUS_LOWER_ROD_BETWEEN_TIRES_X,this.busLowerRodBetweenTiresY=t*this.structure.STD_BUS_LOWER_ROD_BETWEEN_TIRES_Y,this.busWindowX=t*this.structure.STD_BUS_WINDOW_X,this.busWindowY=t*this.structure.STD_BUS_WINDOW_Y,this.busWindowWidth=t*this.structure.STD_BUS_WINDOW_WIDTH,this.busWindowHeight=t*this.structure.STD_BUS_WINDOW_HEIGHT,this.busWindowGap=t*this.structure.STD_BUS_WINDOW_GAP,this.busFenderWidth=t*this.structure.STD_BUS_FENDER_WIDTH,this.busFenderHeight=t*this.structure.STD_BUS_FENDER_HEIGHT,this.fenderDisplacementBehindBus=t*this.structure.STD_BUS_FENDER_DISPLACEMENT_BEHIND_BUS,this.fenderY=t*this.structure.STD_BUS_FENDER_Y},BusView.prototype.drawBus=function(){let t=this.g,e=this.busRadius<=0?16:this.busRadius,i=this.busArchitecture.busWidth,n=this.busArchitecture.busHeight,r=.5*(t.width-i),o=.5*(t.height-n);t.setBackground(this.mainColor),t.fillRoundRect(r,o,i,n,e);let s=this.busArchitecture.fenderDisplacementBehindBus,l=o+this.busArchitecture.fenderY;t.fillRoundRect(r-s,l,this.busArchitecture.busFenderWidth,this.busArchitecture.busFenderHeight,e),t.setBackground(this.minorColor);let u=r+this.busArchitecture.busWindowX,h=o+this.busArchitecture.busWindowY;t.fillRoundRect(u,h,this.busArchitecture.busWindowWidth,this.busArchitecture.busWindowHeight,4),u+=this.busArchitecture.busWindowWidth+this.busArchitecture.busWindowGap,t.fillRoundRect(u,h,this.busArchitecture.busWindowWidth,this.busArchitecture.busWindowHeight,4),u+=this.busArchitecture.busWindowWidth+this.busArchitecture.busWindowGap,t.fillRoundRect(u,h,this.busArchitecture.busWindowWidth,this.busArchitecture.busWindowHeight,4);let c=o+this.busArchitecture.busSemiCircularHollowForWheelY,p=this.busArchitecture.busSemiCircularHollowForWheelWidth,d=(i-this.busArchitecture.busSemiCircularHollowSpan)*.5,f=r+d;t.drawArcFromTopLeft(f,c,f+p,c+p,-180,180,!0),f=r+(i-d-p),t.drawArcFromTopLeft(f,c,f+p,c+p,-180,180,!0),t.setBackground(this.mainColor);let g=(i-this.busArchitecture.busWheelsSpan)*.5,m=.5*this.busArchitecture.busWheelWidth,$=r+g+m,v=r+(i-g-m),_=o+this.busArchitecture.busWheelsY;t.fillCircle($,_+m,m),t.fillCircle(v,_+m,m),t.setColor(this.minorColor),t.drawCircle($,_+m,m),t.drawCircle(v,_+m,m);let E=.5*this.busArchitecture.busRimWidth;t.setBackground(this.minorColor),t.fillCircle($,_+m,E),t.fillCircle(v,_+m,E),t.setColor(this.minorColor),t.setStrokeWidth(1.5),t.setAlpha(this.opacityValue);let A=r+this.busArchitecture.busLowerRectX,T=o+this.busArchitecture.busLowerRectY;t.drawRoundRect(A,T,this.busArchitecture.busLowerRectWidth,this.busArchitecture.busLowerRectHeight,4),A=r+this.busArchitecture.busLowerRodBetweenTiresX,T=o+this.busArchitecture.busLowerRodBetweenTiresY,this.busArchitecture.busLowerRodBetweenTiresWidth,this.busArchitecture.busLowerRodBetweenTiresHeight,t.setBackground(this.minorColor),t.setAlpha(this.alphaRange.MAX_ALPHA),t.fillRoundRect(A,T,this.busArchitecture.busLowerRodBetweenTiresWidth,this.busArchitecture.busLowerRodBetweenTiresHeight,4)},BusView.prototype.draw=function(){let t=this.g,e=t.width,i=t.height;null!=this.imageCache?t.drawImageAtLocWithSize(this.imageCache,0,0,e,i):(this.drawBus(),this.imageCache=t.getCanvas())};let getTextSize=function(t,e){if("string"==typeof t){if(0===t.length)return new Rectangle(0,0,0,0);let i=document.createElement("canvas");i.width=1024,i.height=190,i.style.width=i.width+"px",i.style.height=i.height+"px",document.body.appendChild(i);let n=new Graphics(i);n.ctx.font=e,n.setBackground("#000"),n.drawString(t,10,i.height/2);let r=n.getBoundingBox();return i.remove(),n.clear(),n.destroy(),n=null,r}return null};function TextBox(t,e){if(t&&"object"==typeof t){if(void 0===t.singleLine)this.singleLine=!1;else if("boolean"==typeof t.singleLine)this.singleLine=t.singleLine;else throw"invalid type for options.singleLine... should be `boolean`";"number"==typeof t.width?this.width=t.width:"string"==typeof t.width?this.width=parseInt(t.width):this.width=100,"string"==typeof t.text?this.text=t.text:this.text="LABEL","string"==typeof t.gravity?this.gravity=t.gravity:this.gravity=Gravity.LEFT,"string"==typeof t.sizeUnits?this.sizeUnits=t.sizeUnits:this.sizeUnits=CssSizeUnits.PX,"number"==typeof t.lineSpacing?this.lineSpacing=t.lineSpacing:"string"==typeof t.lineSpacing?this.lineSpacing=parseInt(t.lineSpacing):this.lineSpacing=8,"string"==typeof t.fontName?this.fontName=t.fontName:this.fontName="Segoe UI","number"==typeof t.fontSize?this.fontSize=t.fontSize:"string"==typeof t.fontSize?this.fontSize=parseFloat(t.fontSize):this.fontSize=15,"string"==typeof t.fontStyle?this.fontStyle=t.fontStyle:this.fontStyle=FontStyle.REGULAR,"number"==typeof t.borderRadius?this.borderRadius=t.borderRadius:"string"==typeof t.borderRadius?this.borderRadius=parseInt(t.borderRadius):this.borderRadius=2,"string"==typeof t.backgroundColor?this.backgroundColor=t.backgroundColor:this.backgroundColor="#DDDDDD","string"==typeof t.textColor?this.textColor=t.textColor:this.textColor="#000000","number"==typeof t.padding?this.padding=t.padding:"string"==typeof t.padding?isNaN(this.padding=parseFloat(t.padding))&&(this.padding=0):this.padding=0,this.height=12,this.g=new Graphics(this.width,this.height),this.font=new Font(this.fontStyle,this.fontSize,this.fontName,this.sizeUnits),this.g.setFont(this.font),this.lines=[],this.textHeight=this.g.textHeight("x"),this.doMetrics(),this.render(),this.transfer(e)}else throw Error("Invalid parameters for "+this.constructor.name)}TextBox.prototype.doMetrics=function(){let t=this.g,e=t.width;t.height;let i=this.text.trim(),n=this.padding*PIXEL_RATIO,r=this.lineSpacing*PIXEL_RATIO,o=this.singleLine,s=this.textHeight,l;if(o){let u=this.g.ctx.measureText(i).width+2*n;this.width=u/PIXEL_RATIO,this.lines=[],this.lines.push(new LineAndWidth(i,u)),l=1}else{this.lines=t.getLinesByMaxWidthAlgorithm(i,e-2*n),l=this.lines.length;let h=0;if(this.lines.forEach(function(t,e,i){h<t.width&&(h=t.width)}),h>=e&&(this.width=(2*n+h)/PIXEL_RATIO,l>1)){let c=this.width*PIXEL_RATIO-2*n;this.lines=t.getLinesByMaxWidthAlgorithm(i,c),l=this.lines.length}}let p=l*s+(l-1)*r+2*n+2+.4*s;this.height=p/PIXEL_RATIO,this.remove(),this.g=new Graphics(this.width*PIXEL_RATIO,p),this.g.setFont(this.font)},TextBox.prototype.render=function(){let t=this.g,e=this.width*PIXEL_RATIO,i=this.height*PIXEL_RATIO,n=this.backgroundColor,r=this.textColor,o=this.borderRadius,s=this.gravity,l=this.padding*PIXEL_RATIO,u=this.lineSpacing*PIXEL_RATIO,h=this.textHeight,c=this.lines;if(lineCount=c.length,t.setBackground(n),t.fillRoundRect(0,0,e,i,o),t.setBackground(r),lineCount>0){let p=h+l;for(let d=0;d<lineCount;d++){let f=c[d];switch(s){case Gravity.LEFT:t.drawString(f.text,l,p);break;case Gravity.RIGHT:t.drawString(f.text,e-l-f.width,p);break;case Gravity.CENTER:t.drawString(f.text,(e-f.width)/2,p);break;default:t.drawString(f.text,l,p)}p+=h+u}}},TextBox.prototype.transfer=function(t){let e=this.g.getCanvas();t.width=e.width,t.height=e.height;t.getContext("2d").drawImage(e,0,0,e.width,e.height),e.remove()},TextBox.prototype.getImage=function(){return this.g.getCanvas().toDataURL("image/png")},TextBox.prototype.getSize=function(){return{width:this.g.width,height:this.g.height}},TextBox.prototype.remove=function(){this.g.clear(),this.g.getCanvas().remove(),this.g.destroy()};var BuildBridgedWorker=function(t,e,i,n){var r,o=t.toString().match(/^\s*function\s*\(\s*\)\s*\{(([\s\S](?!\}$))*[\s\S])/)[1],s=[];s.push("var main = {};\n");for(var l=0;l<i.length;l++){var u=i[l];"*"===u.charAt(u.length-1)?(u=u.substr(0,u.length-1),i[l]=u,s.push("main."+u+" = function(/* arguments */){\n var args = Array.prototype.slice.call(arguments); var buffers = args.pop(); \n self.postMessage({foo:'"+u+"', args:args},buffers)\n}; \n")):s.push("main."+u+" = function(/* arguments */){\n var args = Array.prototype.slice.call(arguments); \n self.postMessage({foo:'"+u+"', args:args})\n}; \n")}for(var h=[],l=0;l<e.length;l++){var u=e[l];u="*"===u.charAt(u.length-1)?u.substr(0,u.length-1):u,h.push(u+": "+u)}s.push("var foos={"+h.join(",")+"};\n"),s.push("self.onmessage = function(e){\n"),s.push("if(e.data.foo in foos) \n  foos[e.data.foo].apply(null, e.data.args); \n else \n throw(new Error('Main thread requested function ' + e.data.foo + '. But it is not available.'));\n"),s.push("\n};\n");var c=o+"\n\n/*==== AUTO-GENERATED-CODE ==== */\n\n"+s.join("");try{r=new Blob([c],{type:"text/javascript"})}catch(p){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,(r=new BlobBuilder).append(c),r=r.getBlob()}var d=(window.URL?URL:webkitURL).createObjectURL(r),f=new Worker(d);f.onmessage=function(t){var e=i.indexOf(t.data.foo);if(-1!==e)n[e].apply(null,t.data.args);else throw Error("Worker requested function "+t.data.foo+". But it is not available.")};for(var g={blobURL:d},m=function(t,e){return e?function(){var e=Array.prototype.slice.call(arguments),i=e.pop();f.postMessage({foo:t,args:e},i)}:function(){var e=Array.prototype.slice.call(arguments);f.postMessage({foo:t,args:e})}},l=0;l<e.length;l++){var u=e[l];"*"===u.charAt(u.length-1)?g[u=u.substr(0,u.length-1)]=m(u,!0):g[u]=m(u,!1)}return g};